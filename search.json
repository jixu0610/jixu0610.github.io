[{"title":"vue-element-adminä¹‹å¢åˆ æ”¹æŸ¥","url":"/2025/04/20/vue-element-admin%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/","content":"ä»‹ç»ï¼š æ˜¯ä¸€ä¸ªåå°å‰ç«¯è§£å†³æ–¹æ¡ˆï¼Œå®ƒåŸºäº vue å’Œ element-uiå®ç°ã€‚å®ƒä½¿ç”¨äº†æœ€æ–°çš„å‰ç«¯æŠ€æœ¯æ ˆï¼Œå†…ç½®äº† i18 å›½é™…åŒ–è§£å†³æ–¹æ¡ˆï¼ŒåŠ¨æ€è·¯ç”±ï¼Œæƒé™éªŒè¯ï¼Œæç‚¼äº†å…¸å‹çš„ä¸šåŠ¡æ¨¡å‹ï¼Œæä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½ç»„ä»¶ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿæ­å»ºä¼ä¸šçº§ä¸­åå°äº§å“åŸå‹\n\n\n\n\nä¸‹é¢å°±ä»¥ç”¨æˆ·ç®¡ç†ä¸ºä¾‹æ¥è®²è®²å¢åˆ æ”¹æŸ¥å§æ•°æ®åº“ç»“æ„ï¼š\n\n\n\n\n\n\né¡µé¢æˆå“ï¼š\n\n\n\n\næ¦‚è¿°ï¼š æ€»ç»“å¸¸è§çš„å¢åˆ æ”¹æŸ¥ç»†èŠ‚ï¼š \nï¼ˆ1ï¼‰ element-ui æ•°æ®å‘ˆç°çš„å½¢å¼\nï¼ˆ2ï¼‰ ç›¸å…³å‡½æ•°çš„è°ƒç”¨ç»†èŠ‚\n\n\n\næŸ¥è¯¢ï¼šæ¯”è¾ƒå¸¸è§„ï¼ŒæŸ¥è¯¢è¡¨å•ç»‘å®šæäº¤çš„æŸ¥è¯¢æ•°æ®æ¨¡å‹ï¼Œç‚¹å‡»æŒ‰é’®è§¦å‘æäº¤æ–¹æ³•ï¼Œæ–¹æ³•è°ƒç”¨@&#x2F;apiä¸­çš„æ–¹æ³•è°ƒç”¨åç«¯æ¥å£ï¼Œè¿”å›æ•°æ®ï¼Œè¡¨æ ¼ç»‘å®šæŒ‡å®šæ•°æ®å¹¶é€šè¿‡æ•°æ®çš„å±æ€§ä¸€ä¸€å‘ˆç°ã€‚\n\n\nå€¼å¾—ä¸€æçš„æ˜¯ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š\n\n\n(1) åå°è¿”å›éƒ¨é—¨æ ‘å½¢ç»“æ„æ•°æ®å¹¶é€šè¿‡å‰ç«¯å‘ˆç°ï¼Œå…¶ä¸­æ¶‰åŠåˆ° é€’å½’ çš„ä½¿ç”¨ï¼š\n\n\n\nåç«¯ï¼š\n   public static List&lt;Dept&gt; buildTree(List&lt;Dept&gt; deptList, int pid) &#123;           // 0ï¼›çˆ¶èŠ‚ç‚¹ å…¶ä»–ï¼šå­èŠ‚ç‚¹           List&lt;Dept&gt; deptTree = new ArrayList&lt;&gt;();           Optional.ofNullable(deptList).orElse(new ArrayList&lt;&gt;())                   .stream().filter(dept -&gt; dept!=null &amp;&amp; dept.getPid()==pid)                   .forEach(dept -&gt; &#123;                       Dept dept1 = new Dept();                       BeanUtils.copyProperties(dept, dept1);                       dept1.setChildren(buildTree(deptList, dept.getId()));                       deptTree.add(dept1);                   &#125;);           return deptTree;       &#125;      // æŸ¥è¯¢æ‰€æœ‰çš„deptè¡¨æ•°æ® List&lt;Dept&gt; deptListï¼Œå†æ·»åŠ é¡¶éƒ¨æ•°æ®ï¼š   Dept dept = new Dept();   dept.setDeptName(&quot;æ‰€æœ‰éƒ¨é—¨&quot;).setId(0).setPid(-1);   deptList.add(dept);   // æ„é€ æ ‘å½¢æ•°æ®ç»“æ„return DeptTreeUtils.buildTree(deptList, -1);\n\n\n\nå‰ç«¯ï¼š\n   &lt;el-tree :data=&quot;treeData&quot; :props=&quot;defaultProps&quot; node-key=&quot;id&quot; :default-expand-all=&quot;true&quot; empty-text=&quot;æš‚æ— æ•°æ®&quot; @node-click=&quot;handleNodeClick&quot; :highlight-current=&quot;true&quot;&gt;&lt;/el-tree&gt;      &lt;!--   props: å‘ˆç°çš„å±æ€§   node-key çš„ä½œç”¨ï¼šåªæ˜¯å‘Šè¯‰ç»„ä»¶ç”¨å“ªä¸ªå­—æ®µä½œä¸ºèŠ‚ç‚¹çš„å”¯ä¸€æ ‡è¯†ï¼ˆç±»ä¼¼ä¸»é”®ï¼‰ï¼Œç”¨äºç»„ä»¶å†…éƒ¨ç®¡ç†èŠ‚ç‚¹çŠ¶æ€ï¼ˆå¦‚å±•å¼€ã€é€‰ä¸­ã€æŸ¥æ‰¾ç­‰ï¼‰ã€‚   handleNodeClick çš„ä½œç”¨ï¼šç‚¹å‡»èŠ‚ç‚¹æ—¶ï¼Œå®ƒä¼šä¼ é€’å®Œæ•´çš„èŠ‚ç‚¹æ•°æ®å¯¹è±¡ç»™ä½    å…¶ä»–ï¼š é»˜è®¤å±•å¼€ï¼Œ æ ¡éªŒï¼Œ ç‚¹å‡»äº‹ä»¶ï¼Œ é€‰ä¸­é«˜äº®æ˜¾ç¤º   --&gt;      handleNodeClick(data) &#123;    this.userModel.deptId = data.id;       this.search();&#125;,\n\nå¥½çš„ï¼Œå¦‚æ­¤ä¾¿å¯å‘ˆç°æ ‘å½¢ç»“æ„æ•°æ®äº†ï¼Œç‚¹å‡»æ—¢å¯å°†dept_idèµ‹å€¼ç»™userModelçš„deptIdå±æ€§ï¼Œå®ç°æŸ¥è¯¢åŠŸèƒ½ã€‚\n\n\næ­¤æ—¶ï¼Œä¾¿æœ‰ä¸€ä¸ªé—®é¢˜äº†ï¼Œç‚¹å‡»é¡¶çº§èœå•â€æ‰€æœ‰éƒ¨é—¨â€ä¸ºä»€ä¹ˆä¼šå‘ç”ŸæŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·ï¼Ÿè¿™å°±éœ€è¦å‘å†…çœ‹çœ‹æŸ¥è¯¢çš„é€»è¾‘äº†ï¼š\né€»è¾‘å¾ˆå¯»å¸¸ï¼Œæˆ‘è®¾ç½®çš„æ‰€æœ‰ç”¨æˆ·çš„dept_idéƒ½ä¸ºç©ºï¼Œè¯»å–mysqlæ•°æ®åº“çš„dept_idåˆ—æ—¶ï¼ŒResultSet.getInt()ä¼šè¿”å›0ï¼Œè€Œé¡¶çº§èœå•çš„idå³ä¸º0ï¼Œæ‰€ä»¥æŸ¥è¯¢å…¨éƒ¨ç”¨æˆ·ã€‚ğŸ˜‚\n\n\n\n\n(2) å¤é€‰æ¡†\n\n\n\nç›¸å¯¹æ¥è®²æ¯”è¾ƒç®€å•: å°±æ˜¯ç‚¹å‡»æŒ‰é’®å‘åç«¯è¯·æ±‚æ‰€æœ‰é€‰é¡¹æ•°æ®roleListï¼Œå‘ˆç°çš„å±æ€§æ˜¯roleName, å€¼ï¼ˆlabelï¼‰ä¸ºidï¼Œé»˜è®¤é€‰é¡¹ä¸ºel-checkbox-groupæ ‡ç­¾çš„ç»‘å®šæ¨¡å‹roleIdså†…çš„å…ƒç´ ï¼Œç‚¹é€‰å¤é€‰æ¡†ï¼Œå¯æ”¹å˜roleIdså†…çš„å…ƒç´ ï¼Œä»¥ä¸‹ä¸ºå‰ç«¯æ ‡ç­¾ç»“æ„ï¼š\n\n\n&lt;el-dialog title=&quot;è§’è‰²ç»‘å®š&quot; :visible.sync=&quot;dialogRoleVisible&quot; width=&quot;30%&quot;&gt;    &lt;el-checkbox-group v-model=&quot;roleIds&quot;&gt;        &lt;el-checkbox v-for=&quot;item in roleList&quot; :key=&quot;item.id&quot; :label=&quot;item.id&quot;&gt;&#123;&#123;item.roleName&#125;&#125;&lt;/el-checkbox&gt;    &lt;/el-checkbox-group&gt;    &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;        &lt;el-button @click=&quot;clearBind&quot;&gt;å–æ¶ˆ&lt;/el-button&gt;        &lt;el-button type=&quot;primary&quot; @click=&quot;handleBindRole&quot;&gt;ç¡®å®š&lt;/el-button&gt;    &lt;/div&gt;&lt;/el-dialog&gt;\n\n\n\nå¤„ç†é€»è¾‘ï¼š ç‚¹å‡»è§’è‰²ç»‘å®šæŒ‰é’®ï¼Œå‘åå°å‘é€2ä¸ªè¯·æ±‚ ï¼šï¼ˆ1ï¼‰æ‰€æœ‰çš„è§’è‰²æ•°æ®  ï¼ˆ2ï¼‰ä¸ç”¨æˆ·è”ç³»çš„è§’è‰²id\nç‚¹é€‰å¤é€‰æ¡†ä¹‹åï¼Œå‘é€è¯·æ±‚æºå¸¦userIdå’ŒroleListï¼Œåå°å…ˆåˆ é™¤userIdç›¸å…³è”çš„roleId, åœ¨æ‰¹é‡æ’å…¥ç”¨æˆ·è§’è‰²å…³ç³»ã€‚ğŸ˜\n\n\n\n\nï¼ˆ3ï¼‰åˆ†é¡µæŸ¥æ‰¾çš„é€»è¾‘\n\nå•è¡¨åˆ†é¡µæŸ¥è¯¢çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨baseMapper.selectByPage(page, æŸ¥è¯¢å¯¹è±¡)\n\n\nå¤šè¡¨è”åˆæŸ¥è¯¢çš„æƒ…å†µä¸‹:\nä½¿ç”¨ï¼šbaseMapper.searchByPage(page, autoInfo);AutoInfoMapperä¸­å®šä¹‰searchByPageæ–¹æ³•Page&lt;AutoInfo&gt; searchByPage(Page&lt;AutoInfo&gt; page, AutoInfo autoInfo);Mapper.xmlä¸­ï¼šAutoInfo.xmlï¼š&lt;select id=&quot;searchByPage&quot; resultType=&quot;com.coder.rental.entity.AutoInfo&quot;&gt;    select i.*, m.name, b.brand_name     from auto_info i, auto_maker m, auto_brand b\twhere i.maker_id = m.id and i.brand_id = b.id åç»­ä¸ºå¯¹è±¡æ¡ä»¶æŸ¥è¯¢&lt;/select&gt;\n\nå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œä¼ å…¥çš„pageå¯¹è±¡å¥½åƒåœ¨æŸ¥è¯¢ä¸­ç”¨ä¸åˆ°ï¼Œåº”è¯¥åœ¨è¿”å›ä¸­ä½¿List&lt;.AutoInfo.&gt;è‡ªåŠ¨è½¬åŒ–æˆPageå¯¹è±¡å§ï¼ŒæŒºé‚ªä¹çš„ğŸ˜’\n\n\n\n\nï¼ˆ4ï¼‰æ ¹æ®èº«ä»½è¯å·ç¡®å®šå‡ºç”Ÿæ—¥æœŸ,æ€§åˆ«å’Œå¹´é¾„\n\n&lt;el-form-item label=&quot;èº«ä»½è¯å·&quot; prop=&quot;idNum&quot;&gt;    &lt;el-input v-model=&quot;saveCustomer.idNum&quot; @change=&quot;setCustomerInfo&quot;&gt;&lt;/el-input&gt;&lt;/el-form-item&gt;               &lt;el-form-item label=&quot;å®¢æˆ·å¹´é¾„&quot; prop=&quot;age&quot;&gt;    &lt;el-input v-model=&quot;saveCustomer.age&quot; :readonly=&quot;true&quot;&gt;&lt;/el-input&gt;&lt;/el-form-item&gt;&lt;el-form-item label=&quot;å®¢æˆ·æ€§åˆ«&quot; prop=&quot;gender&quot;&gt;    &lt;el-radio-group v-model=&quot;saveCustomer.gender&quot;&gt;        &lt;el-radio-button :label=&quot;1&quot; disabled&gt;ç”·&lt;/el-radio-button&gt;        &lt;el-radio-button :label=&quot;0&quot; disabled&gt;å¥³&lt;/el-radio-button&gt;    &lt;/el-radio-group&gt;&lt;/el-form-item&gt;&lt;el-form-item label=&quot;å‡ºç”Ÿæ—¥æœŸ&quot; prop=&quot;birthday&quot;&gt;    &lt;el-date-picker v-model=&quot;saveCustomer.birthday&quot;                    type=&quot;date&quot; placeholder=&quot;é€‰æ‹©æ—¥æœŸ&quot;                    value-format=&quot;yyyy-MM-dd&quot; :readonly=&quot;true&quot;&gt;    &lt;/el-date-picker&gt;&lt;/el-form-item&gt;&lt;script&gt;    setCustomerInfo(val) &#123;        //220202199911312661        //å¤„ç†æ€§åˆ«        const sex = val.charAt(val.length - 2)        this.saveCustomer.gender = sex % 2        //è·å–ç”¨æˆ·èº«ä»½è¯ä¸Šçš„å‡ºç”Ÿæ—¥æœŸ        const birthday = val.substring(6, 14)        //å½“å‰ç³»ç»Ÿæ—¶é—´        const now = new Date()        const birthDate = new Date(birthday.substring(0, 4), birthday.substring(4, 6) - 1, birthday.substring(6, 8))        let timeDiff = Math.abs(now.getTime() - birthDate.getTime())        if (timeDiff &gt; 0) &#123;            //è®¡ç®—å¹´é¾„            this.saveCustomer.age = Math.floor(timeDiff / (1000 * 60 * 60 * 24 * 365))            //è®¡ç®—å‡ºç”Ÿæ—¥æœŸ            this.saveCustomer.birthday = birthDate//birthday.substring(0,4)+&quot;-&quot;+birthday.substring(4,6)+&quot;-&quot;+birthday.substring(6,8)        &#125;        this.$forceUpdate()    &#125;&lt;/script&gt;\n\n\n\n\n\n(5) æ—¥æœŸé€‰æ‹©&lt;el-form-item&gt;    &lt;el-date-picker v-                    model=&quot;violationModel.violationTimeVal&quot; type=&quot;datetimerange&quot;                    value-format=&quot;yyyy-MM-dd HH:mm:ss&quot; :picker-                    options=&quot;pickerOptions&quot; range-separator=&quot;è‡³&quot;                    start-placeholder=&quot;å¼€å§‹æ—¥æœŸ&quot; end-placeholder=&quot;ç»“æŸæ—¥æœŸ&quot;                    align=&quot;right&quot;&gt;    &lt;/el-date-picker&gt;&lt;/el-form-item&gt;&lt;el-form-item label=&quot;è¿ç« æ—¶é—´&quot; prop=&quot;vtime&quot;&gt;    &lt;el-date-picker v-model=&quot;saveViolation.vtime&quot;                    type=&quot;datetime&quot; placeholder=&quot;é€‰æ‹©æ—¥æœŸ&quot;                    value-format=&quot;yyyy-MM-dd HH:mm:ss&quot; /&gt;&lt;/el-form-item&gt;&lt;!--åç«¯å®ä½“ç±»æ•°æ®ï¼š@ApiModelProperty(&quot;è¿ç« æ—¶é—´&quot;)@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)private LocalDateTime vtime;--&gt;\n\n\n\n\n\n(6) ä¸‹æ‹‰æ¡†è½¦è¾†ä¿å…»çš„æ–°å¢é€‰æ‹©è½¦ç‰Œï¼Œè½¦è¾†ä¿¡æ¯æ–°å¢æ‰€å±å‚å•†ï¼Œæ±½è½¦å‡ºç§Ÿ\n\n\n\n\n(7) ä¾§è¾¹æ \næ·»åŠ å’Œä¿®æ”¹ï¼šå¼¹å‡ºæ·»åŠ ä¿®æ”¹å¯¹è¯æ¡†ï¼Œæ³¨æ„å»¶è¿Ÿæ ¡éªŒï¼Œè¡¨å•ç»‘å®šä¿å­˜æ•°æ®æ¨¡å‹saveUserï¼Œæ­¤æ—¶æœ‰å¯»å¸¸ç¼–è¾‘çš„æƒ…å†µï¼Œæœ‰ç‚¹å‡»å¼¹å‡ºæ ‘å½¢ç»“æ„ï¼Œè¿›è¡Œç‚¹é€‰çš„æƒ…å†µï¼ˆä¸Šé¢æŸ¥è¯¢æ—¶å·²ç»ä»‹ç»è¿‡äº†ï¼‰ï¼Œ è¿™é‡Œé‡ç‚¹ä»‹ç»ä¸Šä¼ å¤´åƒçš„æƒ…å†µï¼š\n\nå¯¹ï¼Œæˆ‘ä»¬ç”¨åˆ°çš„å°±æ˜¯aliyunçš„ossæœåŠ¡ï¼Œè¯¦ç»†çš„ä¸Šä¼ å’Œåˆ é™¤è¯·å‚è€ƒé˜¿é‡Œäº‘ä¸Šä¼ å’Œåˆ é™¤å›¾ç‰‡ï¼Œæˆ‘ä»¬è¿™é‡Œåªè°ˆä¸€è°ˆå¢æ·»å¤´åƒçš„é€»è¾‘ï¼š\nç‚¹å‡»ä¸Šä¼ å›¾ç‰‡ï¼Œåç«¯è¿”å›å›¾ç‰‡åœ°å€ï¼Œå‰ç«¯åˆ©ç”¨åœ°å€æ˜¾ç¤ºå›¾ç‰‡å³å¯\næ‰€ä»¥è¿™é‡Œåªè®¨è®ºå‰ç«¯ï¼š\n&lt;el-form-item label=&quot;ç”¨æˆ·å¤´åƒ&quot; prop=&quot;avatar&quot;&gt;    &lt;el-upload               class=&quot;avatar-uploader&quot;               :action=&quot;uploadPath&quot;               :show-file-list=&quot;false&quot;               :on-success=&quot;handleAvatarSuccess&quot;               :before-upload=&quot;beforeAvatarUpload&quot;               :data=&quot;uploadToken&quot;&gt;        &lt;img v-if=&quot;saveUser.avatar&quot; :src=&quot;saveUser.avatar&quot; class=&quot;avatar&quot; width=&quot;80&quot;&gt;        &lt;i v-else class=&quot;el-icon-plus avatar-uploader-icon&quot;&gt;&lt;/i&gt;    &lt;/el-upload&gt;&lt;/el-form-item&gt;&lt;script&gt;export default &#123;    data() &#123;        return &#123;            uploadPath: process.env.VUE_APP_BASE_API + &#x27;rental/oss/upload&#x27;,            uploadToken: &#123;token: getToken()&#125;,        &#125;    &#125;,        methods: &#123;        handleAvatarSuccess(res, file) &#123;            this.saveUser.avatar = res.data;            this.$forceUpdate();        &#125;,        beforeAvatarUpload(file) &#123;            // ä¸Šä¼ å¤´åƒä¹‹å‰çš„éªŒè¯            const isJPG = file.type === &#x27;image/jpeg&#x27; || file.type === &#x27;image/png&#x27;;            const isLt2M = file.size/1024/1024 &lt; 2;            if (!isJPG) &#123;                this.$message.error(&#x27;ä¸Šä¼ å¤´åƒåªèƒ½æ˜¯ JPG æˆ– PNG æ ¼å¼ï¼&#x27;);            &#125;            if (!isLt2M) &#123;                this.$message.error(&#x27;ä¸Šä¼ å¤´åƒå¤§å°ä¸èƒ½è¶…è¿‡2MB!&#x27;);            &#125;            return isJPG &amp;&amp; isLt2M;        &#125;,    &#125;&#125;&lt;/script&gt;\n\nokï¼Œæ­£å¦‚ä¸Šæ‰€ç¤ºï¼Œæœ‰ä¸Šä¼ åœ°å€ï¼Œæºå¸¦tokenä»¤ç‰Œï¼Œä¸Šä¼ ä¹‹å‰è¿›è¡ŒéªŒè¯ï¼Œä¸Šä¼ æˆåŠŸåå›¾ç‰‡åœ°å€èµ‹å€¼ç»™saveUser.avatar\n\n\nè¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼š\nä»¥ä¸‹ä¸¤ä¸ªè¯­å¥çš„å¼•ç”¨é€»è¾‘ï¼š\nimport &#123; getToken &#125; from &#x27;@/utils/auth&#x27;;// VUE_APP_BASE_API å®šä¹‰åœ¨ @/env.developmentæ–‡ä»¶ä¸‹ï¼ˆï¼‰, å¯ä»¥ç›´æ¥é€šè¿‡processå¼•ç”¨uploadPath: process.env.VUE_APP_BASE_API + &#x27;rental/oss/upload&#x27;, // getToken() å®šä¹‰åœ¨@/utils/authä¸­uploadToken: &#123;token: getToken()&#125;,    // å¥½çš„ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹tokençš„è·å–è¿‡ç¨‹ï¼šå°±æ˜¯å°è£…çš„Cookiesä¸­è·å–// @/utils/auth.js: import Cookies from &#x27;js-cookie&#x27;const TokenKey = &#x27;Admin-Token&#x27;export function getToken() &#123;  return Cookies.get(TokenKey)&#125;\n\n\n\n\nåˆ é™¤\n\nè¿™é‡Œçš„åˆ é™¤å¯ä»¥æ˜¯æŒ‡å®šè¡Œçš„å…ƒç´ åˆ é™¤ï¼Œä¹Ÿå¯ä»¥æ˜¯é€‰ä¸­æ•°è¡Œè¿›è¡Œæ‰¹é‡åˆ é™¤\n\n\næŒ‡å®šè¡Œçš„åˆ é™¤ï¼š å¡æ§½è·å–å¯¹è±¡ï¼Œå°†å¯¹è±¡ä¼ å…¥åˆ é™¤å‡½æ•°æ ¹æ®idè¿›è¡Œåˆ é™¤\næ‰¹é‡åˆ é™¤ï¼š åˆ©ç”¨ el-table-column type&#x3D;â€selectionâ€ æ„å»ºåŸºæœ¬å¤é€‰æ¡†ï¼Œç‚¹å‡»æ—¶è§¦å‘ el-table @selection-changeäº‹ä»¶\nä¸‹é¢æ¥è¯¦ç»†çœ‹çœ‹æ‰¹é‡åˆ é™¤çš„å…ƒç´ å‹¾é€‰ï¼š\n&lt;script&gt;export default &#123;    data() &#123;        return &#123;            multipleSelection: [],  // è·å–åˆ é™¤çš„æ‰¹é‡id        &#125;    &#125;,        methods: &#123;         handleSelectionChange(val) &#123;            this.multipleSelection = [];            val.forEach(element =&gt; &#123;            this.multipleSelection.push(element.id);            &#125;);        &#125;,    &#125;&#125;&lt;/script&gt;\n\næ¯æ¬¡ç‚¹å‡»çš„æ—¶å€™è¦æ¸…é™¤multipleSelection\n\n\nokäº†ï¼Œä¸€äº›å¸¸è§çš„å¢åˆ æ”¹æŸ¥æ“ä½œå·²ç»æ€»ç»“å®Œæ¯•ï¼Œå¦‚æœåç»­å‡ºç°æ–°çš„æƒ…å†µï¼Œä¼šè¿›è¡Œè¡¥å……çš„ğŸƒ\n","categories":["vue","vue-element-admin","javaé¡¹ç›®","æ±½è½¦ç§Ÿèµç®¡ç†ç³»ç»Ÿ"],"tags":["vue","vue-element-admin"]},{"title":"GitHub Page + Hexo åˆ›å»ºä¸ªäººåšå®¢","url":"/2025/04/14/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/","content":"ä»‹ç»ï¼š ç¼–å†™mdæ ¼å¼æ–‡ä»¶ï¼Œä½¿ç”¨ Hexo æ¸²æŸ“æˆé™æ€ç½‘é¡µæ–‡ä»¶ï¼Œç”¨gitä¸Šä¼ è‡³githubä»“åº“ï¼ˆä»“åº“åå³ç”¨æˆ·åï¼‰ï¼Œå¯ç”± ä»“åº“å.github.io åœ°å€è®¿é—®ã€‚\n\n\nä¸€. åˆæ¬¡ä½¿ç”¨ï¼š\nç¯å¢ƒå‡†å¤‡ï¼š\ngit\nnodeï¼ˆç‰ˆæœ¬14.0.0+ï¼‰\n\n\nHexoå®‰è£…ï¼š\nnpm install -g hexo-cli\n\n\n\nåˆå§‹åŒ–æ¡†æ¶, åˆ›å»ºå·¥ä½œæ–‡ä»¶å¤¹test:\nnpm init test;npm install; // å®‰è£…æ¡†æ¶æ‰€éœ€\n\n\n\nç”Ÿæˆé™æ€ç½‘é¡µ\nhexo g\n\n\n\n\nå¯åŠ¨æœåŠ¡\nhexo s\n\n\n\nâ€‹\tè®¿é—® 127.0.0.1:4000 æŸ¥çœ‹é¡µé¢æ•ˆæœã€‚\n\n\n\n\näºŒ. Nextä¸»é¢˜:\nä¸‹è½½nextä¸»é¢˜ï¼š\ncd testgit clone https://github.com/iissnan/hexo-theme-next themes/next\n\n\n\n_config.yml æ–‡ä»¶æ‰¾åˆ° theme, æ›´æ”¹ï¼š\ntheme: next\n\n\n\né€‰æ‹©ä¸»é¢˜å½¢å¼ï¼š åœ¨&#x2F;theme&#x2F;next&#x2F;_config.ymlæ‰¾åˆ° scheme\n# Schemes# scheme: Muse# scheme: Mist# scheme: Piscesscheme: Gemini  # æ¨è\n\n\n\nè®¾ç½®è¯­è¨€ï¼šåœ¨_config.ymlä¸­æ‰¾åˆ° languageï¼Œ è®¾ç½®ï¼š\nlanguage: zh-Hans # é»˜è®¤en\n\n\n\nè®¾ç½®èœå•ï¼š åœ¨&#x2F;theme&#x2F;next&#x2F;_config.ymlæ‰¾åˆ° menu\nmenu:  home: /              # é¦–é¡µ  archives: /archives  # å½’æ¡£  #about: /about  #categories: /categories  #tags: /tags  #commonweal: /404.html\n\n\n\n\n\n\nè‹¥ä½ çš„ç«™ç‚¹è¿è¡Œåœ¨å­ç›®å½•ä¸­ï¼Œè¯·å°†é“¾æ¥å‰ç¼€çš„ &#x2F; å»æ‰\n\n\n\n\n\n\nä¸‰. ä¿®æ”¹ä¸ªäººä¿¡æ¯\nç¼–è¾‘_config.ymlï¼Œ è®¾ç½®authorï¼Œtitle,  subtitle, descriptionç­‰:\n# Sitetitle: yourTitle   #æ ‡é¢˜subtitle: &#x27;&#x27;       #å‰¯æ ‡é¢˜description: &#x27;&#x27;keywords:author: you        #ä½œè€…language: zh-Hans  #è¯­è¨€timezone: &#x27;Asia/Shanghai&#x27; #æ—¶åŒº\n\n\n\nè®¾ç½®å¤´åƒï¼š åœ¨sourceæ–‡ä»¶å¤¹ä¸‹åˆ›å»º imageæ–‡ä»¶å¤¹ï¼Œæ”¾ç½®å›¾ç‰‡\navatar: /images/åšå®¢å¤´åƒ.png  # /images/å›¾ç‰‡.png   å›¾ç‰‡çš„æ ¼å¼ \n\n\n\n\n\nå››. ç¼–å†™æ–‡ç« ç¼–å†™mdæ ¼å¼æ–‡ç« ï¼Œæ”¾åœ¨ source&#x2F;_posts æ–‡ä»¶å¤¹ä¸‹\nhexo new &quot;post title&quot; # åˆ›å»ºæ–‡ç« ï¼Œé»˜è®¤mdæ ¼å¼host g  # å…¨éƒ¨åŸæ–‡ç« æ¸²æŸ“åˆ°publicé™æ€ç›®å½•\n\n\n\n\n\näº”. ä¸Šä¼ è‡³github\nå®‰è£…ä¸€é”®éƒ¨ç½²æ’ä»¶ï¼š\nnpm install hexo-deployer-git --save\n\n\n\n_config.ymlä¸­æ·»åŠ éƒ¨ç½²é…ç½®ï¼š\ndeploy:  type: git  repo: git@github.com:&lt;username&gt;/&lt;project&gt;  #example,https://github.com/hexojs/hexojs.github.io  branch: master  # ä¸Šä¼ githubä»“åº“åˆ†æ”¯ï¼Œå¯æ›´æ”¹\n\n\n\nä¸Šä¼ ï¼š\nhexo d\n\n\n\nè®¿é—®åœ°å€ï¼šyourUserName.github.io  (æ³¨æ„ä½ ä¸Šä¼ çš„ä»“åº“åå’Œä½ çš„githubçš„ç”¨æˆ·åå¿…é¡»ç›¸åŒï¼)\n\n\n\n\næ­å–œä½ å·²ç»åˆ›å»ºäº†å±äºä½ çš„åšå®¢ã€‚\n","categories":["hexo"],"tags":["åˆ›å»ºåšå®¢","hexo"]},{"title":"é˜¿é‡Œäº‘OSS","url":"/2025/04/20/%E9%98%BF%E9%87%8C%E4%BA%91OSS/","content":"ä»‹ç»ï¼š æœ‰æ—¶ï¼Œæˆ‘ä»¬å°†å›¾ç‰‡ç­‰é™æ€èµ„æºå­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šï¼Œä½†å½“å›¾ç‰‡å¤šæ—¶ï¼Œç½‘ç«™åŠ è½½å›¾ç‰‡ç­‰é™æ€èµ„æºçš„æ—¶é—´ä¼šå˜é•¿ï¼ŒæœåŠ¡ä½“æ£€å°±ä¼šæ‰“æŠ˜æ‰£ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ©é˜¿é‡Œäº‘ç­‰äº‘æœåŠ¡çš„å¯¹è±¡å­˜å‚¨æœåŠ¡ç›´æ¥ä¸Šä¼ å›¾ç‰‡ï¼Œåœ¨ç½‘ç«™htmlé¡µé¢å¼•ç”¨å›¾ç‰‡åœ°å€å³å¯ã€‚\n\n\n\n\nspringbootå¦‚ä½•ä»‹å…¥aliyun OSSæœåŠ¡å‘¢?  é‚£ä¹ˆç°åœ¨å¼€å§‹å§\n\n\n\né¦–å…ˆæ˜¯åœ¨ springboot é…ç½®æ–‡ä»¶ application.yml ä¸­åŠ å…¥ä»¥ä¸‹:\naliyun:  oss:    endpoint:    access-key-id:    access-key-secret:    bucket-name:\n\néœ€è¦æ³¨å†Œé˜¿é‡Œäº‘çš„OSSæœåŠ¡æ‰å¯ä»¥æœ‰bucket-nameå’Œendpoint, èº«ä»½è®¤è¯çš„ä¸¤ä¸ªå±æ€§ï¼šaccess-key-id å’Œ access-key-secret\n\n\n\n\nå†æŠŠå®ƒå°è£…æˆä¸€ä¸ªå¯¹è±¡OSSConfig, æ–¹ä¾¿æ“ä½œğŸ‘\nimport lombok.Data;import org.springframework.beans.factory.annotation.Value;import org.springframework.stereotype.Component;@Component@Datapublic class OSSConfig &#123;    @Value(&quot;$&#123;aliyun.oss.endpoint&#125;&quot;)    private String endpoint;    @Value(&quot;$&#123;aliyun.oss.access-key-id&#125;&quot;)    private String accessKeyId;    @Value(&quot;$&#123;aliyun.oss.access-key-secret&#125;&quot;)    private String accessKeySecret;    @Value(&quot;$&#123;aliyun.oss.bucket-name&#125;&quot;)    private String bucketName;&#125;\n\n\n\n\n\nå†å°±æ˜¯åˆ›å»ºä¸€ä¸ªæ¥å£åŠå…¶å®ç°ç±»ï¼Œå®Œæˆå›¾ç‰‡çš„ä¸Šä¼ å’Œåˆ é™¤é€»è¾‘ï¼š\n// å…ˆåˆ›å»ºIOssServiceï¼Œå®šä¹‰ä¸Šä¼ å’Œåˆ é™¤æ–¹æ³•import cn.hutool.core.util.StrUtil;import com.aliyun.oss.OSS;import com.aliyun.oss.OSSClientBuilder;import com.coder.rental.config.OSSConfig;import com.coder.rental.service.IOssService;import com.coder.rental.utils.FileUtils;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;import org.springframework.web.multipart.MultipartFile;@Servicepublic class OssServiceImpl implements IOssService &#123;    @Autowired    private OSSConfig ossConfig;    public String upload(MultipartFile file) &#123;        String originalFilename = file.getOriginalFilename();        String fileName = FileUtils.getFileName(originalFilename);        OSS ossClient = new OSSClientBuilder().build(                ossConfig.getEndpoint(),                ossConfig.getAccessKeyId(),                ossConfig.getAccessKeySecret()        );        try &#123;            // å®Œæˆä¸Šä¼ å¤„ç†            ossClient.putObject(ossConfig.getBucketName(), fileName, file.getInputStream());            return &quot;https://&quot; + ossConfig.getBucketName() + &quot;.&quot; +  ossConfig.getEndpoint() + &quot;/&quot; + fileName;        &#125; catch (Exception e) &#123;            throw new RuntimeException(&quot;ä¸Šä¼ æ–‡ä»¶å¤±è´¥&quot;);        &#125; finally &#123;            if (ossClient != null) &#123;                ossClient.shutdown();            &#125;        &#125;    &#125;    @Override    public boolean delete(String url) &#123;        OSS ossClient = new OSSClientBuilder().build(                ossConfig.getEndpoint(),                ossConfig.getAccessKeyId(),                ossConfig.getAccessKeySecret()        );        String host = &quot;https://&quot; + ossConfig.getBucketName() + &quot;.&quot; + ossConfig.getEndpoint() + &quot;/&quot;;        String objectName = StrUtil.removePrefix(url, host);        try &#123;            ossClient.deleteObject(ossConfig.getBucketName(), objectName);            return true;        &#125; catch (Exception e) &#123;            throw new RuntimeException(&quot;åˆ é™¤å¤±è´¥&quot;);        &#125; finally &#123;            if (ossClient != null) &#123;                ossClient.shutdown();            &#125;        &#125;    &#125;&#125;\n\n\n\n\n\næœ€åå°±æ˜¯ controller å±‚çš„è°ƒç”¨äº†\n\n\n\n\nå°±æ˜¯è¿™ä¹ˆç®€å•\n\n\n","categories":["äº‘æœåŠ¡","é˜¿é‡Œäº‘OSS"],"tags":["é˜¿é‡Œäº‘OSS"]},{"title":"vue-element-adminåˆå§‹æ­å»º","url":"/2025/04/23/vue-element-admin%E5%88%9D%E5%A7%8B%E4%BD%BF%E7%94%A8/","content":"ä»‹ç»ï¼š åˆå§‹æ­å»ºæ˜¯åœ¨åç«¯çš„è®¿é—®æƒé™æ¨¡å—å®Œæˆä¹‹åè¿›è¡Œçš„ï¼Œä¸»è¦å†…å®¹ä¸ºç™»å½•é€€å‡ºï¼Œèœå•è·¯ç”±å¯¼èˆªè¿™ä¸¤éƒ¨åˆ†ï¼Œæ„å»ºä¸€ä¸ªå¤§ä½“æ¡†æ¶ï¼Œä¹‹åå†…å®¹çš„ç¼–å†™å°±åªéœ€æ³¨é‡å†…å®¹æœ¬èº«å³å¯ã€‚\n\n\nä¸€. vue-element-adminå®‰è£…\n\n\n\näºŒ.åç«¯\nç”¨æˆ·ç™»å½•è·å–è¯¥ç”¨æˆ·ä¿¡æ¯(id, ç”¨æˆ·å, å¤´åƒ, è§’è‰²åç§°æ•°ç»„)\n@GetMapping(&quot;/getInfo&quot;)public Result getUserInfo() &#123;    // ä»securityContextHolderä¸Šä¸‹æ–‡ä¸­è·å–è®¤è¯ä¿¡æ¯    Authentication authentication =        SecurityContextHolder.getContext().getAuthentication();    if (authentication == null) &#123;        return Result.fail().setMessage(&quot;è®¤è¯ä¿¡æ¯ä¸ºç©º&quot;);    &#125;    User user = (User) authentication.getPrincipal();    // æŸ¥è¯¢ç”¨æˆ·è§’è‰²åç§°    /*List&lt;String&gt; list = userService.selectRoleName(user.getId());Â  Â  Â  Â Object[] array = list.toArray(); */// å°†è§’è‰²åç§°åˆ—è¡¨è½¬æ¢ä¸ºæ•°ç»„    List&lt;Permission&gt; permissionList = user.getPermissionList();    Object[] array = permissionList.stream().filter(Objects::nonNull)        .map(Permission::getPermissionCode)        .toArray();    // åˆ›å»ºå¹¶å¡«å……ç”¨æˆ·ä¿¡æ¯è§†å›¾å¯¹è±¡    UserInfoVo userInfoVo = new UserInfoVo(user.getId(),                                           user.getUsername(),                                           user.getAvatar(), user.getNickname(), array);    return Result.success(userInfoVo).setMessage(&quot;è·å–ç”¨æˆ·ä¿¡æ¯æˆåŠŸ&quot;);&#125;\n\næ³¨æ„è§’è‰²æ•°ç»„è¦ç”¨ Permission ä¸­çš„ permissionCode\n\n\nå‚ç…§router-&gt;index.jsä¸­çš„è·¯ç”±é€‰é¡¹ï¼Œç¼–å†™routerVO\n&#123;    path: &#x27;/error&#x27;,    component: Layout,    redirect: &#x27;noRedirect&#x27;,    name: &#x27;ErrorPages&#x27;,    meta: &#123;      title: &#x27;Error Pages&#x27;,      icon: &#x27;404&#x27;,      roles: [&#x27;admin&#x27;, &#x27;editor&#x27;]    &#125;,    children: [      &#123;        path: &#x27;401&#x27;,        component: () =&gt; import(&#x27;@/views/error-page/401&#x27;),        name: &#x27;Page401&#x27;,        meta: &#123; title: &#x27;401&#x27;, noCache: true &#125;      &#125;,      &#123;        path: &#x27;404&#x27;,        component: () =&gt; import(&#x27;@/views/error-page/404&#x27;),        name: &#x27;Page404&#x27;,        meta: &#123; title: &#x27;404&#x27;, noCache: true &#125;      &#125;    ]&#125;\n\n\n\n@Data@JsonInclude(JsonInclude.Include.NON_EMPTY) // æ³¨æ„åŠ ä¸Šè¯¥æ³¨è§£ï¼Œä¸åºåˆ—åŒ–ç©ºchildrenpublic class RouteVO &#123;    private String path;    private String component;    private String name;    private Boolean alwaysShow;    private Meta meta;    private List&lt;RouteVO&gt; children;    @Data    @NoArgsConstructor    @AllArgsConstructor    public class Meta &#123;        private String title;        private String icon;        private String[] roles;    &#125;&#125;\n\n\n\næ ¹æ®æƒé™åˆ—è¡¨ï¼Œç»è¿‡è·¯ç”±èœå•å·¥å…·ç±»è·å–è·¯ç”±ä¿¡æ¯\n@GetMapping(&quot;/menuList&quot;)public Result getMenuList() &#123;    //è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯    Authentication authentication =        SecurityContextHolder.getContext().getAuthentication();    if (authentication == null) &#123;        return Result.fail().setMessage(&quot;è®¤è¯ä¿¡æ¯ä¸ºç©º&quot;);    &#125;    User user = (User) authentication.getPrincipal();    //è·å–ç”¨æˆ·çš„æƒé™åˆ—è¡¨    List&lt;Permission&gt; permissionList = user.getPermissionList();    //è·å–ç”¨æˆ·çš„èœå•    //å°†permission_typeä¸º2çš„æŒ‰é’®ç§»é™¤ï¼Œä¸éœ€è¦ç”Ÿæˆå¯¹åº”çš„èœå•    permissionList.removeIf(permission -&gt;                            Objects.equals(permission.getPermissionType(), 2));    List&lt;RouteVO&gt; routeVOList =        RouteTreeUtils.buildRouteTree(permissionList, 0);    return Result.success(routeVOList).setMessage(&quot;è·å–èœå•åˆ—è¡¨æˆåŠŸ&quot;);&#125;\n\n\n\né€€å‡ºç™»å½•æ¥å£\n@PostMapping(&quot;/logout&quot;)public Result logout(HttpServletRequest request, HttpServletResponse                     response)&#123;    String token=request.getHeader(&quot;token&quot;);    if (StrUtil.isEmpty(token))&#123;        token=request.getParameter(&quot;token&quot;);    &#125;    Authentication authentication =        SecurityContextHolder.getContext().getAuthentication();    if (authentication!=null)&#123;        //ç”¨æˆ·ä¸€æ—¦ç™»å‡ºç³»ç»Ÿï¼Œåˆ™æ¸…é™¤redisä¸­çš„token        redisUtils.del(&quot;token:&quot;+token);        SecurityContextLogoutHandler handler = new            SecurityContextLogoutHandler();        handler.logout(request,response,authentication);        return Result.success().setMessage(&quot;ç™»å‡ºæˆåŠŸ&quot;);    &#125;    return Result.fail().setMessage(&quot;ç™»å‡ºå¤±è´¥&quot;);&#125;\n\n\n\nè¿™ä¸ªæ—¶å€™åç«¯å°±å®Œæˆäº†ï¼Œæ€»ç»“ä»¥ä¸‹åç«¯å®Œæˆå†…å®¹å§ğŸƒï¼š\nï¼ˆ1ï¼‰è·å–ç”¨æˆ·ä¿¡æ¯  ï¼ˆ2ï¼‰è·å–è·¯ç”±ä¿¡æ¯   ï¼ˆ3ï¼‰é€€å‡ºç™»å½•\n\n\n\n\n\n\nä¸‰.å‰ç«¯ä¹‹ç™»å½•é€€å‡º\n\n\nå¥½çš„ï¼Œæˆ‘ä»¬ç°åœ¨å¼€å§‹å‰ç«¯éƒ¨åˆ†ï¼Œé¦–å…ˆæ˜¯å‰ç«¯ç™»å½•ï¼šå…ˆç¨å¾®ä¿®æ”¹ä¸€ä¸‹å‰ç«¯é¡µé¢ğŸ˜ï¼Œç„¶åå°±æœ‰ä¸€ä¸ªé—®é¢˜äº†ï¼Œæ€ä¹ˆè®©å‰ç«¯å‘é€ç™»å½•è¯·æ±‚åˆ°åç«¯å‘¢ï¼Ÿæˆ‘ä»¬æ¥è§£å†³ï¼š\n\n\n\nï¼ˆ1ï¼‰å…ˆä¿®æ”¹ä»¥ä¸‹å¼€å‘ç¯å¢ƒ**.env.developmentå’Œç”Ÿäº§ç¯å¢ƒ.env.production**çš„æ–‡ä»¶ï¼š\nVUE_APP_BASE_API = &#x27;http://localhost:8888/&#x27;\n\n\n\nï¼ˆ2ï¼‰ ç„¶åä¿®æ”¹å‘é€è¯·æ±‚çš„æ–‡ä»¶request.js:\n\n\nâ€‹\tå®‰è£…qsä¾èµ–ï¼Œå®ç°å‚æ•°åºåˆ—åŒ–å¤„ç†ï¼š\nnpm install qs\n\n\n\nâ€‹\tä¿®æ”¹serviceï¼Œç”¨ process.env.VUE_APP_BASE_API æ¥è¡¨ç¤ºè¦å‘é€çš„æœåŠ¡å™¨åŠå…¶ç«¯å£\n// create an axios instanceconst service = axios.create(&#123;    baseURL: process.env.VUE_APP_BASE_API, // url = base url + request url    // withCredentials: true, // send cookies when cross-domain requests    timeout: 5000 // request timeout&#125;)// æ¥ä¸‹æ¥å°±æ˜¯requestæ‹¦æˆª, åœ¨Headerä¸­æ”¾ç½®token// responseæ‹¦æˆªï¼Œåˆ¤æ–­å“åº”codeæ¥åšå¤„ç†// å®šä¹‰requestHttp,ç”¨äºå‘é€è¯·æ±‚ï¼šget, post, put, delete, upload, login// ä¸‹é¢ä»¥postä¸ºä¾‹ï¼špost(url,params) &#123;    return service.post(        url, params, &#123;            transformRequest: [(params) =&gt; &#123;                return JSON.stringify(params)            &#125;],            headers: &#123;                &#x27;Content-Type&#x27;: &#x27;application/json&#x27;            &#125;        &#125;,    )&#125;// serviceçš„postæ–¹æ³•å‘é€çš„urlå‚æ•°å’Œè‡ªèº«å®šä¹‰æ—¶çš„baseUrlç›¸ç»“åˆã€‚\n\n\n\nå¥½çš„ï¼Œæˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹å‘é€è¯·æ±‚çš„é—®é¢˜å§ï¼Œå‘é€è¯·æ±‚çš„æ–¹å¼æ˜¯Axiosï¼Œå®šä¹‰serviceæ—¶è®¾ç½®baseURLä¸ºæœåŠ¡å™¨åŠå…¶ç«¯å£ï¼Œåç»­è°ƒç”¨serviceæ–¹æ³•è¯·æ±‚æ—¶ï¼Œä¼ å…¥è¯·æ±‚è·¯å¾„ï¼ˆåœ¨baseURLçš„åŸºç¡€ä¸Šï¼‰å’Œå‚æ•°å³å¯ã€‚\n\n\nï¼ˆ3ï¼‰æˆ‘ä»¬ææ¸…æ¥šè¯·æ±‚è·¯å¾„ä¹‹åå°±å¯ä»¥åœ¨api&#x2F;user.jsä¸­å®šä¹‰è¯·æ±‚æ–¹æ³•ç”¨äºè·å–ç”¨æˆ·ä¿¡æ¯å’Œè·¯ç”±ä¿¡æ¯äº†\n\n\nï¼ˆ4ï¼‰ ç™»å½•çš„æœ€åéƒ¨åˆ†ï¼Œè¿˜æœ‰ä¸€äº›å°ç»†èŠ‚éœ€è¦ä¿®æ”¹â•°(Â°â–½Â°)â•¯ï¼š è¿”å›çš„tokenéœ€è¦å­˜å‚¨å‘€ï¼š\nimport &#123; getToken, setToken, removeToken &#125; from &#x27;@/utils/auth&#x27;const state = &#123;  token: getToken(),  name: &#x27;&#x27;,  avatar: &#x27;&#x27;,  introduction: &#x27;&#x27;,  roles: [],  createrId: &#x27;&#x27;&#125;const mutations = &#123;  SET_TOKEN: (state, token) =&gt; &#123;    state.token = token  &#125;,&#125;// user loginlogin(&#123; commit &#125;, userInfo) &#123;    const &#123; username, password &#125; = userInfo    return new Promise((resolve, reject) =&gt; &#123;        login(&#123; username: username.trim(), password: password &#125;).then(response =&gt; &#123;            const &#123; token &#125; = response            commit(&#x27;SET_TOKEN&#x27;, token)            setToken(token)            resolve()        &#125;).catch(error =&gt; &#123;            reject(error)        &#125;)    &#125;)&#125;,\n\nç™»å½•æˆåŠŸåï¼Œstateå°±å¯ä»¥å­˜å‚¨userä¿¡æ¯äº†\n\n\n\n\n\né‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯é€€å‡ºç™»å½•äº†:\n\n\nï¼ˆ1ï¼‰åœ¨ api&#x2F;user.js ä¸­å®šä¹‰é€€å‡ºæ–¹æ³•ï¼š\nexport async function logout(param)&#123;Â return await requestHttp.post(&#x27;/rental/auth/logout&#x27;,param)&#125;\n\n\n\nï¼ˆ2ï¼‰åœ¨ utils&#x2F;auth.js ä¸­å®šä¹‰æ¸…é™¤ sessionStorage æ–¹æ³•ï¼š\nexport function removeSessionStoreage()&#123;    return sessionStorage.clear()&#125;\n\n\n\nï¼ˆ3ï¼‰ ä¿®æ”¹ layout&#x2F;components&#x2F;Navbar.vue æ–‡ä»¶ï¼š\nimport &#123;logout&#125; from &#x27;@/api/user&#x27;import &#123;getToken, removeToken, removeSessionStorage&#125; from &#x27;@/utils/auth&#x27;logout() &#123;Â  Â  Â  //ä¿®æ”¹logoutæ–¹æ³•Â  Â  Â //await this.$store.dispatch(&#x27;user/logout&#x27;)Â  Â  Â //this.$router.push(`/login?redirect=$&#123;this.$route.fullPath&#125;`)Â  Â  Â this.$confirm(&#x27;ç¡®å®šé€€å‡ºç³»ç»Ÿå—?&#x27;, &#x27;æç¤º&#x27;, &#123;Â  Â  Â  Â confirmButtonText: &#x27;ç¡®å®š&#x27;,Â  Â  Â  Â cancelButtonText: &#x27;å–æ¶ˆ&#x27;,Â  Â  Â  Â type: &#x27;warning&#x27;Â  Â  &#125;).then(async() =&gt; &#123;Â  Â  Â  Â let token = &#123; token: getToken &#125;    // è·å–tokenÂ  Â  Â  Â let res = await logout(token)      // è°ƒç”¨é€€å‡ºç™»å½•æ–¹æ³•Â  Â  Â  Â if (res.success)&#123;Â  Â  Â  Â  Â removeToken()\t// å»é™¤tokenÂ  Â  Â  Â  Â removeSessionStoreage() Â  Â // æ¸…é™¤SessionStoreage Â  Â Â  Â  Â  Â  Â this.$router.push(`/login?redirect=$&#123;this.$route.fullPath&#125;`)Â  Â  Â  &#125;Â  Â  &#125;).catch(() =&gt; &#123;Â  Â  Â  Â this.$message(&#123;Â  Â  Â  Â  Â type: &#x27;info&#x27;,Â  Â  Â  Â  Â message: &#x27;å·²å–æ¶ˆé€€å‡º&#x27;Â  Â  Â  &#125;);Â  Â &#125;);&#125;\n\n\n\n\n\nå‰ç«¯ä¹‹åŠ¨æ€è·¯ç”±èœå•ç™»å½•æ—¶è·å–äº†ç”¨æˆ·ä¿¡æ¯å’Œè·¯ç”±ä¿¡æ¯ï¼Œå…¶ä¸­ç”¨æˆ·ä¿¡æ¯å­˜å‚¨åœ¨ store&#x2F;modules&#x2F;user.js çš„stateä¸­ï¼Œè€Œè·å–çš„è·¯ç”±ä¿¡æ¯å¾—è½¬åŒ–ä¸ºåŠ¨æ€è·¯ç”±èœå•ï¼Œå¥½çš„ï¼Œç°åœ¨æˆ‘ä»¬æ¥å¼€å§‹è¿™ä¸€éƒ¨åˆ†ï¼š\n\n\n\nåœ¨ api&#x2F;user.js ä¸­ï¼Œå†™è·å–èœå•çš„æ–¹æ³•:\nexport async function getMenuList()&#123;    return await requestHttp.get(&#x27;/rental/auth/menuList&#x27;)&#125;\n\n\n\nä¿®æ”¹ store&#x2F;permission.js æ–‡ä»¶ï¼Œå®ç°åŠ¨æ€è·¯ç”±èœå•\nconst actions = &#123;    generateRoutes(&#123; commit &#125;, roles) &#123;        return new Promise((resolve, reject) =&gt; &#123;            getMenuList().then(response =&gt; &#123;                if (response.code === 200) &#123;                    const accessedRoutes = filterAsyncRoutes(response.data, roles)                    commit(&#x27;SET_ROUTES&#x27;, accessedRoutes)                    resolve(accessedRoutes)  // è¿›è¡Œç´¢å¼•å¯¼èˆª                &#125; else &#123;                    reject(response.msg)                &#125;            &#125;).catch(                error =&gt; &#123;                    reject(error)                &#125;)        &#125;)    &#125;&#125;// æ­¤æ—¶getMenuList()çš„response.dataè¦ç»è¿‡filterAsyncRoutesé€’å½’å¤„ç†export function filterAsyncRoutes(routes, roles) &#123;    const res = []    routes.forEach(route =&gt; &#123;        const tmp = &#123; ...route &#125;        if (hasPermission(roles, tmp)) &#123;            let component = tmp.component  // ç»„ä»¶å¯¹åº”permissionä¸­çš„route_url            if (route.component) &#123;                if (component === &#x27;Layout&#x27;) &#123;                    tmp.component = Layout  // é»˜è®¤å¸ƒå±€å·²ç»å­˜åœ¨è¯¥ç»„ä»¶                &#125; else &#123;                    tmp.component = (resolve) =&gt; require([`@/views$&#123;component&#125;`],                                                         resolve)                &#125;            &#125;            if (tmp.children) &#123;                tmp.children = filterAsyncRoutes(tmp.children, roles)            &#125;            res.push(tmp)        &#125;    &#125;)    return res&#125;const mutations = &#123;    SET_ROUTES: (state, routes) =&gt; &#123;        state.addRoutes = routes        state.routes = constantRoutes.concat(routes)    &#125;&#125;// ç»è¿‡å¤„ç†åçš„routesä¿å­˜åœ¨routeçš„routeså±æ€§ä¸­const state = &#123;Â routes: [],Â addRoutes: []&#125;\n\n\n\nå¥½ï¼Œæˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹åŠ¨æ€ç´¢å¼•èœå•æ˜¯å¦‚ä½•è¿›è¡Œçš„ï¼šå‘åç«¯è¯·æ±‚å¾—åˆ°æ•°æ®åï¼Œç”¨filterAsyncRoutesé€’å½’å¤„ç†ç´¢å¼•è·¯å¾„ component, å°±å¯ä»¥è¿›è¡Œå­˜å‚¨å’Œè½¬æ¢äº†ã€‚\n\n\n\n\næœ€åï¼Œè¿˜æœ‰ä¸€äº›ç»†èŠ‚éœ€è¦ä¿®æ”¹ï¼š\nï¼ˆ1ï¼‰ä¿®æ”¹router-&gt;index.jsæ–‡ä»¶ï¼Œæ³¨é‡Šæ‰documentå’Œguideèœå•ï¼Œå¹¶å°†dashboardæ”¹æˆâ€é¦–é¡µâ€å­—æ ·\nï¼ˆ2ï¼‰ä¿®æ”¹utils-&gt;validate.jsæ–‡ä»¶ï¼Œå¯¹ç”¨æˆ·åçš„æ ¡éªŒ\nexport function validUsername(str) &#123;    //const valid_map = [&#x27;admin&#x27;, &#x27;editor&#x27;]    return str.length&gt;0;&#125;\n\nï¼ˆ3ï¼‰ä¿®æ”¹layout-&gt;components-&gt;Navbar.vueæ–‡ä»¶\nlogout() &#123;Â  Â  Â  //ä¿®æ”¹logoutæ–¹æ³•Â  Â  Â //await this.$store.dispatch(&#x27;user/logout&#x27;)Â  Â  Â //this.$router.push(`/login?redirect=$&#123;this.$route.fullPath&#125;`)Â  Â  Â this.$confirm(&#x27;ç¡®å®šé€€å‡ºç³»ç»Ÿå—?&#x27;, &#x27;æç¤º&#x27;, &#123;Â  Â  Â  Â confirmButtonText: &#x27;ç¡®å®š&#x27;,Â  Â  Â  Â cancelButtonText: &#x27;å–æ¶ˆ&#x27;,Â  Â  Â  Â type: &#x27;warning&#x27;Â  Â  &#125;).then(async() =&gt; &#123;Â  Â  Â  Â let token = &#123; token: getToken &#125;    // è·å–tokenÂ  Â  Â  Â let res = await logout(token)      // è°ƒç”¨é€€å‡ºç™»å½•æ–¹æ³•Â  Â  Â  Â if (res.success)&#123;Â  Â  Â  Â  Â removeToken()\t// å»é™¤tokenÂ  Â  Â  Â  Â removeSessionStoreage() Â  Â // æ¸…é™¤SessionStoreage Â  Â Â  Â  Â  Â  Â // this.$router.push(`/login?redirect=$&#123;this.$route.fullPath&#125;`)         window.location.href = &#x27;/&#x27;Â  Â  Â  &#125;Â  Â  &#125;).catch(() =&gt; &#123;Â  Â  Â  Â this.$message(&#123;Â  Â  Â  Â  Â type: &#x27;info&#x27;,Â  Â  Â  Â  Â message: &#x27;å·²å–æ¶ˆé€€å‡º&#x27;Â  Â  Â  &#125;);Â  Â &#125;);&#125;\n\n\n\n\n\n\n\nç»“è¯­ç›®å‰å·²ç»å®Œæˆäº†é¡¹ç›®çš„å‰ç«¯å¤§ä½“æ¡†æ¶ï¼Œåç»­åœ¨è¿›è¡Œè®¿é—®æƒé™æ¨¡å—å’Œé¡¹ç›®å„éƒ¨åˆ†æ¨¡å—ä¹‹é—´çš„å…³ç³»æ€»ç»“ã€‚\n(&#x2F;Ï‰ï¼¼)\n","categories":["vue","vue-element-admin","javaé¡¹ç›®","æ±½è½¦ç§Ÿèµç®¡ç†ç³»ç»Ÿ"],"tags":["vue"]},{"title":"vue-element-adminä¹‹è´¢åŠ¡ç®¡ç†","url":"/2025/04/24/%E7%BB%9F%E8%AE%A1%E5%9B%BE_excel%E5%AF%BC%E5%87%BA_%E5%8F%91%E9%82%AE%E4%BB%B6/","content":"ä»‹ç»ï¼šåœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥å­¦ä¹ ä¸‰ä¸ªå°çŸ¥è¯†ï¼š echarts ç»Ÿè®¡å›¾ï¼Œ excel å¯¼å‡º å’Œ å‘é€é‚®ä»¶ã€‚\n\n\n\nä¸€.  echartsç»Ÿè®¡å›¾\n\nechartsä¸­æ–‡å®˜ç½‘, è¿™é‡Œæˆ‘ä»¬åªçœ‹é‡å æŠ˜çº¿ç»Ÿè®¡å›¾ï¼Œç®€è¦æ€è·¯å°±æ˜¯ xè½´æ•°æ®ä¸ºå°æ—¶æˆ–æ—¥æœŸæ•°ç»„ï¼Œè€Œseriesçš„æ•°ç»„ä¸ºæ‰€å±•ç°çš„æ•°æ®çš„å¤§å°ï¼Œè¿™ä¸¤éƒ¨åˆ†çš„æ•°ç»„ç´¢å¼•ä¸€ä¸€å¯¹åº”ã€‚\n\n\nç¤ºä¾‹æ•ˆæœï¼š\n\n\n\n\n&lt;el-card&gt;    &lt;div&gt;        &lt;div ref=&quot;Mychart&quot; :style=&quot;&#123; width: &#x27;80%&#x27;, height: &#x27;400px&#x27; &#125;&quot;&gt;&lt;/div&gt;    &lt;/div&gt;&lt;/el-card&gt;&lt;script&gt;export default &#123;    data() &#123;        return &#123;            Mychart: null,            xArray: [],            y1Array: [],        &#125;    &#125;,        mouted() &#123;      this.initRentalChart();    &#125;,        methods: &#123;        initRentalChart() &#123;            this.Mychart = echarts.init(this.$refs.Mychart);            this.Mychart.setOption(&#123;                title: &#123;                    text: &#x27;æ—¥æŠ¥å‡ºç§Ÿæ•°æ®ç»Ÿè®¡&#x27;,                    subtext: new Date().toLocaleDateString(),                &#125;,                tooltip: &#123; // ä¸€äº›ä¾‹å¦‚ç‚¹é€‰çš„æ•ˆæœ                    trigger: &#x27;axis&#x27;,                    axisPointer: &#123;                        type: &#x27;shadow&#x27;                    &#125;                &#125;,                legend: &#123;                    data: [&#x27;å‡ºç§Ÿæ•°é‡&#x27;] // serieså†…å®¹æ•°ç»„                &#125;,                grid: &#123;                    left: &#x27;3%&#x27;,                    right: &#x27;4%&#x27;,                    bottom: &#x27;3%&#x27;,                    containLabel: true                &#125;,                toolbox: &#123;                    show: true,                    orient: &#x27;vertical&#x27;,                    left: &#x27;right&#x27;,                    top: &#x27;center&#x27;,                    feature: &#123; // ä¾§è¾¹æ ï¼šæ•°æ®å±•ç¤ºï¼Œå›¾çš„åˆ‡æ¢ï¼Œä¿å­˜å›¾ç‰‡                        mark: &#123;show: true&#125;,                        dataView: &#123;readOnly: false, show: true&#125;,                        magicType: &#123;                            type: [&#x27;line&#x27;, &#x27;bar&#x27;],                            show: true                        &#125;,                        saveAsImage: &#123;show: true&#125;                    &#125;                &#125;,                xAxis: &#123;                    type: &#x27;category&#x27;,                    boundaryGap: false,                    axisTick: &#123;show: false&#125;,                    data: this.xArray                &#125;,                yAxis: &#123;                    type: &#x27;value&#x27;                &#125;,                series: [                    &#123;                    name: &#x27;å‡ºç§Ÿæ•°é‡&#x27;,                    // type: &#x27;bar&#x27;,                    type: &#x27;line&#x27;,                    // stack: &#x27;Total&#x27;,                    barGap: 0,                    data: this.y1Array                    &#125;,                ]            &#125;);        &#125;,    &#125;&#125;&lt;/script&gt;\n\n\n\n\n\n\n\näºŒ. excelå¯¼å‡º\n\nå°†å¯¹è±¡æ•°ç»„è½¬åŒ–ä¸ºexcelè¡¨ï¼Œå±æ€§ä½œä¸ºè¡¨å¤´ï¼Œå¯ä»¥èµ·åˆ«åå“¦ğŸƒã€‚éœ€è¦ hutool ä¾èµ–åŒ…æ¥å®Œæˆï¼š\n\n\nå¯¼å‡ºæ•ˆæœï¼š\n\n\n\n\nimport cn.hutool.poi.excel.ExcelUtil;import cn.hutool.poi.excel.ExcelWriter;@GetMapping(&quot;exportExcel&quot;)public void export(HttpServletResponse response) throws IOException &#123;    List&lt;AutoBrand&gt; list=autoBrandService.list();    // åˆ—è¡¨è½¬åŒ–ä¸ºexcelæ–‡ä»¶    ExcelWriter writer= ExcelUtil.getWriter(true);    writer.addHeaderAlias(&quot;brandName&quot;,&quot;å“ç‰Œåç§°&quot;);    writer.addHeaderAlias(&quot;deleted&quot;,&quot;æ˜¯å¦åˆ é™¤&quot;);    writer.write(list,true);    // è®¾ç½®responseæ ¼å¼å’Œä¼ è¾“çš„æ–‡ä»¶å    response.setContentType(&quot;application/vnd.openxmlformats-                            officedocument.spreadsheetml.sheet;charset:utf-8&quot;);    String fileName= URLEncoder.encode(&quot;æ±½è½¦å“ç‰Œ&quot;,StandardCharsets.UTF_8);    response.setHeader(&quot;Content-Disposition&quot;,&quot;attachment;                       filename=&quot;+fileName+&quot;.xlsx&quot;);                                      \t  writer.flush(response.getOutputStream(),true);    writer.close();&#125;\n\n\n\n\n\n\n\nä¸‰. å‘é‚®ä»¶\n\n\nè¿›è¡Œapplication.ymlé…ç½®:\nspring:  mail:    host: smtp.163.com # smtpä¸ºç®€å•é‚®ä»¶åè®®    port: 25    username: a838211536@163.com # é‚®ç®±å    password: QNg9GeYBpeybQRMT # æˆæƒå¯†ç     properties:      mail.smtp.auth: true # å¯ç”¨è®¤è¯      mail.smtp.starttls.enable: true  # å¯ç”¨TLS      mail.smtp.starttls.required: true\n\n\n\nå®šä¹‰IMailServiceæ¥å£åŠå…¶å®ä¹ ç±»MailServiceImpl, éœ€æ³¨æ„ï¼šå¦‚æœjavaMailSenderæ— æ³•è‡ªåŠ¨æ³¨å…¥çš„è¯ï¼Œè¿˜éœ€è¦è‡ªå·±å†™ä¸€ä¸ªäº§ç”Ÿ javaMailSender bean çš„é…ç½®ç±»ã€‚\n\n\n@Servicepublic class MailServiceImpl implements IMailService &#123;    @Autowired    private JavaMailSender javaMailSender;    /**     * å‘é€é‚®ä»¶     *     * @param mail é‚®ä»¶æ•°æ®å¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹å…³é”®å­—æ®µï¼š     *             - from:    å‘ä»¶äººåœ°å€     *             - to:      æ”¶ä»¶äººåœ°å€ï¼ˆæ”¯æŒå¤šä¸ªï¼‰     *             - subject: é‚®ä»¶ä¸»é¢˜     *             - content: é‚®ä»¶æ­£æ–‡å†…å®¹     * å®ç°è¯´æ˜ï¼š     * 1. ä½¿ç”¨SimpleMailMessageæ„å»ºåŸºç¡€é‚®ä»¶ä¿¡æ¯     * 2. è®¾ç½®å‘ä»¶äººã€æ”¶ä»¶äººã€ä¸»é¢˜ã€æ­£æ–‡ç­‰æ ¸å¿ƒå­—æ®µ     * 3. å°†å‘ä»¶äººåŒæ—¶æ·»åŠ åˆ°æŠ„é€åˆ—è¡¨ï¼ˆéœ€ç¡®è®¤æ˜¯å¦ç¬¦åˆä¸šåŠ¡éœ€æ±‚ï¼‰     * 4. é€šè¿‡JavaMailSenderæ‰§è¡Œé‚®ä»¶å‘é€     *     * @throws MailException å½“é‚®ä»¶å‘é€å¤±è´¥æ—¶æŠ›å‡ºç›¸å…³å¼‚å¸¸     */    @Override    public void sendMail(MailVO mail) throws MailException &#123;        // æ„å»ºåŸºç¡€é‚®ä»¶æ¶ˆæ¯å¯¹è±¡        SimpleMailMessage message = new SimpleMailMessage();        // è®¾ç½®é‚®ä»¶åŸºæœ¬ä¿¡æ¯        message.setFrom(mail.getFrom());        message.setTo(mail.getTo());        message.setSubject(mail.getSubject());        message.setText(mail.getContent());        // è®¾ç½®å‘ä»¶äººåŒæ—¶ä½œä¸ºæŠ„é€ï¼ˆæ ¹æ®ä¸šåŠ¡éœ€æ±‚å¯èƒ½éœ€è¦è°ƒæ•´ï¼‰        message.setCc(mail.getFrom());        // æ‰§è¡Œé‚®ä»¶å‘é€æ“ä½œ        javaMailSender.send(message);    &#125;\n\n\n\nå¥½çš„ï¼Œåˆ°è¿™é‡Œå°±å¯ä»¥è¿›è¡Œé‚®ä»¶å‘é€æ“ä½œäº†ï¼Œä½†æ˜¯å¦‚ä½•è¿›è¡Œå®šæ—¶å‘é€é‚®ä»¶å‘¢ï¼Ÿ\n\n\nå®šæ—¶å‘é€é‚®ä»¶, è¿™é‡Œå°±ä»¥è´¢åŠ¡ç®¡ç†çš„æ—¥æŠ¥æ”¶å…¥éƒ¨åˆ†ä¸ºä¾‹å§ï¼š\n@Componentpublic class SendMailUtil &#123;    @Autowired    private IFinanceService financeService;    @Autowired    private IMailService mailService;    @Value(&quot;$&#123;spring.mail.username&#125;&quot;)    private String from;    @Scheduled(cron = &quot;*/10 * * * * ?&quot;)    public void sendMail() &#123;        StringBuffer sbf = new StringBuffer();        sbf.append(&quot;ä»Šæ—¥æ”¶å…¥ï¼š&quot;)                .append(&quot;ï¼Œç§Ÿé‡‘æ”¶å…¥ï¼š&quot;)                .append(financeService.sumRentPay().getCountActualPayable())                .append(&quot;ï¼ŒæŠ¼é‡‘æ”¶å…¥ï¼š&quot;)                .append(financeService.sumDeposit());        MailVO mailVO = new MailVO();        // è®¾ç½®å››éƒ¨åˆ†ï¼šfrom, to, subject, content        mailVO.setFrom(from);        mailVO.setTo(&quot;a838211536@163.com&quot;);        String date = LocalDate.now().format(DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd&quot;));        mailVO.setSubject(date + &quot;ä»Šæ—¥æ”¶å…¥&quot;);        mailVO.setContent(sbf.toString());        mailService.sendMail(mailVO);    &#125;&#125;\n\n\n\nå¥½çš„ï¼Œè¿™æ ·çœ‹æ¥ï¼Œé‚®ä»¶å‘é€å°±ç®€å•äº†ï¼šï¼ˆ1ï¼‰javaMailSenderçš„é…ç½®     ï¼ˆ2ï¼‰å¡«å†™å‘é€ä¿¡æ¯å¯¹è±¡\n\n\n","categories":["vue","vue-element-admin","javaé¡¹ç›®","æ±½è½¦ç§Ÿèµç®¡ç†ç³»ç»Ÿ"],"tags":["echartsç»Ÿè®¡å›¾","excelå¯¼å‡º","å‘é‚®ä»¶"]},{"title":"Spring Security","url":"/2025/04/24/spring-security/","content":"ä»‹ç»ï¼š æ˜¯ä¸€å¥—åç«¯è®¿é—®å’Œæƒé™æ ¡éªŒçš„æ¡†æ¶ï¼Œç”±ä¸€ç³»åˆ—çš„è¿‡æ»¤é“¾ç»„æˆï¼Œæˆ‘ä»¬ä¸»è¦æ“ä½œçš„æ˜¯ä¸‰éƒ¨åˆ†ï¼š\n\nè®¤è¯æ ¸å¿ƒï¼ˆUsernamePasswordAuthenticationFilterï¼‰ \n\nå¤„ç†è®¤è¯å’Œæˆæƒå¼‚å¸¸ï¼ˆExceptionTranslationFilterï¼‰\n\næˆæƒæ ¸å¿ƒï¼ˆFilterSecurityï¼‰\n\n\næˆ‘ä»¬ä¸»è¦ä»è®¤è¯å’Œæˆæƒè¿™ä¸¤ä¸ªæ–¹é¢æ¥æ€»ç»“ã€‚\n\n\n\n\n\n\nä¸€. è®¤è¯\n\nè®¤è¯å°±æ˜¯è®¤è¯æ ¸å¿ƒ UsernamePasswordAuthenticationFilter è¿‡æ»¤å™¨æ¥è¿›è¡Œçš„ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æµç¨‹å›¾ï¼š\n\n\n\n\n\n\n\nç”¨æˆ·åˆæ¬¡ç™»å½•\n\nå…·ä½“æµç¨‹ï¼š \nï¼ˆ1ï¼‰æ¥å—ç”¨æˆ·å‘é€è¯·æ±‚æºå¸¦çš„usernameå’Œpasswordï¼Œå°è£…ä¸ºAuthenticationå¯¹è±¡ï¼Œè°ƒç”¨AuthenticaionManagerï¼ˆå«æœ‰UserDetailsServiceæ¥å£å®ç°ç±»å’ŒPasswordEncoderå¯†ç æ ¡éªŒï¼‰\n\n\nï¼ˆ2ï¼‰ UserDetailsServiceæ¥å£å®ç°ç±»æ ¹æ®usernameæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼ŒåŠå…¶æƒé™ä¿¡æ¯ï¼Œå°è£…åˆ°UserDetailså¯¹è±¡å®ç°ç±»é‡Œã€‚ç»è¿‡PasswordEncoderçš„æ¥å£å®ç°ç±»BCryptPasswordEncoderçš„æ ¡éªŒï¼Œé€šè¿‡æ ¡éªŒåˆ™å°†UserDetailsæ¥å£å®ç°ç±»å¯¹è±¡å°è£…åˆ°Authenticationå¯¹è±¡é‡Œ, ä¸é€šè¿‡åˆ™åˆ°ç™»å½•å¤±è´¥å¤„ç†å™¨è¿”å›ç™»å½•å¤±è´¥ä¿¡æ¯ã€‚\n\n\nï¼ˆ3ï¼‰æœ€åå°†å¯¹è±¡è¿”å›å¹¶ä¸”å­˜å…¥SecurityContextHolder.getContext()é‡Œã€‚\n\n\nï¼ˆ4ï¼‰å­˜å…¥å¹¶è¿”å›token: é€šè¿‡UsernamePasswordAuthenticationFilteråï¼Œåˆ°è¾¾ç™»å½•æˆåŠŸå¤„ç†å™¨LoginSucessHandlerï¼Œé¦–å…ˆæ ¹æ® Authenticationå¯¹è±¡ è·å– User å¯¹è±¡ï¼ˆå°è£…ç”¨æˆ·ä¿¡æ¯å’Œæƒé™ä¿¡æ¯ï¼‰ï¼Œå†æå– username å’Œ userId ç”Ÿæˆtoken, outputStreamæµè¿”å›tokenå¹¶å°†tokenï¼ŒåŠæœ‰æ•ˆæ—¶é—´é•¿åº¦å­˜å‚¨åˆ°redisä¸­ã€‚\n\n\n\n\né‚£ä¾¿æœ‰ä¸€ä¸ªé—®é¢˜äº†ï¼Œè¿™ä¸ªç™»å½•æˆåŠŸå¤„ç†å™¨ä¸åœ¨è¿™ä¸‰å¤§è¿‡æ»¤å™¨ä¹‹å†…å‘€ï¼Œå¦‚ä½•é…ç½®å‘¢ï¼Ÿå“ˆå“ˆï¼Œè¦ç»è¿‡SecurityConfigé…ç½®çš„ï¼Œäº‹å®ä¸Šï¼ŒSecurityConfigæ˜¯é…ç½®æ•´ä¸ªå®‰å…¨è¿‡æ»¤å™¨é“¾çš„ã€‚\n@Configuration@EnableWebSecurity@EnableMethodSecuritypublic class SecurityConfig &#123;    @Autowired    private LoginSuccessHandler loginSuccessHandler;    @Autowired    private LoginFailHandler loginFailHandler;    @Autowired    private CustomerAccessDeniedHandler customerAccessDeniedHandler;    @Autowired    private CustomerAnonymousEntryPoint customerAnonymousEntryPoint;    @Autowired    private CustomerUserDetailsService customerUserDetailsService;    @Autowired    private  VerifyTokenFilter verifyTokenFilter;    /**     * é…ç½®å®‰å…¨è¿‡æ»¤å™¨é“¾     * @param http     * @return     * @throws Exception     */    @Bean    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception &#123;        // ç™»å½•å‰è¿‡æ»¤é…ç½®        http.addFilterBefore(verifyTokenFilter, UsernamePasswordAuthenticationFilter.class);        //        http.formLogin()                .loginProcessingUrl(&quot;/rental/user/login&quot;) // è®¾ç½®ç™»å½•å¤„ç†URL                .successHandler(loginSuccessHandler) // è®¾ç½®ç™»å½•æˆåŠŸå¤„ç†å™¨                .failureHandler(loginFailHandler) // è®¾ç½®ç™»å½•å¤±è´¥å¤„ç†å™¨                .and()                .sessionManagement()                .sessionCreationPolicy(SessionCreationPolicy.STATELESS) // è®¾ç½®ä¼šè¯åˆ›å»ºç­–ç•¥ä¸ºæ— çŠ¶æ€                .and()                .authorizeHttpRequests() // æˆæƒè¯·æ±‚é…ç½®                .requestMatchers(&quot;/rental/user/login&quot;) // åŒ¹é…ç™»å½•è¯·æ±‚                .permitAll() // å…è®¸æ‰€æœ‰è¯·æ±‚è®¿é—®                .anyRequest().authenticated() // ä»»ä½•å…¶ä»–è¯·æ±‚éœ€è¦è®¤è¯                .and()                .exceptionHandling() // å¼‚å¸¸å¤„ç†é…ç½®                .authenticationEntryPoint(customerAnonymousEntryPoint) // è®¾ç½®æœªè®¤è¯å…¥å£ç‚¹                .accessDeniedHandler(customerAccessDeniedHandler) // è®¾ç½®è®¿é—®æ‹’ç»å¤„ç†å™¨                .and()                .cors() // è·¨åŸŸé…ç½®                .and()                .csrf().disable() // å…³é—­CSRFä¿æŠ¤  è·¨ç«™è¯·æ±‚ä¼ªé€  æ˜¯ä¸€ç§ç½‘ç»œæ”»å‡»                .userDetailsService(customerUserDetailsService); // è®¾ç½®ç”¨æˆ·è¯¦æƒ…æœåŠ¡        return http.build(); // æ„å»ºå¹¶è¿”å›å®‰å…¨è¿‡æ»¤é“¾    &#125;&#125;\n\n\n\n\n\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°é…ç½®çš„å†…å®¹ä¸ºï¼š\nç™»å½•å‰ï¼šUsernamePasswordAuthenticationFilter\nç™»å½•å¤±è´¥ï¼Œç™»å½•æˆåŠŸ\nè¯·æ±‚è®¿é—®ç­–ç•¥\nå¼‚å¸¸å¤„ç†\nè·¨åŸŸé…ç½®\nuserDetailsServiceæ¥å£å®ç°ç±»\n\n\n\n\n\nç”¨æˆ·æºå¸¦tokenç™»å½•å…·ä½“æµç¨‹ï¼šç”¨æˆ·æºå¸¦tokenè®¿é—®éloginçš„urléœ€è¦ç»è¿‡verifyTokenFilteréªŒè¯ï¼Œtokenä¸ºç©ºï¼Œä¸åœ¨rediså†…ï¼Œä¸å¯è§£æåˆ™æŠ›å‡ºè®¤è¯å¼‚å¸¸è¢«ç™»å½•å¤±è´¥å¤„ç†å™¨æ•æ‰ï¼Œå¦åˆ™è§£æusernameï¼Œè°ƒç”¨UserDetailsServiceæ¥å£å®ç°ç±»è¿›è¡ŒæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯å’Œæƒé™ä¿¡æ¯ï¼Œå°è£…åˆ°Authenticationå¯¹è±¡å¹¶å­˜å‚¨åˆ°SecurityContextHolder.getContext()é‡Œã€‚\n\n\n\n\n\n\näºŒ. æˆæƒ\n\n\nå‰é¢æˆ‘ä»¬è°ƒç”¨UserDetailServiceå®ä¹ ç±»loadByUserNameæ–¹æ³•æŸ¥è¯¢æƒé™ä¿¡æ¯å¹¶ä¸”å­˜å‚¨åˆ°UserDetailçš„å®ç°ç±»ä¸­ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æƒé™ä¿¡æ¯çš„åˆ›å»ºè¿‡ç¨‹ï¼š\n\n// æŸ¥è¯¢æƒé™ä¿¡æ¯List&lt;Permission&gt; permissionList = permissionService.selectPermissionListByUserId(user.getId());user.setPermissionList(permissionList);// é€šè¿‡streamæµå¤„ç†ï¼Œå°†æƒé™å¯¹è±¡è½¬åŒ–ä¸ºæƒé™å­—ç¬¦ä¸²åˆ—è¡¨List&lt;String&gt; list = permissionList.stream().filter(Objects::nonNull)    .map(Permission::getPermissionCode)    .filter(Objects::nonNull)    .toList();String[] array = list.toArray(new String[list.size()]);List&lt;GrantedAuthority&gt; authorityList = AuthorityUtils.createAuthorityList(array);user.setAuthorities(authorityList);\n\n\n\nå¯ä»¥çœ‹åˆ°æƒé™ä¿¡æ¯æ˜¯æ ¹æ®permissionCodeå­—æ®µè¿›è¡Œåˆ›å»ºçš„ã€‚\n\n\n\nç°åœ¨å·²çŸ¥æƒé™ä¿¡æ¯çš„å…·ä½“æ ¼å¼ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹å…·ä½“çš„æˆæƒæ“ä½œï¼Œä»¥æ–°å¢è§’è‰²ä¸ºä¾‹ï¼š\n@PostMapping@PreAuthorize(&quot;hasAuthority(&#x27;sys:role:add&#x27;)&quot;)public Result add(@RequestBody Role role) &#123;    role.setDeleted(false);    return roleService.save(role) ?  Result.success() : Result.fail();&#125;\n\néœ€è¦ PreAuthorize æ³¨è§£ å’Œ hasAuthority æ–¹æ³•å°±å¥½äº†ï¼Œæ–¹æ³•å‚æ•°å³ä¸ºä¸Šé¢æäº¤çš„permissionCodeğŸ˜\n\n\nç°åœ¨æˆæƒå¤§ä½“å·²ç»è®²å®Œäº†ï¼Œå¦å¤–è¿˜å¯ä»¥è‡ªå·±å®šä¹‰hasAuthorityæ–¹æ³•å‘¦ğŸƒï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹è¿‡ç¨‹å§ï¼š\n@Component(&quot;ex&quot;)public class MyExpressionRoot &#123;    public boolean hasAuthority(String authority)&#123;        //è·å–èº«ä»½ä»¤ç‰Œ        Authentication authentication = SecurityContextHolder.getContext().getAuthentication();        //è·å–æƒé™        Collection&lt;? extends GrantedAuthority&gt; authorities = authentication.getAuthorities();        //å¾ªç¯åˆ¤æ–­        for (GrantedAuthority grantedAuthority : authorities) &#123;            String role = grantedAuthority.getAuthority(); // è·å–string            if (role.equals(authority)) &#123;                return true;            &#125;        &#125;        return false;    &#125;&#125;// ä½¿ç”¨ï¼š@PreAuthorize(&quot;@ex.hasAuthority(&#x27;&#x27;)&quot;)\n\nç»“è¯­å¥½äº†ï¼Œç°åœ¨spring securityå·²ç»æ€»ç»“å®Œäº†ï¼Œæ…¢æ…¢å­¦ä¹ ï¼Œæ€è€ƒå’Œæ€»ç»“ï¼Œç†Ÿç»ƒäº†å°±ç®€å•äº†ğŸ˜\n","categories":["javaé¡¹ç›®","æ±½è½¦ç§Ÿèµç®¡ç†ç³»ç»Ÿ","javaæ¡†æ¶","SpringSecurity"],"tags":["SpringSecurity"]},{"title":"æ ¸å¿ƒä¸šåŠ¡é€»è¾‘","url":"/2025/04/25/%E6%A0%B8%E5%BF%83%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91/","content":"ä»‹ç»ï¼šæ€»ç»“ä¸€ä¸‹æ±½è½¦ç§Ÿèµç®¡ç†ç³»ç»Ÿçš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œæœ‰å››å¤§æ¿å—ï¼š\nï¼ˆ1ï¼‰æƒé™ç®¡ç†\nï¼ˆ2ï¼‰æ•°æ®åˆå§‹\nï¼ˆ3ï¼‰æ—¥å¸¸ä¸šåŠ¡\nï¼ˆ4ï¼‰è´¢åŠ¡ç®¡ç†\nè¿™æ ·æ˜¯æŒ‰ç…§å¼€å‘é¡ºåºæ¥æ’çš„ï¼šæˆ‘ä»¬çš„é¡¹ç›®é¦–å…ˆç™»å½•è¿›å»ï¼Œæ ¹æ®ç™»å½•ç”¨æˆ·çš„æƒé™ä¿¡æ¯æ˜¾ç¤ºå·¦ä¾§èœå•æ ï¼Œè½¦è¾†ä¿¡æ¯è¦è¿›è¡Œè®¾ç½®ï¼Œç„¶åå¯ä»¥æ“ä½œæ—¥å¸¸ä¸šåŠ¡æ¿å—äº†ï¼Œæœ€åå¯ä»¥è¿›è¡Œè´¢åŠ¡ç®¡ç†ã€‚\n\n\n\n\nä¸€. æƒé™ç®¡ç†\n\nè¿™ä¸€æ¨¡å—æ˜¯æˆ‘ä»¬æ•´ä¸ªé¡¹ç›®çš„åŸºç¡€ï¼Œç”¨æˆ·â€”è§’è‰²â€”æƒé™èµ„æº è¿™ä¸‰å¤§éƒ¨åˆ†ç›¸å…³è”ï¼Œå½“ç„¶è¿˜æœ‰éƒ¨é—¨â€”ç”¨æˆ·ï¼Œè¿™é‡Œä¸»è¦ä»‹ç»é‡ç‚¹ï¼š æƒé™èµ„æº permission è¡¨ï¼Œè¡¨ä¸­åŒ…å«äº†å››å¤§æ¿å—æ‰€æœ‰çš„æƒé™åŠå…¶å­æƒé™ã€‚\n\n\nå››å¤§æ¿å—çš„æƒé™åˆ†çº§ï¼šé¡¶çº§ç›®å½•(0), èœå•(1), æ“ä½œ(2) \n\n\né‚£ä¹ˆå°±æœ‰ä¸€ä¸ªé—®é¢˜äº†ï¼Œæˆ‘ä»¬ç™»å½•ç”¨æˆ·çš„æƒé™å’Œè¿™å››å¤§æ¿å—çš„æƒé™æœ‰å•¥å…³ç³»å‘€ï¼Ÿå…¶å®å¯ä»¥ä»è®¿é—®å’Œæ“ä½œè¿™ä¸¤éƒ¨åˆ†å‡ºå‘ï¼š\nï¼ˆ1ï¼‰è®¿é—®ï¼š é¡¶çº§ç›®å½•å’Œèœå•éƒ¨åˆ†\n\n\nï¼ˆ2ï¼‰æ“ä½œï¼šå¢åˆ æ”¹æŸ¥\n\n\nç®€å•ç‚¹è¯´ï¼Œå°±æ˜¯ï¼Œä½ ç”¨æˆ·çš„æƒé™åŒ…å«é¡¶çº§ç›®å½•å’Œèœå•ï¼Œå°±å¯ä»¥åœ¨èœå•ä¾§è¾¹æ æ˜¾ç¤ºï¼Œå†åŒ…å«ç›¸å…³æ“ä½œæƒé™ï¼Œå°±å¯ä»¥å¯¹ç›¸å…³é¡µé¢è¿›è¡Œç›¸å…³æ“ä½œã€‚å¦‚æœç”¨æˆ·æƒé™åŒ…æ‹¬æƒé™ç®¡ç†åŠå…¶æ‰€æœ‰å­æƒé™ï¼Œå°±å¯ä»¥åœ¨è¯¥æ¿å—ç¼–è¾‘è‡ªå·±æˆ–å…¶ä»–ç”¨æˆ·çš„æƒé™èµ„æºåˆ†é…ã€‚\n\n\näº†è§£äº†å…·ä½“åŸç†åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹è¿™å››ä¸ªéƒ¨åˆ†çš„åŠŸèƒ½\n\néƒ¨é—¨ç®¡ç†ï¼šå¢åˆ æ”¹æŸ¥\n\nç”¨æˆ·ç®¡ç†ï¼šå¢ï¼ˆé€‰æ‹©éƒ¨é—¨ï¼Œå…ˆåˆ å…³è”å†æ·»å…³è”ï¼‰ï¼Œåˆ ï¼ˆåˆ é™¤ä¸è§’è‰²çš„å…³è”ï¼‰ï¼Œæ”¹ï¼ŒæŸ¥ï¼Œç»‘å®šè§’è‰²\n\nè§’è‰²ç®¡ç†ï¼šå¢ï¼Œåˆ ï¼ˆåˆ é™¤ä¸ç”¨æˆ·å…³è”ï¼Œåˆ é™¤ä¸æƒé™å…³è”ï¼‰ï¼Œæ”¹ï¼ŒæŸ¥ï¼Œè®¾ç½®æƒé™\n\nèœå•ç®¡ç†ï¼šå¢åˆ æ”¹æŸ¥\n\n\n\n\näºŒ. æ•°æ®åˆå§‹\n\nè¿™ä¸€éƒ¨åˆ†å°±æ˜¯è®¾ç½®è½¦è¾†ä¿¡æ¯çš„ï¼Œæ•ˆæœå›¾å¦‚ä¸‹ï¼š\n\n\næˆ‘ä»¬ç›´æ¥æ¥çœ‹æ“ä½œï¼š\n\nè½¦è¾†å‚å•†ï¼šå¢åˆ æ”¹æŸ¥\n\nè½¦è¾†å“ç‰Œï¼šå¢ï¼ˆé€‰æ‹©è½¦è¾†å‚å•†ï¼‰ï¼Œåˆ ï¼Œæ”¹ï¼ŒæŸ¥ï¼ˆæ˜¾ç¤ºå‚å•†åç§°ï¼‰\n\nå‡ºç§Ÿç±»å‹ï¼šå¢åˆ æ”¹æŸ¥\n\nè½¦è¾†ä¿¡æ¯ï¼šå¢ï¼ˆæ‰€å±å‚å•†ï¼Œæ‰€å±å“ç‰Œï¼‰ï¼Œåˆ ï¼Œæ”¹ï¼ŒæŸ¥\n\n\n\n\nä¸‰. æ—¥å¸¸ä¸šåŠ¡\n\nè¿™ä¸€éƒ¨åˆ†å°±æ˜¯é‡ä¸­ä¹‹é‡äº†ï¼Œæ•ˆæœå›¾å¦‚ä¸‹ï¼š\n\n\nï¼ˆ1ï¼‰å®¢æˆ·ç®¡ç†ï¼šå¢åˆ æ”¹æŸ¥\nï¼ˆ2ï¼‰æ±½è½¦å‡ºç§Ÿï¼šç®¡ç†ä¸ºå‡ºç§Ÿçš„æ±½è½¦ï¼ŒæŸ¥ï¼ˆæ±½è½¦status&#x3D;0ï¼‰ï¼Œå‡ºç§Ÿï¼ˆå¡«å†™å‡ºç§Ÿç±»å‹å’Œç”¨æˆ·ä¿¡æ¯â€“&gt; æ–°å¢è®¢å•, ä¿®æ”¹æ±½è½¦çŠ¶æ€status&#x3D;1ï¼‰\nï¼ˆ3ï¼‰è®¢å•è¯¦æƒ…ï¼šæŸ¥è¯¢ï¼Œè®¢å•è¯¦æƒ…ï¼ŒæŠ¼é‡‘è¿”è¿˜\nï¼ˆ4ï¼‰è¿ç« å¤„ç†ï¼šå¢ï¼ˆè½¦ç‰Œå·ï¼Œè¿ç« ä¿¡æ¯ï¼‰ï¼Œåˆ ï¼Œæ”¹ï¼ŒæŸ¥\nï¼ˆ5ï¼‰è½¦è¾†ä¿å…»ï¼šå¢ï¼ˆæŸ¥è¯¢éœ€è¦ä¿å…»çš„è½¦ç‰Œå·ï¼‰ï¼Œåˆ ï¼Œæ”¹ï¼ŒæŸ¥\nï¼ˆ6ï¼‰è½¦è¾†å½’è¿˜ï¼šç®¡ç†æœªå½’è¿˜çš„è½¦è¾†ï¼Œæ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯ï¼Œè½¦è¾†ä¿¡æ¯ï¼Œè®¢å•ä¿¡æ¯ï¼Œå‡ºç§Ÿç±»å‹çš„è”åˆæŸ¥è¯¢ã€‚æŸ¥è¯¢ï¼Œå½’è¿˜\n\n\n\n\nå››. è´¢åŠ¡ç®¡ç†\n\nä¸»è¦æ˜¯ echarts ç»Ÿè®¡å›¾ï¼Œexcelè¡¨å¯¼å‡ºï¼Œå®šæœŸå‘é‚®ä»¶è¿™ä¸‰éƒ¨åˆ†ï¼Œä¹‹å‰å·²ç»æ€»ç»“äº†ï¼Œè¯·å‚è€ƒï¼š\nvue-element-admin\n","categories":["javaé¡¹ç›®","æ±½è½¦ç§Ÿèµç®¡ç†ç³»ç»Ÿ"]},{"title":"ç®—æ³•åˆ·é¢˜ä¹‹å‰è¨€","url":"/2025/04/25/%E7%AE%97%E6%B3%95%E5%88%B7%E9%A2%98%E4%B9%8B%E5%89%8D%E8%A8%80/","content":"ä»‹ç»ï¼šå›æƒ³è‡ªå·±å­¦ä¹ ç®—æ³•çš„è¿‡ç¨‹ï¼Œå…ˆæ˜¯å¤§è‡´çœ‹å®Œäº†Kç¥çš„ã€ŠHelloç®—æ³•ã€‹javaç‰ˆï¼Œåˆåœ¨leetcodeä¸­åˆ·äº†å¤§æ¦‚30é¢˜ï¼ŒÎµ&#x3D;(Â´Î¿ï½€*)))å”‰ï¼Œå› ä¸ºæœ€è¿‘åšé¡¹ç›®æŠŠæ¡ä¸å‡†æ—¶é—´ï¼Œæ¯å¤©æœ€åæ€»æ˜¯æ²¡æ—¶é—´åˆ·é¢˜ï¼Œå†™ä¸‹æ¥åæ€åæ€ï¼Œæ¯å¤©åˆ·ä¸¤é¢˜ï¼Œæ¯å¤©è®°å½•è®°å½•è‡ªå·±çš„åˆ·é¢˜æ„Ÿå—ï¼Œåå¤©ä¸ºå•ä½å‘ä¸€ç¯‡æ–‡ç« ï¼Œç›‘ç£è‡ªå·±çš„è¿›åº¦é¡ºä¾¿æ€»ç»“ä¸€ä¸‹Kç¥çš„Helloç®—æ³•éƒ¨åˆ†ï¼ŒåŠ æ²¹ï¼\n","categories":["ç®—æ³•åˆ·é¢˜"],"tags":["ç®—æ³•"]},{"title":"ç™¾æ—¥ç­‘åŸºä¹‹å‰è¨€","url":"/2025/04/25/%E7%99%BE%E6%97%A5%E7%AD%91%E5%9F%BA%E4%B9%8B%E5%89%8D%E8%A8%80/","content":"ä»Šå¤©æˆ‘å®šä¸€ä¸ªç™¾æ—¥ç­‘åŸºçš„è®¡åˆ’ï¼Œå†…å®¹ä¸ºæˆ’è‰²å’Œé”»ç‚¼ï¼Œä¹‹å‰ä¹Ÿå°è¯•è¿‡ï¼Œä½†éƒ½ä»¥å¤±è´¥å‘Šç»ˆï¼Œå›æƒ³åšæŒæœ€é•¿çš„ä¸€æ®µæ—¶é—´ï¼Œæ˜¯åœ¨æˆ’è‰²æ–‡ç« å’Œæˆ’è‰²å£å·çš„ç†é™¶ä¸‹ï¼ŒåŸæœ¬æˆ‘ä»¥ä¸ºå½¢å¼åŒ–çš„æ„ä¹‰ä¸å¤§ï¼Œä½†äº‹å®è¯æ˜ç¯å¢ƒå¯¹ä¸€ä¸ªäººçš„å½±å“æå¤§ï¼Œèªæ˜çš„äººæ€»èƒ½æŠŠè‡ªå·±ç½®äºåˆé€‚çš„ç¯å¢ƒï¼Œèµ‹äºˆè‡ªå·±é©±åŠ¨åŠ›å’Œæ‰§è¡ŒåŠ›ï¼Œå½“ç„¶ï¼Œè¿™ä¸€åˆ‡çš„å‰ææ˜¯å¿ƒä¸­å®å¤§çš„å¿—å‘ã€‚æ‰€ä»¥ï¼Œä»Šå¤©æˆ‘å‘èµ·ç™¾æ—¥ç­‘åŸºè®¡åˆ’ï¼Œæ¯å¤©è®°å½•è‡ªå·±å­¦ä¹ æˆ’è‰²çš„çŸ¥è¯†å’Œé”»ç‚¼çš„æ„Ÿå—ï¼Œåå¤©ä¸ºä¸€ç¯‡æ–‡ç« ï¼Œåˆ†äº«è‡ªå·±çš„å¿ƒå¾—æ„Ÿæ‚Ÿã€‚\n","categories":["ç™¾æ—¥ç­‘åŸº"]},{"title":"Linuxéƒ¨ç½²javaç¯å¢ƒ","url":"/2025/04/26/Linux%E9%83%A8%E7%BD%B2java%E7%8E%AF%E5%A2%83/","content":"è¿œç¨‹è¿æ¥å·¥å…·FinalShell, åŠŸèƒ½ï¼šssh, ftp\n\n\nä¸€. å®‰è£…é…ç½®JDK\n\n\nåˆ©ç”¨FinalShellä¸Šä¼ æ–‡ä»¶åŠŸèƒ½ä¸Šä¼  jdk å®‰è£…åŒ…\n\n\nè§£å‹ï¼š tar -zxvf å®‰è£…åŒ…å -C è§£å‹ç›®å½•, è¿™é‡Œæˆ‘çš„è§£å‹ç›®å½•æ˜¯ &#x2F;usr&#x2F;local\n\n\né…ç½®ç¯å¢ƒå˜é‡ï¼šæ“ä½œæ–‡ä»¶ &#x2F;etc&#x2F;profileï¼Œåœ¨æ–‡ä»¶æœ«å°¾åŠ ä¸Šï¼š\nJAVA_HOME=/usr/local/jdk1.8.0_171PATH=$JAVA_HOME/bin:$PATH\n\n\n\né‡æ–°åŠ è½½æ–‡ä»¶ï¼Œæ£€æŸ¥æ˜¯å¦é…ç½®æˆåŠŸï¼š\nsource /etc/profilejava -version\n\n\n\n\n\näºŒ. å®‰è£…é…ç½®Tomcat\n\n\nåˆ©ç”¨FinalShellä¸Šä¼ å®‰è£…åŒ…å¹¶è§£å‹åˆ° &#x2F;usr&#x2F;local&#x2F;\n\n\nå¯åŠ¨tomcat\ncd /usr/local/tomcatæ–‡ä»¶çˆ¶ç›®å½•/binsh startup.sh\n\n\n\næŸ¥çœ‹tomcatè¿è¡Œè¿›ç¨‹ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š\nï¼ˆ1ï¼‰tomcat å¯åŠ¨æ—¥å¿— catalina.out\n// æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶å°¾éƒ¨çš„50è¡Œè®°å½•tail -50 /usr/local/apache-tomcat-7.0.57/logs/catalina.out\n\nï¼ˆ2ï¼‰æŸ¥çœ‹å¹¶ç­›é€‰ç³»ç»Ÿè¿›ç¨‹\nps -ef|grep tomcat\n\n\n\né‚£ä¹ˆç°åœ¨è¿›è¡Œå¯åŠ¨äº†ï¼Œå°±è¯¥çœ‹çœ‹é˜²ç«å¢™äº†ã€‚\n// å…ˆå¼€å¯ç³»ç»Ÿé˜²ç«å¢™systemctl start firewalld// å†å¼€æ”¾8080ç«¯å£å·firewall-cmd --zone=public --add-port=8080/tcp --permanent// é‡æ–°åŠ è½½é˜²ç«å¢™firewall-cmd --reload\n\n\n\nåœæ­¢Tomcatï¼Œä¸¤ç§æ–¹å¼:\nï¼ˆ1ï¼‰tomcatè„šæœ¬\n// tomcatä¸­çš„binç›®å½•ä¸‹ï¼šsh shutdown.sh\n\n\n\nï¼ˆ2ï¼‰ç»“æŸtomcatè¿›ç¨‹\nps -ef|grep tomcatkill -9 tomcatè¿›ç¨‹å·\n\n\n\n\n\nä¸‰. å®‰è£…é…ç½®MySQL\n\n\ncentosæˆ–è€…RHELç³»ç»Ÿè‡ªå¸¦mariadbæ•°æ®åº“ï¼Œè¿™ä¸ªæ•°æ®åº“å’ŒMySQLæ•°æ®åº“æ˜¯å†²çªçš„ï¼Œæ‰€ä»¥è¦æƒ³ä¿è¯MySQLæˆåŠŸå®‰è£…ï¼Œéœ€è¦å¸è½½mariadbæ•°æ®åº“ã€‚\n// æŸ¥çœ‹æŒ‡å®šè½¯ä»¶æ˜¯å¦å­˜åœ¨rpm -qa | grep mariadbæŸ¥è¯¢å½“å‰ç³»ç»Ÿä¸­å®‰è£…çš„åç§°å¸¦mariadbçš„è½¯ä»¶rpm -qa | grep mysqlæŸ¥è¯¢å½“å‰ç³»ç»Ÿä¸­å®‰è£…çš„åç§°å¸¦mysqlçš„è½¯ä»¶// å¸è½½è½¯ä»¶// è¯­æ³•: rpm -e --nodeps è½¯ä»¶åç§°rpm -e --nodeps mariadb-libs-5.5.60-1.el7_5.x86_64\n\n\n\nä¸Šä¼ å¹¶è§£å‹, éœ€è¦è‡ªå·±åˆ›å»ºmysqlçˆ¶ç›®å½•\n\n\næŒ‰ç…§é¡ºåºå®‰è£…rpmå®‰è£…åŒ…\nrpm -ivh mysql-community-common-5.7.25-1.el7.x86_64.rpmrpm -ivh mysql-community-libs-5.7.25-1.el7.x86_64.rpmrpm -ivh mysql-community-devel-5.7.25-1.el7.x86_64.rpmrpm -ivh mysql-community-libs-compat-5.7.25-1.el7.x86_64.rpmrpm -ivh mysql-community-client-5.7.25-1.el7.x86_64.rpmyum install net-toolsrpm -ivh mysql-community-server-5.7.25-1.el7.x86_64.rpm\n\n\n\nå¯åŠ¨mysql\nsystemctl status mysqld // æŸ¥çœ‹mysqlæœåŠ¡çŠ¶æ€systemctl start mysqld // å¯åŠ¨mysqlæœåŠ¡systemctl stop mysqld // åœæ­¢mysqlæœåŠ¡systemctl enable mysqld // å¼€æœºè‡ªå¯\n\n\n\næŸ¥çœ‹\nnetstat -tunlp | grep mysql // æŸ¥çœ‹mysqlçš„æœåŠ¡ä¿¡æ¯ps â€“ef | grep mysql // æŸ¥çœ‹mysqlè¿›ç¨‹\n\n\n\nç™»å½•\nåˆæ¬¡ç™»å½•æŸ¥çœ‹é»˜è®¤ç”Ÿæˆçš„å¯†ç ï¼š\ncat /var/log/mysqld.log | grep password\n\nç™»å½•å¹¶ä¿®æ”¹å¯†ç ï¼š\nmysql -uroot -pset global validate_password_length=4; //è®¾ç½®å¯†ç é•¿åº¦æœ€ä½ä½æ•°set global validate_password_policy=LOW; //è®¾ç½®å¯†ç å®‰å…¨ç­‰çº§ä½ï¼Œä¾¿äºå¯†ç å¯ä»¥ä¿®æ”¹æˆrootset password = password(&#x27;root&#x27;); // è®¾ç½®å¯†ç ä¸ºroot// å¼€å¯è®¿é—®æƒé™grant all on *.* to &#x27;root&#x27;@&#x27;%&#x27; identified by &#x27;root&#x27;;flush privileges;\n\n\n\nè¿œç¨‹ç™»å½•: å·¥å…·ï¼šNavicat\n// é˜²ç«å¢™å¼€å¯3306ç«¯å£firewall-cmd --zone=public --add-port=3306/tcp --permanentfirewall-cmd --reload\n\n\n\n\n\nå››. å®‰è£…é…ç½®Redis\n\n\nå®‰è£…redisï¼š\n\n\nä¸‹è½½åœ°å€ï¼šhttps://download.redis.io/releases/redis-6.2.6.tar.gz ç¨³å®šç‰ˆï¼Œ ä¸Šä¼ å®‰è£…æ–‡ä»¶\n\n\nè§£å‹ï¼Œç”¨gccç¼–è¯‘\nè§£å‹ï¼štar -zxvf redis-6.2.6.tar.gz -C /opt/ç¼–è¯‘ï¼šcd /opt/redis-6.2.6/make install   // è‡ªåŠ¨å®‰è£…åˆ° /usr/local/binä¸‹å®‰è£…çš„æ–‡ä»¶æè¿°ï¼šredis-benchmarkï¼šæ€§èƒ½æµ‹è¯•å·¥å…·redis-check-aofï¼šä¿®å¤aofæŒä¹…åŒ–æ–‡ä»¶redis-check-rdbï¼šä¿®å¤rdbæŒä¹…åŒ–æ–‡ä»¶redis-cliï¼šrediså‘½ä»¤è¡Œå·¥å…·redis-sentinelï¼šredisé›†ç¾¤å“¨å…µä½¿ç”¨redis-serverï¼šå¯åŠ¨redis\n\n\n\nåå°å¯åŠ¨ï¼š\ncd /opt/redis-6.2.6cp redis.conf  redis_1.confvim redis_1.confå°†daemonizeçš„noæ”¹æˆyesï¼ˆæŸ¥æ‰¾å†…å®¹ï¼š/+å†…å®¹ enter nï¼‰redis-server redis_1.conf\n\n\n\nå¯åŠ¨å‘½ä»¤è¡Œå’Œé€€å‡ºredis\nå‘½ä»¤è¡Œå¯åŠ¨ï¼šredis-clié€€å‡ºredis:(1) å…ˆshutdown,å†æ‰§è¡Œexit(2) å…ˆexit,å†æ€æ­»redisè¿›ç¨‹id\n\n\n\n\n\näº”. å®‰è£…lrzsz\n\nå¾ˆå¤šçš„è¿œç¨‹è¿æ¥å·¥å…·å¹¶æ²¡æœ‰ä¸Šä¼ ä¸‹è½½çš„åŠŸèƒ½ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ä¾èµ–äºlrzszè¿™ä¸ªè½¯ä»¶äº†ã€‚\n\n\n\næ‰€æœ‰lrzszå®‰è£…åŒ…\nyum list lrzsz\n\n\n\nåœ¨çº¿å®‰è£…lrzszï¼š\nyum install lrzsz.x86_64\n\n\n\nè¾“å…¥rzï¼Œå¼¹å‡ºä¸Šä¼ çš„çª—å£ï¼Œé€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶\n \n\n\n\nå…­. é¡¹ç›®éƒ¨ç½²\n\nï¼ˆ1ï¼‰æ‰‹åŠ¨éƒ¨ç½²é¡¹ç›®ï¼š\n\n\n\næ‰“åŒ…ï¼Œåˆ©ç”¨lrzszçš„rzå‘½ä»¤ä¸Šä¼ ï¼Œè¿è¡Œå‘½ä»¤ï¼š java -jar åŒ…å \n\n\né‚£æˆ‘ä»¬å…³é—­å‘½ä»¤è¡Œï¼Œè¿™ä¸ªæ—¶å€™ä¸ç‚¸äº†å—ï¼ŸğŸƒï¼Œæˆ‘ä»¬å¯ä»¥åå°è¿è¡Œé¡¹ç›®ï¼Œå°†æ—¥å¿—è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶ï¼š\nnohup java -jar helloworld-1.0-SNAPSHOT.jar &amp;&gt; hello.log &amp;// nohup: ä¸æŒ‚èµ·// &amp;: è®©å‘½ä»¤åœ¨åå°è¿è¡Œ\n\n\n\nåœæ­¢é¡¹ç›®ï¼š\nps -ef|grep javakill -9 è¿›ç¨‹å·\n\n\n\n\n\n\n\nï¼ˆ2ï¼‰åŸºäºshellè„šæœ¬è‡ªåŠ¨éƒ¨ç½²\n\n\n\nå°†ideaä¸­çš„é¡¹ç›®ä»£ç æ¨é€åˆ°è¿œç¨‹\n\n\nä¸‹è½½git, å…‹éš†è¿œç¨‹ä»£ç ï¼š\nyum list git // åˆ—å‡ºgitå®‰è£…åŒ…yum install git // åœ¨çº¿å®‰è£…gitgit --version  // gitå®‰è£…éªŒè¯git clone https://gitee.com/youre-not-as-handsome-as-me/demo.git\n\n\n\nä¸Šä¼ è§£å‹mavenå®‰è£…åŒ…åˆ° &#x2F;usr&#x2F;local&#x2F;, åœ¨&#x2F;etc&#x2F;profileæ–‡ä»¶ä¸­é…ç½®ç¯å¢ƒå˜é‡ï¼š\nvim /etc/profileä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œè¿›å…¥åˆ°å‘½ä»¤æ¨¡å¼ï¼ŒæŒ‰Gåˆ‡æ¢åˆ°æœ€åä¸€è¡Œï¼ŒæŒ‰a/i/oè¿›å…¥æ’å…¥æ¨¡å¼ï¼Œç„¶ååœ¨æœ€ååŠ å…¥å¦‚ä¸‹å†…å®¹ :export MAVEN_HOME=/usr/local/apache-maven-3.5.4export PATH=$JAVA_HOME/bin:$MAVEN_HOME/bin:$PATHé‡æ–°åŠ è½½å¹¶éªŒè¯source /etc/profilemvn -v\n\n\n\nåœ¨settings.xmlé…ç½®æ–‡ä»¶è®¾ç½®æœ¬åœ°ä»“åº“å’Œç§æœï¼š\nvim /usr/local/apache-maven-3.5.4/conf/settings.xml&lt;localRepository&gt;/usr/local/repo&lt;/localRepository&gt;é˜¿é‡Œç§æœï¼š&lt;mirror&gt;\t&lt;id&gt;alimaven&lt;/id&gt;    &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;    &lt;name&gt;aliyun maven&lt;/name&gt;    &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt;&lt;/mirror&gt;\n\n\n\nç¼–å†™shellè„šæœ¬bootStart.shæ‰§è¡Œéƒ¨ç½²æµç¨‹ï¼š\n#!/bin/shecho =================================echo  è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬å¯åŠ¨echo =================================echo åœæ­¢åŸæ¥è¿è¡Œä¸­çš„å·¥ç¨‹APP_NAME=demotpid=`ps -ef|grep $APP_NAME|grep -v grep|grep -v kill|awk &#x27;&#123;print $2&#125;&#x27;`if [ $&#123;tpid&#125; ]; then    echo &#x27;Stop Process...&#x27;    kill -15 $tpidfisleep 2tpid=`ps -ef|grep $APP_NAME|grep -v grep|grep -v kill|awk &#x27;&#123;print $2&#125;&#x27;`if [ $&#123;tpid&#125; ]; then    echo &#x27;Kill Process!&#x27;    kill -9 $tpidelse    echo &#x27;Stop Success!&#x27;fiecho å‡†å¤‡ä»Gitä»“åº“æ‹‰å–æœ€æ–°ä»£ç cd /usr/local/demoecho å¼€å§‹ä»Gitä»“åº“æ‹‰å–æœ€æ–°ä»£ç git pullecho ä»£ç æ‹‰å–å®Œæˆecho å¼€å§‹æ‰“åŒ…output=`mvn clean package -Dmaven.test.skip=true`cd targetecho å¯åŠ¨é¡¹ç›®nohup java -jar demo-0.0.1-SNAPSHOT.jar &amp;&gt; demo.log &amp;echo é¡¹ç›®å¯åŠ¨å®Œæˆ\n\n\n\nèµ‹äºˆbootStart.shæƒé™, æ‰§è¡Œè„šæœ¬\nchmod 777 bootStart.shsh bootStart.sh\n\n","categories":["Linux"],"tags":["Linux"]},{"title":"SpringCloud-Alibabaç³»åˆ—ä¹‹Nacos","url":"/2025/05/05/SpringCloud-Alibaba%E7%B3%BB%E5%88%97%E4%B9%8BNacos/","content":"ä»‹ç»ï¼šNacosæ˜¯SpringCloud Alibabaçš„äº”å¤§ç»„ä»¶ä¹‹ä¸€ï¼Œæ˜¯ä¸€ä¸ªæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œä¸»è¦åŠŸèƒ½ä¸ºç®¡ç†æ³¨å†Œçš„æœåŠ¡ï¼Œé…ç½®æœåŠ¡ï¼Œä¸ºæœåŠ¡ä¹‹é—´çš„è®¿é—®æä¾›DNSè§£æï¼Œå¯ä»¥è®¾ç½®è´Ÿè½½å‡è¡¡ã€‚\n\n\n\n\nä¸€. æ³¨å†ŒæœåŠ¡åŠæœåŠ¡ä¹‹é—´çš„è®¿é—®\n\nï¼ˆ1ï¼‰æœåŠ¡æ˜¯å¦‚ä½•æ³¨å†Œåˆ°Nacosä»è€Œè¢«Nacosç®¡ç†çš„å‘¢ï¼Ÿ\n\nå¾ˆç®€å•ï¼Œå°±æ˜¯å¯¼å…¥ä¸€ä¸ªå‘ç°Nacosçš„ä¾èµ–åŒ…ï¼ˆnacos clientä¾èµ–ï¼‰ï¼Œå†é€šè¿‡application.ymlé…ç½®æ–‡ä»¶è¿›è¡Œæ³¨å†Œï¼š\n&lt;dependency&gt;    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;    &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;&lt;/dependency&gt;\n\napplication.yml:\nserver:  port: 9002spring:  application:    name: consumer-service-nacos  # æ³¨å†Œåˆ°Nacosçš„æœåŠ¡åç§°  cloud:    nacos:      discovery:        server-addr: localhost:8848 # Nacosåœ¨æœ¬åœ°å¯åŠ¨çš„é»˜è®¤ç«¯å£        username: nacos  # ç™»å½•Nacosçš„ç”¨æˆ·åå’Œå¯†ç ï¼Œç”¨äºè®¿é—®éªŒè¯        password: nacos        namespace: 0ffbe532-ae84-4010-ade3-591db18d33e1 # å‘½åç©ºé—´çš„id        group: dev # ç»„\n\n\n\n\n\nï¼ˆ2ï¼‰æ³¨å†Œåˆ°Nacosçš„æœåŠ¡è¦å¦‚ä½•è®¿é—®Nacosçš„å…¶ä»–æœåŠ¡å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å°±è¦ç”¨åˆ°RestTemplateå¯¹è±¡äº†ï¼Œæˆ‘ä»¬è¿›è¡Œä¸€ä¸ªè‡ªåŠ¨é…ç½®ï¼š\n@Configurationpublic class ConfigBean &#123;    @Bean    public RestTemplate restTemplate() &#123;        return new RestTemplate();    &#125;&#125;\n\nä½¿ç”¨restTemplateçš„ä¸åŒæ–¹æ³•è®¿é—®å…¶ä»–æœåŠ¡ï¼Œè®¿é—®çš„åœ°å€ä¸º\nhttp://æœåŠ¡å\n\n\n\nè¿™ä¸ªæ—¶å€™æœ‰ä¸€ä¸ªé—®é¢˜äº†ï¼Œå¦‚æœè¦è®¿é—®çš„è¿™ä¸ªæœåŠ¡åä¸‹æœ‰å¤šä¸ªä¸åŒçš„æœåŠ¡ï¼ˆç«¯å£ä¸åŒï¼‰ï¼Œè¯¥è®¿é—®æ‹¿ä¸€ä¸ªå‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å°±è¦ç”¨åˆ°è´Ÿè½½å‡è¡¡äº†ï¼Œåªéœ€åœ¨RestTemplateç”Ÿæˆbeançš„æ–¹æ³•åŠ ä¸Š LoadBalanced æ³¨è§£\n@Configurationpublic class ConfigBean &#123;    @Bean    @LoadBalanced    public RestTemplate restTemplate() &#123;        return new RestTemplate();    &#125;&#125;\n\n\n\n\n\nï¼ˆ3ï¼‰æ³¨å†ŒæœåŠ¡æ—¶æœ‰é‚£äº›ç»†èŠ‚éœ€è¦æ³¨æ„å‘¢ï¼Ÿ\næ³¨å†Œçš„æ˜¯ä¸´æ—¶å®ä¾‹è¿˜æ˜¯æ°¸ä¹…å®ä¾‹ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\nspring:  cloud:    nacos:      discovery:        ephemeral: false # falseä¸ºæ°¸ä¹…å®ä¾‹ï¼Œtrueä¸ºä¸´æ—¶å®ä¾‹ï¼Œé»˜è®¤ä¸ºä¸´æ—¶å®ä¾‹\n\n\n\nåŒºåˆ«ï¼š\nä¸´æ—¶å®ä¾‹å’Œæ°¸ä¹…å®ä¾‹çš„åŒºåˆ«åœ¨äºèƒ½å¦è¢«åˆ é™¤ï¼Œä¸´æ—¶å®ä¾‹ä¾é å¿ƒè·³æœºåˆ¶å­˜æ´»ï¼Œé»˜è®¤é—´éš”ä¸º5ç§’ï¼Œ15ç§’æœªåº”ç­”å°±æ˜¯ä¸å¥åº·çŠ¶æ€ï¼Œ30ç§’æœªåº”ç­”å°±åˆ é™¤ã€‚æ°¸ä¹…å®ä¾‹åˆ™ä¸ä¼šåˆ é™¤ï¼Œå®ä¾‹ä¸å­˜åœ¨æ—¶å°±æ ‡è®°ä¸ºä¸å¥åº·çŠ¶æ€ã€‚\nä¸´æ—¶å®ä¾‹çš„æ¨¡å¼ä¸ºAP(å¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§)ï¼Œ åŸºäºdiscroåè®®ï¼Œåªè¿”å›å¯ä»¥ä½¿ç”¨çš„æ•°æ®ï¼Œä¸ä¸€å®šæ˜¯æœ€æ–°æ•°æ®ï¼Œå¼ºè°ƒçš„æ˜¯æ•°æ®çš„å¯ç”¨æ€§ã€‚è€Œæ°¸ä¹…å®ä¾‹çš„æ¨¡å¼ä¸ºCP(ä¸€è‡´æ€§å’Œåˆ†åŒºå®¹é”™æ€§)ï¼ŒåŸºäºraftåè®®å®ç°ï¼Œè¿”å›æœ€æ–°çš„æ•°æ®æˆ–è€…é”™è¯¯ï¼Œå¼ºè°ƒçš„æ˜¯æ•°æ®æ­£ç¡®ã€‚\n\n\né›†ç¾¤\n\nå¦‚ä½•è®¾ç½®è´Ÿè½½å‡è¡¡è®¿é—®çš„æƒé‡ï¼Ÿä¿æŠ¤é˜ˆå€¼æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•è®¾ç½®ï¼Ÿ\n\n\nå‡å¦‚åœ¨nacosæœåŠ¡ç«¯ä¸­ä¸€ä¸ªæœåŠ¡åä¸‹æœ‰å¤šä¸ªç«¯å£ï¼Œå¯ä»¥è®¾ç½®ä¸åŒç«¯å£çš„æƒé‡ï¼Œé‚£åœ¨æ¶ˆè´¹ç«¯ä¸­é…ç½®ï¼š\nspring:  cloud:Â    loadbalancer:Â  Â    nacos:Â  Â  Â    enabled: true\n\n\n\næ¥ä¸Šè¿°æ‰€è®²ï¼Œä¸€ä¸ªæœåŠ¡åä¸‹æœ‰å¤šä¸ªç«¯å£ï¼Œå¯ä»¥è®¾ç½®è¯¥æœåŠ¡çš„ä¿æŠ¤é˜ˆå€¼ï¼ˆ0-1çš„æµ®ç‚¹æ•°ï¼‰ï¼Œå¦‚æœå¥åº·çš„ç«¯å£æ•°æ‰€å æ¯”ä¾‹å°äºæˆ–ç­‰äºä¿æŠ¤é˜ˆå€¼ï¼Œé‚£ä¹ˆnacoså°†å…¨éƒ¨å®ä¾‹ï¼ˆåŒ…æ‹¬ä¸å¥åº·çš„å®ä¾‹ï¼‰è¿”å›ç»™è°ƒç”¨ç«¯ï¼Œé˜²æ­¢å‘ç”Ÿé›ªå´©æ•ˆåº”ã€‚\n\n\n\n\näºŒ. Nacosé›†ç¾¤\n\nNacosé›†ç¾¤ä¸­NacosèŠ‚ç‚¹çš„æ•°é‡å¤§äºæˆ–ç­‰äº3ï¼Œå•ä¸ªNacosä½¿ç”¨å†…åµŒæ•°æ®åº“derbyï¼ŒNacosé›†ç¾¤ä½¿ç”¨MySQLï¼ˆé›†ä¸­å¼å¤„ç†ï¼‰ã€‚\n\n\nNacosé›†ç¾¤å¦‚ä½•é…ç½®å’Œå¯åŠ¨ï¼Ÿ\nåœ¨mysqlåˆ›å»ºæ•°æ®åº“ï¼Œè¿è¡ŒNacosçš„æ•°æ®è¡¨sqlè¯­å¥ï¼šnacosç›®å½•ä¸‹&gt;conf&gt;mysql-schema.sqlï¼Œè¿™ä¸ªæ—¶å€™é›†ç¾¤çš„æ•°æ®åº“å°±å·²ç»æ­å»ºå¥½äº†ï¼Œå¦‚æœæœ‰æœåŠ¡è¦è¿æ¥è¯¥é›†ç¾¤ï¼Œå¿…é¡»é…ç½®è¿æ¥è¯¥MySQLæ•°æ®åº“:\nspring:  datasource:    url: jdbc:mysql://localhost:3306/testcloud    username: root    password: 123456    driver-class-name: com.mysql.cj.jdbc.Driver\n\nåˆ°nacosçš„å„ä¸ªèŠ‚ç‚¹çš„application.propertiesé…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹MySQLçš„æ•°é‡å’Œåº“åï¼Œæ•°æ®åº“éƒ¨åˆ†ä»‹ç»å®Œäº†ï¼Œè¯¥åˆ°é›†ç¾¤é…ç½®å¯åŠ¨éƒ¨åˆ†äº†ï¼Œåˆ°nacosçš„å„ä¸ªèŠ‚ç‚¹çš„cluster.confä¸‹ï¼Œæ·»åŠ é›†ç¾¤ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„ipå’Œç«¯å£å·ï¼Œæœ€åä½¿ç”¨startupå‘½ä»¤å¯åŠ¨å„ä¸ªèŠ‚ç‚¹æ—¢å¯ã€‚\n\n\næœ‰ä¸€ä¸ªç‚¹éœ€è¦æ³¨æ„ï¼Œåœ¨nacos2.xä»¥åï¼Œé™¤äº†å¯åŠ¨çš„Httpç«¯å£å¤–ï¼Œè¿˜æœ‰gRPCçš„é€šä¿¡æ–¹å¼ï¼Œæ˜¯åœ¨Httpç«¯å£åŸºç¡€ä¸ŠåŠ ä¸Šåç§»é‡ï¼Œæ‰€ä»¥åŒä¸€å°æœåŠ¡å™¨ä¸Šæ¨¡æ‹ŸNacosé›†ç¾¤æ—¶ï¼Œå„ä¸ªèŠ‚ç‚¹çš„Httpç«¯å£ä¸è¦ç›¸é‚»ã€‚\n\n\n\n\nä¸‰. Nacosé…ç½®ä¸­å¿ƒ\n\nè®¾ç«‹é…ç½®ä¸­å¿ƒï¼Œæ–¹ä¾¿ç®¡ç†å„ä¸ªæœåŠ¡çš„é…ç½®ï¼Œè¿™ä¸ªæ—¶å€™æœåŠ¡åªéœ€è¦è¿æ¥åˆ°é…ç½®ä¸­å¿ƒä¸­æŒ‡å®šçš„é…ç½®æ–‡ä»¶æ—¢å¯è·å–å®ƒè‡ªå·±çš„é…ç½®ï¼Œæ¥è¿›è¡Œå¯åŠ¨ã€‚\n\n\n\nåœ¨é…ç½®ä¸­å¿ƒåˆ›å»ºé…ç½®æ–‡ä»¶ï¼Œå„ä¸ªæœåŠ¡æ˜¯å¦‚ä½•ä»é…ç½®ä¸­å¿ƒé‡Œè·å–åˆ°å®ƒä»¬çš„é…ç½®æ–‡ä»¶çš„ï¼Ÿ\n\n\nåˆ›å»ºä¸€ä¸ªå‘½åç©ºé—´ï¼Œæˆ–è€…é€‰ä¸­å‘½åç©ºé—´ï¼Œåˆ›å»ºé…ç½®æ–‡ä»¶è¿‡ç¨‹ä¸­è®¾ç½®ç»„\n\n\nå„ä¸ªæœåŠ¡å¯¼å…¥nacos-configä¾èµ–åŒ…ï¼š\n&lt;dependency&gt;    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;    &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt;&lt;/dependency&gt;\n\né…ç½®æ–‡ä»¶ï¼š\nspring:  application:    name: consumer-service-nacos-config  cloud:    nacos:      config:        server-addr: localhost:8848        username: nacos        password: nacos        file-extension: yml        # namespace:        # group:   config:    import: optional:nacos:$&#123;spring.application.name&#125;.$&#123;spring.cloud.nacos.config.file-extension&#125;    # å¤šä¸ªé…ç½®æ–‡ä»¶çš„è¯»å–æ—¶ï¼Œåè€…ä¼šè¦†ç›–å‰è€…\n\n\n\n\n\né…ç½®ä¸­å¿ƒå’Œå®¢æˆ·ç«¯çš„æ•°æ®æ˜¯å¦‚ä½•åŒæ­¥çš„ï¼Ÿ\n\n\né€šè¿‡é•¿è½®è¯¢çš„pullæ¨¡å¼ï¼Œå³å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€è·å–é…ç½®çš„è¯·æ±‚ï¼ŒæœåŠ¡ç«¯ä¸ä¼šç«‹å³å“åº”è€Œæ˜¯å°†è¯·æ±‚æŒ‚èµ·ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œå¦‚æœè¿™æ®µæ—¶é—´å†…ï¼Œé…ç½®æ–‡ä»¶å‘ç”Ÿå˜åŒ–ï¼Œå°±ç«‹å³å“åº”è¯·æ±‚ï¼Œå¦åˆ™ï¼Œå°±ç­‰è¶…æ—¶ä¹‹åå“åº”è¯·æ±‚ã€‚å½“å®¢æˆ·ç«¯æ¥å—åˆ°å“åº”è¯·æ±‚åå°±å†æ¬¡å‘é€é•¿è½®è¯¢è¯·æ±‚ï¼Œå¦‚æ­¤ä¸€ç›´è¿›è¡Œæ¥ä¿è¯é…ç½®æ–‡ä»¶çš„æ•°æ®åŒæ­¥ã€‚\n\n\n","categories":["javaæ¡†æ¶","SpringCloud-Alibaba"],"tags":["SpringCloud-Alibaba","Nacos"]},{"title":"ç™¾æ—¥ç­‘åŸºä¹‹ç¬¬ä¸€é˜¶æ®µ","url":"/2025/05/05/%E7%99%BE%E6%97%A5%E7%AD%91%E5%9F%BA%E4%B9%8B%E7%AC%AC%E4%B8%80%E9%98%B6%E6%AE%B5/","content":"ç™¾æ—¥ç­‘åŸºè‡ª2025.4.25å‘èµ·ï¼Œä»Šå¤©æ˜¯2025.5.5ï¼Œå·²ç»è¿‡äº†10å¤©ï¼Œå®Œæˆè¿›åº¦1&#x2F;10ï¼Œè®²è®²æ„Ÿå—å§ï¼Œå°±æ˜¯æŒºå¥½çš„ï¼Œä½“åŠ›ç²¾åŠ›æ˜æ˜¾åœ°æ„Ÿè§‰æœ‰æå‡ã€‚ä½“åŠ›æ–¹é¢ä¸€å£æ°”ä»¥å¯»å¸¸é€Ÿåº¦çˆ¬ä¸‰æ¥¼å‘¼å¸æ­£å¸¸ï¼Œä¸å–˜æ°”ï¼Œçˆ¬äº”æ¥¼ç¨å¾®å–˜æ°”ï¼Œå¹³å¸¸å¿«èµ°æ— å‹åŠ›ï¼ŒæŒºèƒ¸ç›´èƒŒæ¯”ä¹‹å‰è½»æ¾ã€‚ç²¾åŠ›çš„è¯å°±æœ€è¿‘ï¼Œåˆ°äº†9,10å¤©çš„æ ·å­å§ï¼Œå­¦ä¹ æ—¶æ¯”åŸå…ˆçš„ç²¾åŠ›æ›´å……æ²›äº†ï¼Œå¿ƒæ€æ…¢æ…¢å›æ­£äº†ï¼Œæœ‰ä¸€ä¸ªç‰¹åˆ«çš„æ„Ÿå—ï¼Œå°±æ˜¯æ¯å¤©éƒ½ä¼šå¯¹æ˜å¤©æœ‰æœŸç›¼ï¼ŒæœŸå¾…è‡ªå·±çš„ç™¾æ—¥ç­‘åŸºè¿›åº¦åˆå‘å‰æ¨è¿›äº†ï¼Œè‡ªå·±çš„ä½“åŠ›å’Œç²¾åŠ›ä¸€å¤©æ¯”ä¸€å¤©æ›´å¼ºå¤§ï¼Œè¿™ç§æ„Ÿè§‰å¾ˆæ£’ï¼Œå¥½æäº†ï¼Œå“ˆå“ˆï¼Œè¿™å°±æ˜¯ç™¾æ—¥ç­‘åŸºç¬¬ä¸€é˜¶æ®µçš„æ€»ç»“äº†ï¼Œç»§ç»­åŠ æ²¹ï¼\n","categories":["ç™¾æ—¥ç­‘åŸº"]},{"title":"é¢è¯•ç³»åˆ—ä¹‹Mybatis","url":"/2025/05/08/%E9%9D%A2%E8%AF%95%E7%B3%BB%E5%88%97%E4%B9%8BMybatis/","content":"ä¸€. åŸºæœ¬å®ç°ç°åœ¨æˆ‘ä»¬çš„Springboot + Mybatisæ˜¯å¦‚ä½•é…ç½®çš„å‘¢ï¼Ÿ\n\n\npom.xmlæ–‡ä»¶ï¼š\n&lt;dependency&gt;    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt;    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;    &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;    &lt;scope&gt;test&lt;/scope&gt;&lt;/dependency&gt;&lt;dependency&gt;    &lt;groupId&gt;com.mysql&lt;/groupId&gt;    &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;    &lt;scope&gt;runtime&lt;/scope&gt;&lt;/dependency&gt;&lt;dependency&gt;    &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;    &lt;artifactId&gt;lombok&lt;/artifactId&gt;    &lt;optional&gt;true&lt;/optional&gt;&lt;/dependency&gt;&lt;dependency&gt;    &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;    &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;    &lt;version&gt;3.0.4&lt;/version&gt;&lt;/dependency&gt;\n\n\n\nå®ç° mapper, service, controller ä¸‰å±‚ç»“æ„ï¼Œæ³¨æ„ mapper.xml æ–‡ä»¶è¦å®šä¹‰åœ¨ src&#x2F;main&#x2F;resources&#x2F;mapperä¸‹ï¼Œå°±è¦åœ¨ application.yml é…ç½® mapper.xml æ–‡ä»¶è·¯å¾„ï¼Œå®Œæ•´çš„ application.yml æ–‡ä»¶å¦‚ä¸‹ï¼š\nserver:  port: 8080spring:  application:    name: mybatistest  # è¿æ¥æ±   datasource:    url: jdbc:mysql://localhost:3306/mybatistest?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false    username: root    password: 123456  # mybatisæ—¥å¿—æ‰“å°åˆ°æ§åˆ¶å°mybatis:  configuration:    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl  # æŒ‡å®šmapper.xmlæ–‡ä»¶çš„è·¯å¾„  mapper-locations: classpath:mapper/*.xml\n\n\n\nè¿™ä¸ªæ—¶å€™å°±å¯ä»¥äº†ğŸ˜\n\n\n\n\näºŒ. å…·ä½“åŸç†é‚£ä¹ˆä¸€æ¡sqlè¯­å¥åœ¨Mybatisä¸­æ˜¯å¦‚ä½•æ‰§è¡Œçš„å‘¢ï¼Ÿä»ä¸Šé¢çœ‹ï¼Œæ˜¯ mapper.xml å’Œ mapper æ¥å£ç›¸å…³è”ï¼Œç„¶åè°ƒç”¨mapperæ¥å£ï¼Œæˆ‘ä»¬åªéœ€è¦å…³æ³¨mapperçš„å…³è”å’Œsqlè¯­å¥çš„ç¼–å†™å°±è¡Œã€‚\n\n\nã€è¯´è¯´Mybatisçš„å…·ä½“æ‰§è¡Œæµç¨‹ã€‘\n\n\n\n\næˆ‘å°±æ€»ç»“ä¸€ä¸‹å§ï¼šé¦–å…ˆè¯»å–mybatisçš„xmlé…ç½®ï¼ˆåŒ…å«äº†å¯¹mapper.xmlæ–‡ä»¶çš„æ˜ å°„ï¼‰ï¼Œè®²è¿™äº›é…ç½®è½¬åŒ–ä¸ºæµï¼Œä½œä¸ºsqlSessionFactoryBuilderçš„buildæ–¹æ³•çš„å‚æ•°å»ç”Ÿæˆäº†sqlSessionFactoryï¼Œç„¶åsqlSessionFactoryåˆ›å»ºsqlSessionï¼ŒsqlSessionå»è°ƒç”¨Executoræ‰§è¡Œå™¨å»æ‰§è¡Œsqlè¯­å¥ã€‚åœ¨æ‰§è¡Œå‰å°†éœ€è¦æ˜ å°„çš„å‚æ•°ä¿¡æ¯ä¿å­˜åˆ°MapperStatementå¯¹è±¡ä¸­ï¼Œæ‰§è¡Œçš„è¿‡ç¨‹æ˜¯æ‰§è¡Œå™¨è°ƒç”¨StatementHandleré¢„ç¼–è¯‘ï¼Œå†è°ƒç”¨ParameterHandlerè®¾ç½®ç¼–è¯‘å‚æ•°ï¼Œæœ€åç”¨TypeHandlerå°†javaBeanç±»å‹å’Œæ•°æ®åº“ç±»å‹è¿›è¡Œæ˜ å°„å¤„ç†ï¼Œè°ƒç”¨åŸç”Ÿçš„JDBCçš„APIæ‰§è¡Œsqlè¯­å¥ã€‚å¦‚æœè¿”å›ç»“æœï¼ŒTypeHandlerå°†æ•°æ®åº“ç±»å‹æ˜ å°„åˆ°javaBeanç±»å‹ï¼Œè¿™ä¸ªæ—¶å€™å¯èƒ½å‡ºç°æŸ¥è¯¢å­—æ®µå’Œå¯¹è±¡å±æ€§ä¸ä¸€è‡´çš„æƒ…å†µï¼Œå°±å¯ä»¥ç”¨resultMapè¿›è¡Œæ‰‹åŠ¨æ˜ å°„ï¼Œå¦‚æœæƒ³è¦å°†æ•°æ®åº“çš„æŸä¸ªç±»å‹å›ºå®šåœ°è½¬åŒ–ä¸ºjavaçš„æŸä¸ªç±»å‹ï¼Œå°±å¯ä»¥è‡ªå·±è‡ªå®šä¹‰TypeHandler, æœ€åå°±é€šè¿‡ResultSetHandleræ¥å¤„ç†æŸ¥è¯¢ç»“æœã€‚\n\n\næˆ‘è®¤ä¸ºäº†è§£mybatisæ‰§è¡Œæµç¨‹å¯¹äºæ—¥å¸¸çš„å®é™…ä½¿ç”¨ä½œç”¨æœ€å¤§çš„è¿˜æ˜¯TypeHanlderç±»å‹æ˜ å°„åªä¸€å—ï¼Œå®ç°æ•°æ®åº“ç±»å‹å’Œjavaç±»å‹çš„æ˜ å°„ï¼Œå¹³å¸¸æŠ¥é”™æœ€å¤šçš„ä¹Ÿæ˜¯è¿™ä¸€å—ã€‚\n\n\n\n\nä¸‰. å»¶è¿ŸåŠ è½½å’Œç¼“å­˜\n\nã€è¯´è¯´Mybatiså»¶è¿ŸåŠ è½½çš„åŸç†ã€‘\nMybatiså»¶è¿ŸåŠ è½½å°±æ˜¯å¦‚æœæŸ¥è¯¢çš„ä¸»å¯¹è±¡ä¸­åŒ…å«äº†ä¸€äº›å…³è”å¯¹è±¡ï¼Œé‚£ä¹ˆè¿™äº›å…³è”å¯¹è±¡ä¸ä¼šç«‹åˆ»åŠ è½½ï¼Œåªæœ‰ä½¿ç”¨æ—¶æ‰ä¼šè¢«åŠ è½½ï¼Œè¿™æ ·å°±é¿å…æŸ¥è¯¢ä¸å¿…è¦çš„æ•°æ®ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½ã€‚\nå…·ä½“çš„åŸç†å°±æ˜¯æŸ¥è¯¢ä¸»å¯¹è±¡æ—¶ï¼ŒMybatiså°±ä¼šåˆ©ç”¨CGLIBåŠ¨æ€ä»£ç†ç”Ÿæˆä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œä»£ç†çš„ç›®æ ‡å¯¹è±¡å°±æ˜¯å¼€å¯äº†å»¶è¿ŸåŠ è½½çš„mapperï¼Œè°ƒç”¨ç›®æ ‡æ–¹æ³•æ—¶ï¼Œå°±ä¼šè¿›å…¥æ‹¦æˆªå™¨çš„invokeæ–¹æ³•ï¼Œå¦‚æœç›®æ ‡æ˜¯ç©ºå€¼ï¼Œå°±ä¼šç»§ç»­sqlæŸ¥è¯¢ï¼ŒæŸ¥è¯¢çš„ç»“æœå¡«å……åˆ°ä»£ç†å¯¹è±¡ä¸­ï¼Œå¦‚æœä¸‹æ¬¡æŸ¥è¯¢åˆ°ç›¸åŒçš„å…³è”å¯¹è±¡æ—¶ï¼Œå°±å¯ä»¥è·å–ã€‚\n\n\nå…·ä½“çš„é…ç½®å°±æ˜¯åœ¨ resultMap ç±»å‹æ˜ å°„ä¸€äº›å±æ€§æˆ–è€…å¯¹è±¡çš„æ—¶å€™ï¼Œå°† association æ ‡ç­¾çš„ fetchType å±æ€§è®¾ç½®ä¸º lazyã€‚\n\n\n\n\nã€è¯´è¯´Mybatisçš„ç¼“å­˜æœºåˆ¶ã€‘\nMybatisä¸»è¦æœ‰ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜ã€‚\nä¸€çº§ç¼“å­˜çš„èŒƒå›´æ˜¯sqlSessionï¼Œæ˜¯ç”±æ‰§è¡Œå™¨æ¥å®Œæˆçš„ï¼Œæ¯”å¦‚é»˜è®¤æ‰§è¡Œå™¨SimpleExecutorçš„çˆ¶ç±»BaseExecutorå°±åˆ›å»ºäº†PerpetualCacheç¼“å­˜å¯¹è±¡ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªHashMapå¯¹è±¡ã€‚å½“è¿›è¡Œå¢åˆ æ”¹æ•°æ®æˆ–è€…sqlSessionå…³é—­ä¹‹åï¼Œå°±ä¼šæ¸…ç©ºç¼“å­˜æ•°æ®ã€‚\näºŒçº§ç¼“å­˜çš„èŒƒå›´æ˜¯mapper.xmlçš„namespaceï¼Œä¸æ˜¯ä¾èµ–äºsqlSessionï¼Œé»˜è®¤ä¹Ÿæ˜¯é‡‡ç”¨PerpetualCacheç¼“å­˜å¯¹è±¡ï¼ŒHashMapå­˜å‚¨ã€‚å¦‚æœæƒ³è¦å¼€å¯äºŒçº§ç¼“å­˜çš„è¯ï¼Œéœ€è¦åœ¨å…¨å±€é…ç½®æ–‡ä»¶å’Œå…·ä½“çš„æ˜ å°„æ–‡ä»¶å¼€å¯é…ç½®æ‰è¡Œã€‚\n","categories":["javaé¢è¯•"],"tags":["Mybatis"]},{"title":"é¢è¯•ç³»åˆ—ä¹‹Spring","url":"/2025/05/09/%E9%9D%A2%E8%AF%95%E7%B3%BB%E5%88%97%E4%B9%8BSpring/","content":"å…ˆæŠŠSpirngç»“æ„æ”¾åœ¨è¿™é‡Œï¼Œæ–¹é¢åç»­çš„æ•´ä½“ç†è§£ğŸƒ\n\n\n\n\n\n\nçƒ­èº«ç¯èŠ‚æ¯æ¬¡éƒ½å¼€å§‹å°†çŸ¥è¯†ï¼Œæ„Ÿè§‰æœ‰ç‚¹æ¯ç‡¥ğŸ¤£ï¼ŒåŠ ä¸ªçƒ­èº«ç¯èŠ‚è¿‡æ¸¡è¿‡æ¸¡ğŸ˜ã€‚é¦–å…ˆæˆ‘ä»¬å…ˆè¿›å…¥çƒ­èº«ç¯èŠ‚ï¼Œå°±æ˜¯ä»¥ä¸€ä¸ªå­¦ç”Ÿçš„å¢åˆ æ”¹æŸ¥æ¡ˆä¾‹æ¥è®²è®²SSMæ¡†æ¶å§ğŸƒ\n\n\nSSMæ¡†æ¶æ˜¯ä¸ªå•¥ï¼Ÿå°±æ˜¯Springå®¹çº³Spring MVCï¼ˆåŸºäºServlet APIï¼‰å’Œ Mybatisè¿™ä¸¤ä¸ªå°å¼Ÿã€‚ç§åˆ°ä¸Šé¢çš„Springæ¡†æ¶ç»“æ„å›¾æ²¡æœ‰ï¼Ÿæ²¡é”™ï¼Œæˆ‘ä»¬çš„ Data Access å’Œ Webéƒ¨åˆ†å°±åˆ†åˆ«äº¤ç»™è¿™ä¸¤ä¸ªå°å¼Ÿäº†ï¼ŒMybatiså°å¼Ÿè°ƒç”¨åŸç”Ÿçš„JDBCï¼Œè¿˜å·®ä¸ªå•¥å‘¢ï¼Ÿå°±æ˜¯æ•°æ®åº“çš„è¿æ¥äº†ï¼šæ•°æ®åº“é©±åŠ¨å’Œè¿æ¥æ± ã€‚ SpringMVCå°å¼Ÿè¿˜å·®å•¥å‘¢ï¼Ÿæˆ‘ä»¬æƒ³æƒ³MVCæ˜¯ä¸æ˜¯modelï¼Œviewå’Œcontrollerï¼Œé‚£viewå’Œcontrollerä¸å°±è¦ JSP API å’ŒServlet APIå˜›ã€‚\n\n\nææ¸…æ¥šäº†SSMä»¥åŠéœ€è¦å•¥ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥çœ‹çœ‹ pom.xml æ–‡ä»¶äº†ï¼š\n&lt;dependencies&gt;    &lt;dependency&gt;      &lt;groupId&gt;junit&lt;/groupId&gt;      &lt;artifactId&gt;junit&lt;/artifactId&gt;      &lt;version&gt;4.13.1&lt;/version&gt;      &lt;scope&gt;test&lt;/scope&gt;    &lt;/dependency&gt;    &lt;!--mysqlé©±åŠ¨--&gt;    &lt;dependency&gt;      &lt;groupId&gt;mysql&lt;/groupId&gt;      &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;      &lt;version&gt;8.0.33&lt;/version&gt;    &lt;/dependency&gt;    &lt;!--dataSource--&gt;    &lt;dependency&gt;      &lt;groupId&gt;com.alibaba&lt;/groupId&gt;      &lt;artifactId&gt;druid&lt;/artifactId&gt;      &lt;version&gt;1.2.12&lt;/version&gt;    &lt;/dependency&gt;    &lt;!--lombok--&gt;    &lt;dependency&gt;      &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;      &lt;artifactId&gt;lombok&lt;/artifactId&gt;      &lt;version&gt;1.18.36&lt;/version&gt;    &lt;/dependency&gt;    &lt;!--mybatis--&gt;    &lt;dependency&gt;      &lt;groupId&gt;org.mybatis&lt;/groupId&gt;      &lt;artifactId&gt;mybatis&lt;/artifactId&gt;      &lt;version&gt;3.5.19&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;      &lt;groupId&gt;org.mybatis&lt;/groupId&gt;      &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;      &lt;version&gt;2.0.7&lt;/version&gt;    &lt;/dependency&gt;    &lt;!--spring--&gt;    &lt;dependency&gt;      &lt;groupId&gt;org.springframework&lt;/groupId&gt;      &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;      &lt;version&gt;5.3.15&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;      &lt;groupId&gt;org.springframework&lt;/groupId&gt;      &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;      &lt;version&gt;5.3.15&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;      &lt;groupId&gt;org.springframework&lt;/groupId&gt;      &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;      &lt;version&gt;5.3.15&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;      &lt;groupId&gt;javax.servlet&lt;/groupId&gt;      &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;      &lt;version&gt;4.0.1&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;      &lt;groupId&gt;javax.servlet.jsp&lt;/groupId&gt;      &lt;artifactId&gt;javax.servlet.jsp-api&lt;/artifactId&gt;      &lt;version&gt;2.3.3&lt;/version&gt;    &lt;/dependency&gt;&lt;/dependencies&gt;\n\næ˜¯ä¸æ˜¯å¾ˆç®€å•ğŸƒ\n\n\næŠŠéœ€è¦çš„ä¾èµ–å¯¼è¿›æ¥ä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç¼–å†™Springé…ç½®æ–‡ä»¶ï¼ˆdataSource,sqlSessionFactory,MapperScannerConfigurer è¿™äº›æœ¬æ¥æ˜¯Mybatiså°å¼Ÿéœ€è¦çš„ï¼Œå¤§å“¥ç»™ä»–åšï¼Œå¥½å¤§å“¥ğŸ‘ï¼Œé‚£å¤§å“¥è¿˜éœ€è¦è¿›è¡Œæ³¨è§£beançš„æ‰«æï¼‰ï¼ŒMybatisé…ç½®æ–‡ä»¶ï¼ˆMybatiså°å¼Ÿè¡¨ç¤ºå¤ªæ„ŸåŠ¨äº†ï¼Œæˆ‘å°±åªç”¨ææentityå®ä½“ç±»çš„åˆ«åå°±è¡ŒğŸ˜ï¼‰ï¼Œè¿˜æœ‰SpringMVCçš„é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬é¦–å…ˆè¦æ¸…æ¥šSpringMVCçš„å·¥ä½œæµç¨‹ï¼Œæˆ‘ä»¬ä¸»è¦é…ç½®çš„æ˜¯å¯¹äºå¤„ç†å™¨è€Œè¨€ï¼Œå³@Controlleræ³¨è§£çš„æ‰«æèŒƒå›´ï¼š\n&lt;!--è‡ªåŠ¨æ‰«æ--&gt;&lt;context:component-scan base-package=&quot;com.xzit&quot;/&gt;&lt;!--å¤„ç†å™¨æ˜ å°„å™¨å’Œé€‚é…å™¨--&gt;&lt;mvc:annotation-driven/&gt;\n\n\n\n\n\n\n\næœ€åå°±æ˜¯web.xmlï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯å•¥ï¼Ÿå°±æ˜¯æ•´ä¸ªSSMæ¡†æ¶æ„æˆçš„webåº”ç”¨çš„éƒ¨ç½²æè¿°æ–‡ä»¶ï¼Œå«æœ‰TomcatæœåŠ¡å™¨çš„æ ¸å¿ƒè¡Œä¸ºã€‚ä¸»è¦é…ç½®SpringMVCçš„å‰ç«¯æ§åˆ¶å™¨ï¼ŒåŠ è½½éWebå±‚çš„Springé…ç½®ï¼ˆService,Daoç­‰Beanï¼‰ã€‚\n\n\næ¥ä¸‹æ¥å°±æ˜¯Mapper, Service, Controllerä¸‰å±‚ç»“æ„ï¼Œæ¯”å¦‚æŸ¥è¯¢æ‰€æœ‰çš„å­¦ç”Ÿåˆ—è¡¨ï¼Œä¼ é€’ç»“æœç»™ jsp æ–‡ä»¶ã€‚å°±å¯ä»¥åšå¢åˆ æ”¹æŸ¥æ“ä½œäº†ã€‚\n\n\nå¥½äº†ï¼ŒSSMçƒ­èº«ç¯èŠ‚ç»“æŸï¼Œå…¶ä¸­Servlet APIçš„SpringMVCï¼Œservlet APIï¼ŒJSP APIï¼Œweb.xml ç­‰ web è·¯å¾„æ–¹é¢çš„ å’Œ ä¸€äº› xml é…ç½®æ–‡ä»¶éƒ½æœ‰ä¸€äº›è¿‡æ—¶ï¼Œä½†æ˜¯Spring Webæ˜¯æœ‰SpringMVCæ¼”åŒ–è€Œæ¥ï¼Œä¿ç•™å¹¶ä¼˜åŒ–äº†ä¸€éƒ¨åˆ†åŸæœ‰çš„ç»„ä»¶ï¼Œå¯¹äºç†è§£SpringBootæœ‰å¾ˆå¥½çš„æ¨åŠ¨ä½œç”¨ã€‚\n\n\n\n\nä¸€. Springæ ¸å¿ƒæ¦‚å¿µï¼ˆ1ï¼‰ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰å’Œæ§åˆ¶åè½¬ï¼ˆIOCï¼‰çš„åŸºæœ¬åŸç†\n\n\nã€è¯´è¯´Springä¸­çš„IOCæ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿã€‘\nIOCæ§åˆ¶åè½¬æ˜¯å°†å¯¹è±¡çš„åˆ›å»ºå’Œç®¡ç†çš„èŒè´£äº¤ç»™Springå®¹å™¨ï¼Œåˆ›å»ºå¯¹è±¡å¹¶ä¸”æ³¨å…¥ä¾èµ–å¯¹è±¡è¿™ä¸ªåŠ¨ä½œæ˜¯ç”±IOCå®¹å™¨è€Œä¸æ˜¯ç¨‹åºå‘˜å®Œæˆçš„ã€‚\nå¥½å¤„æ˜¯é™ä½è€¦åˆåº¦ï¼Œç±»Aä¾èµ–ç±»Bï¼Œå¯ä»¥é€šè¿‡æ³¨è§£æˆ–è€…é…ç½®æ–‡ä»¶çš„æ–¹å¼å®Œæˆä¾èµ–æ³¨å…¥ï¼ŒåŠ å…¥ç±»Aä¸ä¾èµ–ç±»Bï¼Œåªéœ€ä¿®æ”¹å¯¹åº”çš„æ³¨è§£æˆ–è€…é…ç½®æ–‡ä»¶ã€‚è¿˜æœ‰ä¸€ä¸ªå¥½å¤„æ˜¯å¯¹è±¡çš„åˆ›å»ºæ˜¯ç”±IOCå®¹å™¨å®Œæˆçš„ï¼Œåˆ›å»ºå¯¹è±¡æ—¶å¯ä»¥åˆ¤æ–­æ˜¯å¦éœ€è¦ä»£ç†ï¼Œå¦‚æœéœ€è¦ï¼Œå°±å¯ä»¥ç›´æ¥åŒ…è£…è¿”å›ä»£ç†å¯¹è±¡ã€‚\n\n\nã€Springä¸­çš„DIæ˜¯ä»€ä¹ˆï¼Ÿã€‘\nä¾èµ–æ³¨å…¥æ˜¯æ§åˆ¶åè½¬çš„ä¸€ç§æœºåˆ¶ï¼Œåˆ›å»ºå¯¹è±¡æ—¶å¯ä»¥è‡ªåŠ¨å°†è¯¥å¯¹è±¡ä¾èµ–çš„å¯¹è±¡æ³¨å…¥è¿›å»ã€‚\n\n\nã€å¾ªç¯ä¾èµ–æ˜¯ä»€ä¹ˆï¼ŸSpringå¦‚ä½•è§£å†³å¾ªç¯ä¾èµ–ï¼Ÿã€‘\nå¾ªç¯ä¾èµ–æ˜¯å¤šä¸ªå¯¹è±¡ç›¸äº’ä¾èµ–å½¢æˆé—­ç¯ã€‚\næ¯”å¦‚Aå’ŒBå¾ªç¯ä¾èµ–ï¼Œå…ˆå®ä¾‹åŒ–Aï¼ŒåŒ…è£…æˆObjectFactoryå­˜å…¥ä¸‰çº§ç¼“å­˜ï¼Œæ ‡è®°Aæ­£åœ¨åˆ›å»ºä¸­ï¼Œå‘ç°Aéœ€è¦æ³¨å…¥Bï¼Œå°è¯•è·å–Bï¼Œè¿›å…¥Bçš„åˆ›å»ºæµç¨‹ï¼Œå®ä¾‹åŒ–Bä¹‹åï¼Œå°†Bæ”¾å…¥ä¸‰çº§ç¼“å­˜ï¼Œå‘ç°éœ€è¦æ³¨å…¥Aï¼Œä»ä¸‰çº§ç¼“å­˜ä¸­å–å‡ºAçš„ObjectFactoryï¼Œè°ƒç”¨getObject()æ–¹æ³•ç”ŸæˆAçš„æ—©æœŸå¼•ç”¨ï¼Œå°†Aä»ä¸‰çº§ç¼“å­˜ç§»åˆ°äºŒçº§ç¼“å­˜ä¸­ï¼ŒAçš„æ—©æœŸå¼•ç”¨æ³¨å…¥åˆ°Bä¹‹åï¼ŒBè¿›å…¥äº†ä¸€çº§ç¼“å­˜ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä»ä¸€çº§ç¼“å­˜ä¸­æŸ¥è¯¢åˆ°Bå¹¶ä¸”æ³¨å…¥åˆ°Aä¸­ã€‚\n\n\näºŒçº§ç¼“å­˜ä¸èƒ½è¿›è¡Œå¯¹è±¡çš„AOPä»£ç†ï¼Œå¦‚æœäºŒçº§ç¼“å­˜å­˜æ”¾ä»£ç†å¯¹è±¡ï¼Œå°±è¿åäº†Beançš„ç”Ÿå‘½å‘¨æœŸã€‚\n\n\n\n\nï¼ˆ2ï¼‰Beançš„ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ\næˆ‘ä¹‹å‰çœ‹bilibiliè§†é¢‘æäº†ä¸€ä¸ªDogç±»æ¡ˆä¾‹æ¥è¯´æ˜beanç”Ÿå‘½å‘¨æœŸï¼Œä»Šå¤©ç»“åˆé¢è¯•é¸­æ›´ç³»ç»Ÿåœ°æ€»ç»“ä¸€ä¸‹beançš„ç”Ÿå‘½å‘¨æœŸğŸƒ\n\n\nã€è¯´è¯´Beançš„ç”Ÿå‘½å‘¨æœŸã€‘\nBeançš„ç”Ÿå‘½å‘¨æœŸä¸»è¦æ˜¯\næ„é€ å‡½æ•°å®ä¾‹åŒ–\nä¾èµ–æ³¨å…¥\nåˆå§‹åŒ–å‰çš„æ‰©å±•æœºåˆ¶ï¼ˆå¦‚æœBeanå®ç°äº†BeanNameAwareç­‰æ¥å£ï¼Œå°±è¿›è¡Œawareæ³¨å…¥ï¼‰\nåˆå§‹åŒ–å‰ï¼ˆå¯ä»¥ä½¿ç”¨BeanPostProcessoræ¥å£çš„å‰ç½®æ–¹æ³•å¯¹Beanè¿›è¡Œä¸€äº›é¢å¤–å¤„ç†ï¼‰\nåˆå§‹åŒ–ï¼ˆå¯ä»¥é€šè¿‡init-mothedæŒ‡å®šçš„åˆå§‹åŒ–æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨InitializingBeanæ¥å£çš„afterPropertiesSetæ–¹æ³•ï¼‰\nåˆå§‹åŒ–åï¼ˆå¯ä»¥ä½¿ç”¨BeanPostProcessoræ¥å£çš„åç½®æ–¹æ³•å¯¹Beanè¿›è¡Œä¸€äº›é¢å¤–å¤„ç†ï¼Œè¿™ä¸ªåœ°æ–¹ä¸»è¦æ˜¯å®ç°AOPæˆ–è€…åŠ¨æ€ä»£ç†ï¼‰\nä½¿ç”¨Bean\né”€æ¯Beanï¼ˆå¯ä»¥é€šè¿‡destory-methodå±æ€§æŒ‡å®šçš„æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨DisposableBeanæ¥å£çš„destoryæ–¹æ³•ï¼‰\n\n\nã€Springçš„å•ä¾‹Beanæ˜¯å¦æœ‰å¹¶å‘å®‰å…¨é—®é¢˜ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿã€‘\nå­˜åœ¨å¹¶å‘å®‰å…¨é—®é¢˜ï¼Œå¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå¦‚æœå•ä¾‹BeanåŒ…å«å®ä¾‹å˜é‡æˆ–è€…éçº¿ç¨‹å®‰å…¨èµ„æºï¼Œå°±å¯èƒ½å¼•å‘çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚\nè§£å†³æ–¹æ¡ˆï¼šä¸€æ˜¯é¿å…åœ¨å•ä¾‹Beanä¸­ä½¿ç”¨å¯å˜çŠ¶æ€ï¼Œä»…ä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„æ•°æ®ç»“æ„ï¼ŒäºŒæ˜¯ä½¿ç”¨prototypeä½œç”¨åŸŸè€Œä¸æ˜¯é»˜è®¤çš„singletonä½œç”¨åŸŸï¼Œæ¯æ¬¡è¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„Beanå®ä¾‹ï¼Œé¿å…å…±äº«ä¸€ä¸ªBeanå®ä¾‹å¸¦æ¥çš„å¹¶å‘é—®é¢˜ã€‚ä¸‰æ˜¯é€šè¿‡åŠ é”æ¥ç®¡ç†å•ä¾‹Beanä¸­çš„å…±äº«èµ„æºã€‚è¿˜å¯ä»¥ä½¿ç”¨ThreadLocalä¿å­˜å˜é‡ã€‚\n\n\n\n\näºŒ. Springé…ç½®æ–¹å¼æŒæ¡åŸºäºXMLé…ç½®æ–¹å¼\nç†Ÿæ‚‰åŸºäºæ³¨è§£çš„é…ç½®ï¼ˆå¦‚@Configurableï¼Œ@Componentï¼‰\näº†è§£åŸºäºjavaé…ç½®ç±»çš„æ–¹å¼\n\n\nä¸‰. é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰æƒ³æƒ³AOPæ˜¯ä¸ªå•¥å‘¢ï¼Ÿå°±æ˜¯åŸºäºåŠ¨æ€ä»£ç†ï¼Œè¿˜æœ‰æ³¨æ„æœ‰åˆ‡ç‚¹å’Œåˆ‡é¢ï¼Œå…·ä½“çš„æ¡ˆä¾‹æˆ‘ä»¬å¯ä»¥çœ‹çœ‹ä¹‹å‰å­¦ä¹ çš„Springä»£ç ï¼Œå…ˆçœ‹çœ‹åŠ¨æ€ä»£ç†å§ğŸ˜\n\n\nï¼ˆ1ï¼‰ä¸¤ç§åŠ¨æ€ä»£ç†\næˆ‘ä»¬å…ˆå¼„æ¸…æ¥šä¸¤ç§åŠ¨æ€ä»£ç†ç©¶ç«Ÿæ˜¯å•¥ï¼Œæ‰“å¥½åŸºç¡€ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä¸¤ç§åŠ¨æ€ä»£ç†ğŸƒ\n\n\n\nJDKåŠ¨æ€ä»£ç†\nJDKåŠ¨æ€ä»£ç†çš„ç›®æ ‡å¯¹è±¡å¿…é¡»å®ç°æ¥å£ï¼Œä»£ç†å¯¹è±¡å®é™…ä¹Ÿæ˜¯è¿™ä¸ªæ¥å£çš„å®ç°ã€‚æ˜¯ç”±ç›®æ ‡å¯¹è±¡çš„ç±»åŠ è½½å™¨åŠ è½½çš„ï¼Œç„¶ååå°„ç”Ÿæˆä»£ç†ç±»çš„å®ä¾‹ï¼Œåå°„çš„è¿‡ç¨‹ä¸­å°±ä¼šå°†InvocationHandlerä¼ é€’ç»™çˆ¶ç±»çš„æ„é€ æ–¹æ³•ï¼Œæ‰€ä»¥å®ä¾‹åŒ–çš„ä»£ç†å¯¹è±¡å°±æŒæœ‰InvocationHandlerçš„å¼•ç”¨ã€‚\n\n\nä¾æ—§æ˜¯ä»£ç è¾…åŠ©ç†è§£ğŸƒ\n// æ¥å£å’Œå®ç°ç±»public interface UserService &#123;Â  Â void save();Â  Â void delete();&#125;public class UserServiceImpl implements UserService &#123;Â  Â @OverrideÂ  Â public void save() &#123;Â  Â  Â  Â System.out.println(&quot;ä¸»ä¸šåŠ¡é€»è¾‘:å¢åŠ ç”¨æˆ·ç®¡ç†&quot;);Â  &#125;Â  Â @OverrideÂ  Â public void delete() &#123;Â  Â  Â  Â System.out.println(&quot;ä¸»ä¸šåŠ¡é€»è¾‘:åˆ é™¤ç”¨æˆ·ç®¡ç†&quot;);Â  &#125;&#125;\n\n// InvocationHandlerpublic class MyInvocationHandler implements InvocationHandler &#123;Â  Â private Object obj;Â  Â public MyInvocationHandler(Object obj)&#123;Â  Â  Â  Â this.obj=obj;Â  &#125;Â  Â @OverrideÂ  Â public Object invoke(Object proxy, Method method, Object[] args) throwsThrowable &#123;       System.out.println(&quot;å¼€å§‹ç›‘æ§ç³»ç»Ÿ...&quot;);Â  Â  Â  Â long t1 = System.currentTimeMillis();//å½“å‰æ—¶é—´Â  Â  Â  Â try &#123;Â  Â  Â  Â  Â  Â Thread.sleep((int) (Math.random() * 2000));Â  Â  Â  &#125; catch (InterruptedException e) &#123;Â  Â  Â  Â  Â  Â e.printStackTrace();Â  Â  Â  &#125;Â  Â  Â  Â Object o = method.invoke(obj, args);Â  Â  Â  Â long t2 = System.currentTimeMillis();//å½“å‰æ—¶é—´Â  Â  Â  Â System.out.println(&quot;ç»“æŸç›‘æ§ç³»ç»Ÿ...&quot;);Â  Â  Â  Â System.out.println(&quot;ä¸€å…±è€—è´¹äº†&quot; + (t2 - t1) + &quot;æ¯«ç§’&quot;);Â  Â  Â  Â //åŠ æ—¥å¿—å¤„ç†Â  Â  Â  Â System.out.println(LocalDate.now() + &quot;è®¿é—®ç³»ç»Ÿ&quot;);Â  Â  Â  Â return o;Â  &#125;&#125;\n\n// ç”Ÿæˆä»£ç†å¯¹è±¡public class ProxyUtil &#123;Â  Â public static Object getProxy(Object target, InvocationHandler handler)&#123;Â  Â  Â  return Proxy.newProxyInstance(target.getClass().getClassLoader(),Â  Â  Â  Â  Â  Â  Â  Â target.getClass().getInterfaces(), handler);Â  &#125;&#125;\n\nå¥½ï¼Œæˆ‘ä»¬ç”Ÿæˆä»£ç†å¯¹è±¡ï¼Œè°ƒç”¨æ–¹æ³•ï¼Œå°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åŠ¨çš„æ‰‹è„šäº†ğŸ˜\n\n\n\n\nCGLIBåŠ¨æ€ä»£ç†\nCGLIBåŠ¨æ€ä»£ç†æ˜¯åŸºäºç»§æ‰¿ç›®æ ‡ç±»å®ç°çš„ï¼Œä¸»è¦å°±æ˜¯é€šè¿‡å®ç°MethodInterceptoræ¥å£å®šä¹‰ä¸€ä¸ªæ‹¦æˆªå™¨ã€‚\n\n\nä¾æ—§æ˜¯æ”¾ä»£ç è¾…åŠ©ç†è§£ğŸ˜\n// å®šä¹‰ä¸€ä¸ªç±»public class AccountService &#123;Â  Â public void save()&#123;Â  Â  Â  Â System.out.println(&quot;ä¿å­˜è´¦åŠ¡ç®¡ç†ä¸šåŠ¡&quot;);Â  &#125;Â  Â public void pay()&#123;Â  Â  Â  Â System.out.println(&quot;æ”¯æŒç®¡ç†ä¸šåŠ¡&quot;);Â  &#125;&#125;\n\n// æ‹¦æˆªå™¨public class MyInterceptor implements MethodInterceptor &#123;Â  Â private Object obj;Â  Â public MyInterceptor(Object obj) &#123;Â  Â  Â  Â this.obj = obj;Â  &#125;Â  Â @OverrideÂ  Â public Object intercept(Object o, Method method, Object[] objects, MethodProxy methodProxy) throws Throwable &#123;Â  Â  Â  Â System.out.println(&quot;è¿›å…¥ç³»ç»Ÿ&quot;);Â  Â  Â  Â Object invoke = method.invoke(obj, objects);Â  Â  Â  Â System.out.println(LocalDate.now());Â  Â  Â  Â return invoke;Â  &#125;&#125;\n\n// åˆ›å»ºä»£ç†å¯¹è±¡AccountService service = new AccountService();// Proxy.newProxyInstance(classloder,interfaces,invocationhandler);Enhancer enhancer = new Enhancer();enhancer.setClassLoader(AccountService.class.getClassLoader());enhancer.setSuperclass(AccountService.class);enhancer.setCallback(new MyInterceptor(service));// ä½¿ç”¨lambdaè¡¨è¾¾å¼å®Œæˆå¤„ç†/* enhancer.setCallback((MethodInterceptor) (o, method, objects,methodProxy) -&gt; &#123;      System.out.println(&quot;å¼€å§‹ç›‘æ§&quot;);      Object invoke = method.invoke(service, objects);      System.out.println(&quot;ç›‘æ§ç»“æŸ&quot;);      System.out.println(LocalDate.now());      return invoke;&#125;);*/AccountService accountService = (AccountService) enhancer.create();\n\nå¥½äº†ï¼Œä¸¤ç§åŠ¨æ€ä»£ç†æ–¹å¼æ€»ç»“å®Œæ¯•ï¼Œæ¥ä¸‹æ¥å°±çœ‹çœ‹AOPå§ã€‚\n\n\n\n\n\n\nï¼ˆ2ï¼‰AOPåŸºæœ¬æ¦‚å¿µå’Œç”¨é€”\nã€ä»€ä¹ˆæ˜¯AOPï¼ŸAOPåŸºäºå“ªç§åŠ¨æ€ä»£ç†ï¼Ÿã€‘\nAOPæ˜¯é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œå°†é€šç”¨çš„å¹¶ä¸”å’Œä¸šåŠ¡é€»è¾‘æ— å…³çš„ä»£ç åˆ†ç¦»å¼€ï¼Œé™ä½ä»£ç çš„è€¦åˆåº¦ï¼Œé¿å…ä»£ç çš„é‡å¤æ€§ã€‚ä¸»è¦æ˜¯ç”±åˆ‡å…¥ç‚¹ï¼Œé€šçŸ¥ï¼Œåˆ‡é¢è¿™å‡ ä¸ªå…³é”®æ¦‚å¿µç»„æˆã€‚\nSpringæ¡†æ¶æ ¹æ®æœ‰æ— æ¥å£æ¥é€‰æ‹©æ˜¯å“ªç§åŠ¨æ€ä»£ç†ï¼ŒSpringBoot2.0å¼€å§‹é»˜è®¤çš„æ˜¯CGLIBåŠ¨æ€ä»£ç†ã€‚\n\n\nã€Spring AOP å’Œ AspectJ æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿã€‘\nSpring AOPæ˜¯ä¸»è¦ç”¨äºè¿è¡Œæ—¶çš„ä»£ç†æœºåˆ¶ï¼Œå¯¹äºéSpringå®¹å™¨ç®¡ç†çš„ç±»çš„æ–¹æ³•æ— æ³•ä»£ç†ï¼Œè€ŒAspectJæ˜¯åŠŸèƒ½æ›´å¼ºå¤§çš„AOPä»£ç†æ¡†æ¶ï¼Œæ”¯æŒç¼–è¯‘æ—¶ï¼Œç±»åŠ è½½æ—¶å’Œè¿è¡Œæ—¶çš„AOPåŠŸèƒ½ï¼Œä½¿ç”¨çš„èŒƒå›´æ›´å¹¿ï¼Œæ€§èƒ½æ›´ä¼˜ã€‚\n\n\n\n\nï¼ˆ3ï¼‰Spring AOPçš„é…ç½®å’Œå®ç°:\nä½¿ç”¨AspectJè¿›è¡ŒAOP:\n&lt;dependency&gt;Â  Â &lt;groupId&gt;org.springframework&lt;/groupId&gt;Â  Â &lt;artifactId&gt;spring-aspects&lt;/artifactId&gt;Â  Â &lt;version&gt;5.3.16&lt;/version&gt;&lt;/dependency&gt;\n\nç±»çš„æ³¨è§£åŠ ä¸Š@Aspectï¼Œåˆ‡ç‚¹è¡¨è¾¾å¼ï¼š\nexecution([è®¿é—®æƒé™ç±»å‹] &lt;è¿”å›å€¼ç±»å‹&gt;  [åŒ…åç±»å]&lt;æ–¹æ³•å(å‚æ•°åˆ—è¡¨)&gt;  [å¼‚å¸¸åˆ—è¡¨])\n\nç°åœ¨æˆ‘ä»¬å¼€å§‹çœ‹çœ‹AOPçš„å…·ä½“æ¡ˆä¾‹å§ï¼Œä»¥ç¯ç»•é€šçŸ¥ä¸ºä¾‹ï¼š\n@Around(value = &quot;execution(* testUser(..))&quot;)public Object transaction(ProceedingJoinPoint point)&#123;Â  Â System.out.println(&quot;å¼€å¯äº‹åŠ¡&quot;);Â  Â Object res=null;Â  Â try &#123;Â  Â  Â  Â Object[] args = point.getArgs();Â  Â  Â  Â String acc=null;Â  Â  Â  Â if (args!=null)&#123;Â  Â  Â  Â  Â  Â acc= (String) args[0];Â  Â  Â  &#125;Â  Â  Â  Â if (acc.equals(&quot;12345&quot;)) &#123;Â  Â  Â  Â  Â  Â res = point.proceed();//è°ƒç”¨ç›®æ ‡æ–¹æ³•Â  Â  Â  Â  Â  Â User u=(User)res;Â  Â  Â  Â  Â  Â u.setName(&quot;æå››&quot;);Â  Â  Â  Â  Â  Â System.out.println(res);Â  Â  Â  &#125; elseÂ  Â  Â  Â  Â  Â System.out.println(&quot;å¸æˆ·ä¸å­˜åœ¨&quot;);Â  &#125; catch (Throwable throwable) &#123;Â  Â  Â  Â throwable.printStackTrace();Â  &#125;Â  Â System.out.println(&quot;æäº¤äº‹åŠ¡&quot;);Â  Â return res;&#125;// è¿™é‡Œæˆ‘ä»¬æ³¨æ„æ˜¯è¦ç”¨ProceedingJoinPointå¯¹è±¡è·å–æ–¹æ³•å‚æ•°å’Œæ‰§è¡Œæ–¹æ³•ã€‚// é‚£è¦æ˜¯ä»£ç†çš„è¿‡ç¨‹ä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œè¯¥å’‹åŠï¼Ÿè¿™ä¸ªæ—¶å€™å°±å¯ä»¥å®šä¹‰ä¸€ä¸ªå¼‚å¸¸é€šçŸ¥ï¼Œæ¯”å¦‚ï¼š@AfterThrowing(value = &quot;execution(* showMenu(..))&quot;,throwing = &quot;e&quot;)public void catchException(Exception e)&#123;Â  Â System.out.println(&quot;å‡ºç°äº†å¼‚å¸¸&quot;+e.toString());&#125;\n\n\n\nï¼ˆ3ï¼‰äº†è§£å¸¸ç”¨çš„åˆ‡é¢ï¼ˆäº‹åŠ¡åˆ‡é¢ï¼Œæ—¥å¿—åˆ‡é¢ï¼‰\n\n\n\n\nå››. Springäº‹åŠ¡ç®¡ç†ï¼ˆ1ï¼‰äº†è§£å£°æ˜å¼äº‹åŠ¡å’Œç¼–ç¨‹å¼äº‹åŠ¡çš„åŒºåˆ«\nå£°æ˜å¼äº‹åŠ¡æ˜¯ä½¿ç”¨@Transactionalæ³¨è§£å£°æ˜æ–¹æ³•çš„äº‹åŠ¡è¾¹ç•Œï¼Œåœ¨æ–¹æ³•æ‰§è¡Œå‰è‡ªåŠ¨å¼€å¯äº‹åŠ¡ï¼Œæ–¹æ³•ç»“æŸåè‡ªåŠ¨æäº¤äº‹åŠ¡ã€‚è€Œç¼–ç¨‹å¼äº‹åŠ¡æ˜¯ä½¿ç”¨PlatformTransactionManageræ¥å£æ˜¾å¼åœ°å¼€å¯ï¼Œæäº¤å’Œå›æ»šäº‹åŠ¡ã€‚\n\n\nï¼ˆ2ï¼‰ç†Ÿæ‚‰äº‹åŠ¡ä¼ æ’­è¡Œä¸ºå’Œéš”ç¦»çº§åˆ«çš„é…ç½®\n\n\nã€è¯´è¯´Springæœ‰å“ªå‡ ç§äº‹åŠ¡ä¼ æ’­è¡Œä¸ºã€‘\näº‹åŠ¡ä¼ æ’­è¡Œä¸ºæŒ‡çš„æ˜¯è°ƒç”¨æ–¹æ³•æ—¶æ˜¯å¦åŠ å…¥äº‹åŠ¡ï¼Œç”¨ä»€ä¹ˆæ ·çš„äº‹åŠ¡ç®¡ç†æœºåˆ¶ã€‚\npropagation_required: å¦‚æœå­˜åœ¨äº‹åŠ¡ï¼Œå°±ç”¨å½“å‰äº‹åŠ¡ï¼Œå¦‚æœä¸å­˜åœ¨äº‹åŠ¡ï¼Œå°±æ–°åˆ›å»ºä¸€ä¸ªäº‹åŠ¡ã€‚\npropagation_required_new: æ–°åˆ›å»ºä¸€ä¸ªäº‹åŠ¡ï¼Œå¦‚æœå­˜åœ¨äº‹åŠ¡ï¼Œå°±å°†äº‹åŠ¡æŒ‚èµ·ã€‚\npropagation_supports: å¦‚æœå­˜åœ¨äº‹åŠ¡ï¼Œå°±ç”¨å½“å‰äº‹åŠ¡ï¼Œå¦‚æœä¸å­˜åœ¨äº‹åŠ¡å°±å•ç‹¬è¿è¡Œã€‚\npropagation_not_supports: ä»¥éäº‹åŠ¡çš„æ–¹å¼è¿›è¡Œæ“ä½œï¼Œå¦‚æœå­˜åœ¨äº‹åŠ¡å°±å°†äº‹åŠ¡æŒ‚èµ·ã€‚\npropagation_never: ä»¥éäº‹åŠ¡çš„æ–¹å¼è¿›è¡Œæ“ä½œï¼Œå¦‚æœå­˜åœ¨äº‹åŠ¡å°±æŠ›å‡ºå¼‚å¸¸ã€‚\npropagation_mandatory: è¿è¡Œå½“å‰äº‹åŠ¡ï¼Œæ²¡æœ‰å°±æŠ›å‡ºå¼‚å¸¸ã€‚\npropagation_nested: å­˜åœ¨äº‹åŠ¡å°±åœ¨åµŒå¥—äº‹åŠ¡å†…æ‰§è¡Œï¼Œå¦‚æœä¸å­˜åœ¨äº‹åŠ¡ï¼Œå°±åˆ›å»ºä¸€ä¸ªäº‹åŠ¡ã€‚\n\n\nã€äº‹åŠ¡æœ‰å“ªå‡ ç§éš”ç¦»çº§åˆ«ã€‘\nisolation_read_uncommitted: è¯»æœªæäº¤\nisolation_read_committed: è¯»å·²æäº¤\nisolation_repeatable_read: å¯é‡å¤è¯»\nisolation_serializable: ä¸²è¡ŒåŒ–\nmysqlçš„é»˜è®¤æƒ…å†µå°±æ˜¯å¯é‡å¤è¯»ã€‚\n\nï¼ˆ3ï¼‰æŒæ¡äº‹åŠ¡çš„å›æ»šä¸å¼‚å¸¸å¤„ç†æœºåˆ¶\n\n\næˆ‘ä»¬ç”¨ä¸€ä¸ªè½¬è´¦æ¡ˆä¾‹æ¥çœ‹çœ‹äº‹åŠ¡å›æ»šå’Œå¼‚å¸¸å¤„ç†æœºåˆ¶ğŸ˜\n@Servicepublic class AccServiceImpl implements AccService &#123;Â  Â @ResourceÂ  Â private AccMapper accMapper;Â  Â @Resource   private RecordsMapper recordsMapper;Â  Â @Transactional(Â  Â  Â  Â  Â  Â propagation = Propagation.REQUIRED,Â  Â  Â  Â  Â  Â isolation = Isolation.REPEATABLE_READ,Â  Â  Â  Â  Â  Â timeout = 3Â  Â  Â  Â  Â  /* rollbackFor = &#123;Â  Â  Â  Â  Â  Â  Â  Â  Â  Â FileNotFoundException.class,Â  Â  Â  Â  Â  Â  Â  Â  Â  Â NullPointerException.classÂ  Â  Â  Â  Â  Â &#125;,Â  Â  Â  Â  Â  Â noRollbackFor = &#123;&#125;*/Â   )Â  Â @OverrideÂ  Â public void doPay(int money) throws FileNotFoundException &#123;Â  Â  Â  Â //å­˜ä¸€æ¡äº¤æ˜“è®°å½•Â  Â  Â  Â Records records = new Records();Â  Â  Â  Â records.setAccno(&quot;123456&quot;).setCategory(&quot;æ”¯å‡º&quot;).setMoney(money);Â  Â  Â  Â recordsMapper.insert(records);Â  Â  Â  Â System.out.println(&quot;æ‰§è¡Œäº¤æ˜“è®°å½•å¤„ç†&quot;);Â  Â  Â  Â //æ¨¡æ‹Ÿè¶…æ—¶å¤„ç†Â  Â  Â  Â try &#123;Â  Â  Â  Â  Â  Â TimeUnit.SECONDS.sleep(4);Â  Â  Â  &#125; catch (InterruptedException e) &#123;Â  Â  Â  Â  Â  Â e.printStackTrace();Â  Â  Â  &#125;Â  Â  Â  Â //è¿è¡Œæ—¶å¼‚å¸¸Â  Â  Â  /* try &#123;Â  Â  Â  Â  Â  Â int i = 10 / 0;//ç®—æœ¯å¼‚å¸¸(è¿è¡Œæ—¶å¼‚å¸¸)Â  Â  Â  Â &#125;catch(ArithmeticException e)&#123;&#125;*/Â  Â  Â  Â //æ£€æŸ¥å‹å¼‚å¸¸Â  Â  Â  /* if (money &gt; 2000)Â  Â  Â  Â  Â  Â throw new FileNotFoundException(&quot;æ–‡ä»¶æ‰¾ä¸åˆ°å¼‚å¸¸&quot;);*/Â  Â  Â  Â //ä¿®æ”¹ç”¨æˆ·åŸå¸æˆ·ä¸‹çš„ä½™é¢Â  Â  Â  Â Acc acc = new Acc();Â  Â  Â  Â acc.setAccno(&quot;123456&quot;);Â  Â  Â  Â acc.setMoney(money);Â  Â  Â  Â accMapper.update(acc);Â  Â  Â  Â System.out.println(&quot;æ‰§è¡Œç”¨æˆ·ä½™é¢ä¿®æ”¹å¤„ç†&quot;);Â   &#125;&#125;\n\næ€»ç»“ä¸€ä¸‹ï¼šè¶…æ—¶å’Œè¿è¡Œæ—¶å¼‚å¸¸é»˜è®¤æƒ…å†µä¸‹ä¼šå›æ»šï¼Œè¿è¡Œæ—¶å¼‚å¸¸è¢«æ•æ‰äº†ï¼Œé‚£å°±ä¸ä¼šå›æ»šï¼Œæ£€æŸ¥å‹å¼‚å¸¸é»˜è®¤æƒ…å†µä¸‹ä¸å›æ»šï¼Œå¦‚æœ rollbackFor æŒ‡å®šäº†çš„è¯ï¼Œå°±å›æ»šã€‚\n\n\n\n\näº”. Springæ¨¡å—\n\nï¼ˆ1ï¼‰SpringMVC\nã€è¯´è¯´SpringMVCçš„æ‰§è¡Œæµç¨‹ã€‘\nç”¨æˆ·å‘é€è¯·æ±‚åˆ°å‰ç«¯æ§åˆ¶å™¨ï¼Œå‰ç«¯æ§åˆ¶å™¨æ˜¯ä¸€ä¸ªè°ƒåº¦ä¸­å¿ƒï¼Œå‰ç«¯æ§åˆ¶å™¨è°ƒç”¨æ˜ å°„å™¨ï¼Œå°†ç”¨æˆ·çš„è¯·æ±‚çš„urlæ˜ å°„åˆ°å…·ä½“çš„æ§åˆ¶å™¨æ–¹æ³•ï¼Œå†è°ƒç”¨é€‚é…å™¨é€‚é…åˆ°å¯¹åº”çš„å¤„ç†å™¨ï¼Œè¿”å›ModelAndViewå¯¹è±¡åˆ°è§†å›¾è§£æå™¨è§£ææˆè§†å›¾ï¼Œæœ€åè¿”å›ç»™ç”¨æˆ·ï¼Œè¯·æ±‚æ˜ å°„åˆ°å¤„ç†å™¨çš„å‰åï¼Œå¯ä»¥ä½¿ç”¨æ‹¦æˆªå™¨æ‹¦æˆªè¯·æ±‚ã€‚å› ä¸ºç°åœ¨éƒ½æ˜¯å‰åç«¯åˆ†ç¦»ï¼ŒåŸºæœ¬æ²¡æœ‰è§†å›¾éƒ¨åˆ†äº†ã€‚\n\n\nã€SpringMVCçš„å¸¸è§æ³¨è§£æœ‰é‚£äº›ï¼Ÿã€‘\n@RequestMappingï¼Œ@GetMappingï¼Œ@PostMappingæ˜ å°„è¯·æ±‚è·¯å¾„ï¼Œ@RequestParamæŒ‡å®šè¯·æ±‚å‚æ•°åç§°ï¼Œ@PathViriableä¼ é€’è·¯å¾„è¯·æ±‚å‚æ•°ï¼Œ@RequestBodyå°†jsonæ ¼å¼è½¬åŒ–ä¸ºjavaå¯¹è±¡è¿™äº›ã€‚\n\n\nã€è¯´è¯´SpringMVCå’ŒSpring WebFluxçš„åŒºåˆ«ã€‘\nSpringMVCæ˜¯åŒæ­¥é˜»å¡ï¼Œæ”¯æŒä¼ ç»Ÿçš„JDBCï¼Œé€‚åˆä½å¹¶å‘åœºæ™¯ï¼Œè€ŒSpring WebFluxä½¿ç”¨çš„æ˜¯å¼‚æ­¥éé˜»å¡ï¼Œå¼ºè°ƒçš„å°‘é‡çº¿ç¨‹çš„é«˜å¹¶å‘æ–¹é¢ï¼Œèµ„æºåˆ©ç”¨ç‡æ›´å¥½ã€‚\n\n\nï¼ˆ2ï¼‰Spring ORMå’ŒMybatisçš„é›†æˆ\nå‚è€ƒçƒ­èº«ç¯èŠ‚çš„SSMæ¡†æ¶éƒ¨åˆ†ã€‚\n\n\nï¼ˆ3ï¼‰Spring Securityé…ç½®å’Œä½¿ç”¨\nå‚è€ƒä¹‹å‰å†™çš„æ–‡ç« SpringSercurity\n\n\n\n\nå…­. Springäº‹åŠ¡ç›‘å¬å™¨\n\nï¼ˆ1ï¼‰Springäº‹ä»¶é©±åŠ¨æ¨¡å‹\näº‹ä»¶é©±åŠ¨æ¨¡å‹æ˜¯å®šä¹‰äº†å¯¹è±¡é—´çš„ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰€æœ‰ä¾èµ–å®ƒçš„å¯¹è±¡å¾—åˆ°é€šçŸ¥ï¼Œè‡ªåŠ¨æ›´æ–°ã€‚\n\n\nï¼ˆ2ï¼‰äº†è§£è‡ªå®šä¹‰äº‹ä»¶å’Œäº‹ä»¶ç›‘å¬å™¨çš„å®ç°\n\n\n\n\nä¸ƒ. Springç¼“å­˜\n\nï¼ˆ1ï¼‰äº†è§£Springçš„ç¼“å­˜æŠ½è±¡ä¸é…ç½®\nï¼ˆ2ï¼‰æŒæ¡å¸¸ç”¨ç¼“å­˜å®ç°ï¼ˆå¦‚EhCache, Redisï¼‰çš„é›†æˆä¸ä½¿ç”¨\n\n\n\n\nSpring Cacheæ˜¯ä¸€ä¸ªå¯ä»¥å®ç°åŸºäºæ³¨è§£çš„ç¼“å­˜åŠŸèƒ½çš„æ¡†æ¶ã€‚\n// å¸¸ç”¨æ³¨è§£@EnableCaching  åŠ è½½å¯åŠ¨ç±»ä¸Šï¼Œå¼€å¯ç¼“å­˜æ³¨è§£åŠŸèƒ½@Cacheable      æŸ¥è¯¢å‰çœ‹ç¼“å­˜æ˜¯å¦æœ‰æ•°æ®ï¼Œå¦‚æœæœ‰ï¼Œç›´æ¥è¿”å›ï¼Œæ²¡æœ‰ï¼ŒæŸ¥è¯¢åä¿å­˜åˆ°ç¼“å­˜ä¸­ã€‚@CachePut       æ–¹æ³•çš„è¿”å›å€¼æ”¾å…¥ç¼“å­˜@CacheEvict     å°†ä¸€æ¡æˆ–è€…å¤šæ¡æ•°æ®ä»ç¼“å­˜ä¸­åˆ é™¤\n\n\n\nåŸºäºredisç¼“å­˜çš„ä»£ç å®ä¾‹ï¼š\n&lt;dependency&gt;      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;      &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt;      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;      &lt;artifactId&gt;spring-boot-starter-cache&lt;/artifactId&gt;&lt;/dependency&gt;\n\n@PostMapping@CachePut(value = &quot;userCache&quot;, key = &quot;#user.id&quot;)//keyçš„ç”Ÿæˆï¼šuserCache::1public User save(@RequestBody User user)&#123;    userMapper.insert(user);    return user;&#125;\n\n@GetMapping@Cacheable(cacheNames = &quot;userCache&quot;,key=&quot;#id&quot;)public User getById(Long id)&#123;    User user = userMapper.getById(id);    return user;&#125;\n\n@DeleteMapping@CacheEvict(cacheNames = &quot;userCache&quot;,key = &quot;#id&quot;)//åˆ é™¤æŸä¸ªkeyå¯¹åº”çš„ç¼“å­˜æ•°æ®public void deleteById(Long id)&#123;    userMapper.deleteById(id);&#125;@DeleteMapping(&quot;/delAll&quot;)@CacheEvict(cacheNames = &quot;userCache&quot;,allEntries = true)//åˆ é™¤userCacheä¸‹æ‰€æœ‰çš„ç¼“å­˜æ•°æ®public void deleteAll()&#123;    userMapper.deleteAll();&#125;\n\n\n\n\n\nå…«. Springæµ‹è¯•ï¼ˆ1ï¼‰ç†Ÿæ‚‰Springçš„æµ‹è¯•æ¡†æ¶å’Œå·¥å…·\nï¼ˆ2ï¼‰æ•°æ®ç¼–å†™é›†æˆæµ‹è¯•å’Œå•å…ƒæµ‹è¯•çš„æ–¹æ³•\n\n\nSpringæµ‹è¯•ä¸»è¦åˆ†ä¸ºå•å…ƒæµ‹è¯•ï¼ˆå•ä¸ªç±»æˆ–è€…æ–¹æ³•ï¼‰å’Œé›†æˆæµ‹è¯•ï¼ˆç»„ä»¶äº¤äº’æ˜¯å¦æ­£ç¡®ï¼‰ï¼Œå•å…ƒæµ‹è¯•å¯ä»¥ä½¿ç”¨Junitï¼ˆjavaæ ‡å‡†å•å…ƒæµ‹è¯•æ¡†æ¶ï¼‰ï¼Œé›†æˆæµ‹è¯•å¯ä»¥ä½¿ç”¨ @SpringBootTestæ³¨è§£ã€‚\n\n\nJunitå•å…ƒæµ‹è¯•:\npublic class MyMathTest &#123;    @Test    public void testAdd() &#123;    MyMath math = new MyMath();    int result = math.add(2, 3);    assertEquals(5, result);    &#125;&#125;\n\n\n\nSpringBootTesté›†æˆæµ‹è¯•ï¼š\n@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)public class MyApplicationTests &#123;        @LocalServerPort    private int port;    @Autowired    private TestRestTemplate restTemplate;    @Test    public void testGetUserById() &#123;        String url = &quot;http://localhost:&quot; + port + &quot;/getUserById?id=1&quot;;        ResponseEntity&lt;String&gt; response = restTemplate.getForEntity(url, String.class);        System.out.println(&quot;æµ‹è¯•ç»“æœä¸ºï¼š&quot; + response.getBody());    &#125;&#125;","categories":["javaé¢è¯•"],"tags":["Spring"]},{"title":"é¢è¯•ç³»åˆ—ä¹‹SpringBoot","url":"/2025/05/11/%E9%9D%A2%E8%AF%95%E7%B3%BB%E5%88%97%E4%B9%8BSpringBoot/","content":"\n\nä¸€. è‡ªåŠ¨é…ç½®åŸç†\n\nï¼ˆ1ï¼‰ç†è§£SpringBootçš„è‡ªåŠ¨é…ç½®æœºåˆ¶\n\n\nã€SpringBootçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿã€‘\né€šè¿‡èµ·æ­¥ä¾èµ–å’Œè‡ªåŠ¨é…ç½®æ¥å®ç°çš„ï¼Œèµ·æ­¥ä¾èµ–åŒ…å«æ‰€éœ€çš„jaråŒ…ï¼Œæœ‰é…ç½®ç±»ä»¥åŠæä¾›çš„Beanï¼Œé‚£ä¹ˆå°±æœ‰ä¸€ä¸ªé—®é¢˜äº†ï¼Œè¿™äº›é…ç½®ç±»å’Œæä¾›çš„Beanæ˜¯å¦‚ä½•å¯¼å…¥åˆ°æˆ‘ä»¬é¡¹ç›®ä¸­çš„Springå®¹å™¨é‡Œå‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å°±éœ€è¦è‡ªåŠ¨é…ç½®äº†ï¼Œèµ·æ­¥ä¾èµ–æ¸…æ¥šè‡ªå·±è¦å¯¼å…¥é‚£äº›é…ç½®ç±»å’ŒBeanï¼Œå°±å°†éœ€è¦çš„é…ç½®ç±»å’ŒBeanè®°å½•åœ¨springboot-autoconfigureè¿™ä¸ªjaråŒ…ä¸‹çš„autoConfiguration.importæ–‡ä»¶ä¸­ï¼Œè‡³äºè¿™ä¸ªæ–‡ä»¶ä¸­çš„é…ç½®ç±»å’ŒBeanæ˜¯å¦‚ä½•è¢«å‘ç°çš„ï¼Ÿ@SpringBootApplicationæ³¨è§£å°è£…äº†ä¸€ä¸ª@EnableAutoConfigurationæ³¨è§£ï¼Œè¿™ä¸ªæ³¨è§£åˆå°è£…äº†@Importæ³¨è§£ï¼Œ@Importæ³¨è§£çš„å‚æ•°å°±æ˜¯ImportSelectoræ¥å£çš„å®ç°ç±»ï¼Œå®ç°ç±»çš„SelectImportså®ç°æ–¹æ³•å°±å‘ç°autoConfiguration.importæ–‡ä»¶ï¼Œæœ€åå¯¼å…¥æ–‡ä»¶ä¸­è®°å½•çš„é…ç½®ç±»å’ŒBeanå°±è¡Œäº†ã€‚\n\n\n\n\nï¼ˆ2ï¼‰ç†Ÿæ‚‰SpringBoot Starterçš„ä½¿ç”¨å’Œè‡ªå®šä¹‰\n\n\nOK, æˆ‘ä»¬æ¥çœ‹çœ‹è‡ªå®šä¹‰èµ·æ­¥ä¾èµ–aliyun OSSçš„æ¡ˆä¾‹ï¼š\naliyun-oss-spring-boot-autoconfigureè‡ªåŠ¨é…ç½®:\n\n\nç„¶åaliyun-oss-spring-boot-starterå¼•å…¥å…¶ä»–ä¾èµ–åº“å’Œè‡ªåŠ¨é…ç½®ï¼Œè¿›è¡Œèšåˆã€‚\næˆ‘ä»¬çš„é¡¹ç›®åªéœ€ä¾èµ–aliyun-oss-spring-boot-starterå³å¯ã€‚\n\n\n\n\näºŒ. SpringBootçš„å¯åŠ¨æµç¨‹\n\nï¼ˆ1ï¼‰æŒæ¡SpringBootåº”ç”¨çš„å¯åŠ¨è¿‡ç¨‹\n\n\nã€è¯´è¯´SpringBootçš„å¯åŠ¨æµç¨‹ã€‘\n\nmainæ–¹æ³•æ‰§è¡Œ\nåˆ›å»ºæ‰§è¡Œå¯åŠ¨æ ¸å¿ƒç±»SpringApplicationï¼Œåˆ¤æ–­åº”ç”¨ç±»å‹ï¼Œè®¾ç½®åˆå§‹åŒ–å™¨å’Œç›‘å¬å™¨ï¼Œç¡®å®šä¸»åº”ç”¨ç±»\nrunæ–¹æ³•ï¼šå‡†å¤‡åº”ç”¨ç¯å¢ƒï¼ŒåŠ è½½é…ç½®æ–‡ä»¶ï¼Œåˆ›å»ºå’Œåˆ·æ–°Springå®¹å™¨ï¼Œå¯åŠ¨åµŒå…¥å¼WebæœåŠ¡å™¨ï¼Œå‘å¸ƒå·²å¯åŠ¨äº‹ä»¶ï¼Œæ‰§è¡Œå®ç° CommandLineRunner å’Œ ApplicationRunner æ¥å£çš„åˆå§‹åŒ–é€»è¾‘ï¼Œå‘å¸ƒ ready äº‹ä»¶ï¼Œåº”ç”¨å¯åŠ¨å®Œæˆã€‚\n\n\n\nï¼ˆ2ï¼‰ç†è§£SpringApplicationç±»çš„åŠŸèƒ½ä¸é…ç½®\nç›¸å½“äºSpringBootåº”ç”¨çš„å¤§è„‘ï¼Œå¯ä»¥åŠ è½½é…ç½®æ–‡ä»¶ï¼Œå®ç°è‡ªåŠ¨é…ç½®ï¼Œå¯åŠ¨åµŒå…¥å¼WebæœåŠ¡å™¨å’Œäº‹ä»¶é©±åŠ¨ã€‚\n\n\nä¸‰. å¸¸ç”¨æ³¨è§£ä¸é…ç½®\n\nç†Ÿæ‚‰@SpringBootApplicationï¼Œ@EnableAutoConfigurationç­‰æ³¨è§£çš„ä½œç”¨\næŒæ¡é…ç½®æ–‡ä»¶çš„ä½¿ç”¨ä¸ç®¡ç†\n\n\nå››. SpringBootä¸Springé›†æˆæŒæ¡SpringBootå¯¹Springæ¡†æ¶çš„å¢å¼ºå’Œç®€åŒ–\næŒæ¡SpringBootä¸Springæ¨¡å—ï¼ˆSpringMVCï¼ŒSpring Dataç­‰ï¼‰çš„é›†æˆæ–¹å¼\n\n\n\næ¨¡å—\nStarter ä¾èµ–\nåŠŸèƒ½\n\n\n\nSpring MVC\nspring-boot-starter-web\né›†æˆ Spring MVC ä¸å†…åµŒ Tomcatã€‚\n\n\nSpring Data JPA\nspring-boot-starter-data-jpa\né›†æˆ JPA + Hibernate + æ•°æ®æºã€‚\n\n\nSpring Security\nspring-boot-starter-security\nè‡ªåŠ¨é…ç½®è®¤è¯ã€æˆæƒã€CSRF é˜²æŠ¤ç­‰ã€‚\n\n\nSpring Batch\nspring-boot-starter-batch\nç®€åŒ–æ‰¹å¤„ç†ä»»åŠ¡é…ç½®ã€‚\n\n\nSpring AMQP\nspring-boot-starter-amqp\né›†æˆ RabbitMQ æ¶ˆæ¯é˜Ÿåˆ—ã€‚\n\n\n\n\n\n\näº”. SpringBoot Actuatoräº†è§£Actuatorçš„åŠŸèƒ½ä¸ä½¿ç”¨\nSpringBoot Actuatoræ˜¯SpringBootæä¾›çš„ä¸€ä¸ªç›‘æ§å’Œç®¡ç†åŠŸèƒ½çš„å·¥å…·ã€‚\nç†Ÿæ‚‰ç›‘æ§ä¸ç®¡ç†ç«¯ç‚¹çš„é…ç½®\n\n\n\n\nå…­. å…¶ä»–æŒæ¡SpringBootä¸Mybatisçš„é›†æˆä¸ä½¿ç”¨\næŒæ¡SpringBootä¸­Spring Securityçš„é›†æˆä¸é…ç½®ï¼ŒåŸºæœ¬çš„è®¤è¯å’Œæˆæƒæœºåˆ¶\næŒæ¡ç¼–å†™SpringBootåº”ç”¨çš„å•å…ƒæµ‹è¯•ä¸é›†æˆæµ‹è¯•ï¼šå•å…ƒæµ‹è¯•@Testï¼Œé›†æˆæµ‹è¯•@SpringBootTestï¼Œ@Test\nJunitå’ŒSpringBootTestéƒ½è¢«spring-boot-starter-testè¿™ä¸ªèµ·æ­¥ä¾èµ–åŒ…å«ã€‚\n","categories":["javaé¢è¯•"],"tags":["SpringBoot"]},{"title":"é¢è¯•ç³»åˆ—ä¹‹JavaåŸºç¡€","url":"/2025/05/12/%E9%9D%A2%E8%AF%95%E7%B3%BB%E5%88%97%E4%B9%8BJava%E5%9F%BA%E7%A1%80/","content":"\n\nÎµ&#x3D;(Â´Î¿ï½€*)))å”‰ï¼Œè¿™ä¸€éƒ¨åˆ†æœ‰ç‚¹æ‚ä¹±ä¸”å¤šï¼Œæˆ‘æ€»ç»“çš„æ—¶å€™å¯ä»¥çœ‹çœ‹ä¹‹å‰çš„è¯¾ä»¶ï¼Œåšçš„ç¬”è®°ï¼Œå†ç»“åˆé¢è¯•é¸­åˆ·é¢˜è·¯çº¿ï¼ŒJavaGuideçš„è‡ªæµ‹é¢˜ã€‚æ‹†è§£æˆå‡ éƒ¨åˆ†ï¼Œé€ä¸€æ”»å…‹ã€‚\n\n\n\n\nä¸€. é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆ1ï¼‰å°è£…ï¼Œç»§æ‰¿å’Œå¤šæ€çš„å®ç°ä¸ä½¿ç”¨\n\n\nã€ä»€ä¹ˆæ˜¯Javaçš„å¤šæ€ç‰¹æ€§ã€‘\nå¤šæ€æ˜¯æŒ‡åŒä¸€ä¸ªæ¥å£æˆ–è€…çˆ¶ç±»å¼•ç”¨å˜é‡å¯ä»¥æŒ‡å‘ä¸åŒçš„å¯¹è±¡å®ä¾‹ï¼Œæ ¹æ®å®é™…æŒ‡å‘çš„å¯¹è±¡ç±»å‹æ‰§è¡Œç›¸åº”çš„æ–¹æ³•ã€‚\næ— éœ€ä¿®æ”¹åŸæœ‰ä»£ç ï¼Œå°±å¯ä»¥ä½¿ç”¨åŒä¸€æ–¹æ³•åœ¨ä¸åŒå¯¹è±¡ä¸Šè¡¨ç°çš„ä¸åŒè¡Œä¸ºã€‚\n\n\nã€defaultï¼Œprotectedï¼Œpublicè®¿é—®ä¿®é¥°ç¬¦ä¿®é¥°å±æ€§çš„åŒºåˆ«ã€‘\ndefaultè¡¨ç¤ºåªæœ‰åŒåŒ…çš„ç±»æ‰èƒ½è®¿é—®ï¼Œprotectedè¡¨ç¤ºåŒåŒ…æˆ–è€…ä¸åŒåŒ…çš„å­ç±»æ‰èƒ½è®¿é—®ï¼Œpublicè¡¨ç¤ºåŒä¸€ä¸ªæ¨¡å—ä¸‹ï¼ŒåŒåŒ…å’Œä¸åŒåŒ…çš„æ‰€æœ‰ç±»éƒ½èƒ½è®¿é—®ã€‚\n\n\nã€è¯´è¯´æœ‰é‚£äº›å†…éƒ¨ç±»ï¼Œæœ‰ä»€ä¹ˆä½œç”¨ã€‘\nJavaå†…éƒ¨ç±»æŒ‡çš„æ˜¯åœ¨ä¸€ä¸ªç±»çš„å†…éƒ¨å®šä¹‰çš„ç±»ï¼Œæœ‰æˆå‘˜å†…éƒ¨ç±»ï¼Œå±€éƒ¨å†…éƒ¨ç±»ï¼Œé™æ€å†…éƒ¨ç±»å’ŒåŒ¿åå†…éƒ¨ç±»ã€‚å¯ä»¥è®¿é—®å¤–éƒ¨ç±»çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•ã€‚ä¸»è¦ä½œç”¨å°±æ˜¯ç®€åŒ–ä»£ç ï¼Œå®ç°å›è°ƒå‡½æ•°æˆ–è€…äº‹ä»¶ç›‘å¬ç­‰äº‹ä»¶å¤„ç†ã€‚\n\n\nè¯´åˆ°åŒ¿åå†…éƒ¨ç±»ï¼Œæˆ‘ä»¬é¡ºä¾¿å¤ä¹ ä¸€ä¸‹lambdaè¡¨è¾¾å¼ï¼Œçœ‹ä¸€ä¸ªä»£ç å®ä¾‹ï¼š\n// Runnableæ¥å£çš„åŒ¿åå®ç°ç±»new Thread(new Runnable() &#123;    @Override    public void run() &#123;        System.out.println(&quot;çº¿ç¨‹è¿è¡Œä¸­&quot;);    &#125;&#125;).start();\n\n// lambdaè¡¨è¾¾å¼ç®€åŒ–new Thread(() -&gt; System.out.println(&quot;çº¿ç¨‹è¿è¡Œä¸­&quot;)).start();\n\nè¿™é‡Œæ³¨æ„äº†ï¼ŒLambdaè¡¨è¾¾å¼çš„å‰ææ˜¯ç›®æ ‡æ¥å£æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼ˆåªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ï¼‰\n\n\n \n\nï¼ˆ2ï¼‰ç†Ÿæ‚‰æŠ½è±¡ç±»çš„ä½¿ç”¨\n\n\nã€æŠ½è±¡ç±»å’Œæ¥å£æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿã€‘\nåœ¨è®¾è®¡åŠ¨æœºä¸Šæœ‰æ‰€ä¸åŒï¼Œæ¥å£æ˜¯è‡ªä¸Šè€Œä¸‹çš„ï¼Œå…ˆå®šä¹‰éœ€è¦å®ç°é‚£äº›æ–¹æ³•ï¼Œå®ç°ç±»åœ¨è¿›è¡Œå®ç°ã€‚æŠ½è±¡ç±»æ˜¯è‡ªä¸‹è€Œä¸Šçš„ï¼Œå‘ç°äº†å¤šä¸ªç±»çš„å…±åŒé€»è¾‘ï¼Œå°†å…¬å…±é€»è¾‘å°è£…æˆä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå‡å°‘ä»£ç å†—ä½™ã€‚æ¥å£å¯ä»¥å¤šç»§æ‰¿ï¼ŒæŠ½è±¡ç±»ä¸è¡Œï¼ŒæŠ½è±¡ç±»å¯ä»¥æœ‰æ„é€ å‡½æ•°å’Œæˆå‘˜å˜é‡ï¼Œæ¥å£æ²¡æœ‰æ„é€ å‡½æ•°ï¼Œæˆå‘˜å˜é‡åªèƒ½æ˜¯å¸¸é‡ã€‚\n\n\n\n\näºŒ. å¼‚å¸¸å¤„ç†\n\nï¼ˆ1ï¼‰ç†è§£å¼‚å¸¸çš„åˆ†ç±»ï¼ˆæ£€æŸ¥å‹å¼‚å¸¸ä¸éæ£€æŸ¥å‹å¼‚å¸¸ï¼‰\næ£€æŸ¥å‹å¼‚å¸¸æ˜¯ç¼–è¯‘æ—¶æ£€æŸ¥å‡ºæ¥çš„å¼‚å¸¸ï¼Œé€šå¸¸è¦æŠ›å‡ºæˆ–è€…æ•æ‰ï¼Œä¸èƒ½è®©ç¼–è¯‘å™¨æŠ›å‡ºæ¥ã€‚éæ£€æŸ¥å‹å¼‚å¸¸æ˜¯åŒ…æ‹¬è¿è¡Œæ—¶å¼‚å¸¸ï¼ˆè¿è¡Œé€»è¾‘å¼‚å¸¸ï¼‰å’Œé”™è¯¯ï¼ˆä¸¥é‡ç³»ç»Ÿé—®é¢˜ï¼Œæ¯”å¦‚å†…å­˜è€—å°½å’Œæ ˆæº¢å‡ºï¼‰ã€‚\n\n\nï¼ˆ2ï¼‰æŒæ¡è‡ªå®šä¹‰å¼‚å¸¸çš„åˆ›å»ºå’ŒæŠ›å‡º\n\n\næˆ‘ä»¬çœ‹çœ‹ä¸¤ç§å¼‚å¸¸çš„åˆ›å»ºå’ŒæŠ›å‡ºå§\n\n\næ£€æŸ¥å‹å¼‚å¸¸ï¼ˆç»§æ‰¿Exceptionç±»ï¼‰:throwæŠ›å‡ºæ—¶å¿…é¡»æ·»åŠ åˆ°æ–¹æ³•ç­¾åæˆ–è€…æ•æ‰ã€‚\n// // ç¤ºä¾‹ï¼šç”¨æˆ·æœªæ‰¾åˆ°çš„æ£€æŸ¥å‹å¼‚å¸¸public class UserNotFoundException extends Exception &#123;    // æä¾›æ„é€ æ–¹æ³•ä¼ é€’é”™è¯¯ä¿¡æ¯    public UserNotFoundException(String message) &#123;        super(message);    &#125;    // å¯é€‰ï¼šæ·»åŠ è‡ªå®šä¹‰å­—æ®µï¼ˆå¦‚é”™è¯¯ç ï¼‰    private int errorCode;    public UserNotFoundException(String message, int errorCode) &#123;        super(message);        this.errorCode = errorCode;    &#125;&#125;\n\n\n\néæ£€æŸ¥å‹å¼‚å¸¸ï¼ˆç»§æ‰¿RuntimeExceptionç±»ï¼‰throwæŠ›å‡ºæ—¶å¯ä»¥ä¸åšä»»ä½•å¤„ç†\n\n\n// ç¤ºä¾‹ï¼šå¹´é¾„æ— æ•ˆçš„éæ£€æŸ¥å‹å¼‚å¸¸public class InvalidAgeException extends RuntimeException &#123;    public InvalidAgeException(String message) &#123;        super(message);    &#125;    // å¯é€‰ï¼šæ·»åŠ é¢å¤–é€»è¾‘    public String getFixSuggestion() &#123;        return &quot;å¹´é¾„å¿…é¡»å¤§äº 0 ä¸”å°äº 150ï¼&quot;;    &#125;&#125;\n\n\n\n\n\nä¸‰. Javaå†…å­˜ç®¡ç†\n\nç†è§£æ ˆä¸å †çš„å†…å­˜åˆ†é…æœºåˆ¶\nç†Ÿæ‚‰åŸºæœ¬çš„åƒåœ¾å›æ”¶æ¦‚å¿µ\n\n\n\n\nå››. å¸¸ç”¨Javaåº“\n\nã€ä»€ä¹ˆæ˜¯è‡ªåŠ¨æ‹†ç®±åŸç†ï¼Ÿã€‘\nè£…ç®±æ˜¯ä½¿ç”¨äº†åŒ…è£…ç±»çš„valueOf( )æ–¹æ³•ï¼Œæ‹†ç®±æ˜¯è°ƒç”¨äº†æ¯”å¦‚intValue( )ä¹‹ç±»çš„æ–¹æ³•ã€‚\n\n\nã€é‡åˆ°è¿‡è‡ªåŠ¨æ‹†ç®±å¯¼è‡´çš„ç©ºæŒ‡é’ˆå¼‚å¸¸é—®é¢˜å—ï¼Ÿã€‘\næ•°æ®åº“çš„æŸ¥è¯¢ç»“æœä¸­ï¼ŒæŸä¸ªå­—æ®µä¸ºç©ºï¼Œæ˜ å°„åˆ°çš„å¯¹è±¡çš„å±æ€§ä¸ºç©ºï¼Œå¦‚æœå¯¹è¿™ä¸ªå±æ€§è‡ªåŠ¨æ‹†ç®±ï¼Œå°±ä¼šå¼•å‘ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚\n\n\næŒæ¡å¸¸ç”¨ç±»åº“ï¼ˆjava.langï¼Œjava.utilï¼‰çš„ä½¿ç”¨\nç†Ÿæ‚‰å­—ç¬¦ä¸²å¤„ç†ï¼ˆStringï¼ŒStringBuilderï¼ŒStringBufferï¼‰\n\n\nã€åŒ…è£…ç±»å‹çš„å¸¸é‡æ± æŠ€æœ¯äº†è§£å—ã€‘\njavaåŸºæœ¬ç±»å‹çš„åŒ…è£…ç±»å¤§éƒ¨åˆ†éƒ½å®ç°äº†å¸¸é‡æ± æŠ€æœ¯ã€‚å°±æ‹¿Integerä¸ºä¾‹ï¼Œåœ¨è‡ªåŠ¨è£…ç®±æ—¶ï¼Œå¯¹äºå€¼åœ¨-128åˆ°127ä¹‹é—´çš„intç±»å‹ï¼Œä¼šç›´æ¥è¿”å›ä¸€ä¸ªå·²ç»ç¼“å­˜çš„Integerå¯¹è±¡ï¼Œè€Œä¸æ˜¯åˆ›å»ºæ–°å¯¹è±¡ã€‚å‡å°‘å†…å®¹åˆ†é…å’Œåƒåœ¾å›æ”¶çš„è´Ÿæ‹…ã€‚\n\n\nã€Stringï¼ŒStringBufferå’ŒStringBuilderçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿã€‘\nStringæ˜¯ä¸å¯å˜çš„ï¼Œé€‚åˆå°‘é‡å­—ç¬¦ä¸²æ“ä½œ\nStringBufferæ˜¯å¯å˜å¹¶ä¸”çº¿ç¨‹å®‰å…¨çš„ï¼Œé€‚åˆå¤šçº¿ç¨‹ç¯å¢ƒä¸­çš„é¢‘ç¹å­—ç¬¦ä¸²ä¿®æ”¹ã€‚\nStringBuilderæ˜¯å¯å˜å¹¶ä¸”éçº¿ç¨‹å®‰å…¨çš„ï¼Œé€‚åˆå•çº¿ç¨‹ç¯å¢ƒä¸­çš„é«˜æ€§èƒ½å­—ç¬¦ä¸²å¤„ç†ã€‚\n\n\nã€ä¸ºä»€ä¹ˆStringç±»å‹æ˜¯ä¸å¯å˜çš„ï¼Ÿã€‘\nä¸€æ˜¯å­—ç¬¦ä¸²å¸¸é‡æ± ä¼šç¼“å­˜ä¸€äº›å­—ç¬¦ä¸²å¯¹è±¡ï¼Œå¤šä¸ªå­—ç¬¦ä¸²å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡å®ä¾‹ï¼ŒèŠ‚çœå†…å­˜ï¼Œä½†æ˜¯å¦‚æœStringç±»å‹æ˜¯å¯å˜çš„è¯ï¼Œä¿®æ”¹å­—ç¬¦ä¸²ä¼šå¯¼è‡´å…¶ä»–ä½¿ç”¨è¿™ä¸ªå­—ç¬¦ä¸²çš„åœ°æ–¹å‡ºç°é—®é¢˜ã€‚\näºŒæ˜¯å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼ŒStringç±»å‹æ˜¯å®‰å…¨çš„ï¼Œä¸éœ€è¦æ‹…å¿ƒStringè¢«ä¿®æ”¹çš„é—®é¢˜ã€‚\nä¸‰æ˜¯Stringç±»å‹å®ç°äº†hashCodeæ–¹æ³•ï¼ŒStringä¸å¯å˜å°±æ„å‘³ç€è®¡ç®—å¾—åˆ°çš„hashå€¼ä¸å˜ï¼Œå¯ä»¥ä¿è¯å“ˆå¸Œå€¼çš„ä¸€è‡´æ€§ã€‚\n\n\nã€é‡è½½å’Œé‡å†™çš„åŒºåˆ«ã€‘\né‡è½½å°±æ˜¯åŒåçš„æ–¹æ³•åœ¨ä¸åŒåœºæ™¯çš„åº”ç”¨ï¼Œå¤šä¸ªåŒåçš„æ–¹æ³•é€šå¸¸å®ƒä»¬çš„å‚æ•°æ•°é‡ä»¥åŠç±»å‹ä¸åŒã€‚\né‡å†™å°±æ˜¯ç»§æ‰¿çˆ¶ç±»å¹¶ä¸”é‡æ–°å®ç°çˆ¶ç±»çš„æ–¹æ³•ã€‚\n\n\nã€æ·±æ‹·è´å’Œæµ…æ‹·è´äº†è§£å—ï¼Ÿä»€ä¹ˆæ˜¯å¼•ç”¨æ‹·è´ï¼Ÿã€‘\næµ…æ‹·è´åˆ›å»ºçš„å¯¹è±¡å¦‚æœåŒ…å«å¼•ç”¨ç±»å‹çš„å±æ€§ï¼Œé‚£è¿™ä¸ªå±æ€§å°±å’ŒåŸå¯¹è±¡å¯¹åº”çš„å±æ€§å…±ç”¨ä¸€ä¸ªå†…éƒ¨å¯¹è±¡ï¼Œæ·±æ‹·è´æ˜¯å®Œå…¨å¤åˆ¶æ•´ä¸ªå¯¹è±¡ï¼ŒåŒ…æ‹¬å†…éƒ¨å¯¹è±¡ã€‚\n\n\n\n\näº”. è¾“å…¥è¾“å‡º\n\nï¼ˆ1ï¼‰ç†è§£Javaçš„I&#x2F;Oæµæœºåˆ¶\nï¼ˆ2ï¼‰ç†Ÿæ‚‰æ–‡ä»¶çš„è¯»å†™æ“ä½œ\nIOæµä¸»è¦åˆ†ä¸ºå­—èŠ‚æµï¼ˆInputStreamï¼ŒOutputStreamï¼‰ï¼Œå­—ç¬¦æµï¼ˆReaderï¼ŒWriterï¼‰ã€‚\n\n\nã€è¯´è¯´æ–‡ä»¶çš„è¯»å†™æ“ä½œï¼Œå¦‚ä½•å¤åˆ¶æ–‡ä»¶ï¼Ÿã€‘\n\n\nå­—ç¬¦æµæ“ä½œæ–‡ä»¶ï¼ˆä¸èƒ½æ“ä½œäºŒè¿›åˆ¶æ•°æ®ï¼Œå¦‚å›¾ç‰‡ï¼Œè§†é¢‘ç­‰ï¼‰\n// FileWriterFileWriter writer = new FileWriter(&quot;d:/aa/hello.txt&quot;);writer.write(&quot;hello world&quot;);writer.write(&quot;\\n&quot;)writer.flush();writer.close();// BufferedWriterFileWriter writer = new FileWriter(&quot;d:/aa/hello.txt&quot;);BufferedWriter bufferedWriter = new BufferedWriter(writer);bufferedWriter.write(&quot;hello world&quot;);bufferedWriter.newLine();bufferedWriter.close();// BufferedWriter å’Œ FileWriter çš„åŒºåˆ«ï¼š// FileWriteræ•ˆç‡ä½ï¼Œæ¯æ¬¡æ¥ä¸€ä¸ªå­—ç¬¦è¦æŸ¥ä¸€æ¬¡ç è¡¨ï¼ŒBufferWriterç¼“å­˜åŒºå­—ç¬¦æ»¡äº†ä¹‹åæ‰ä¼šæŸ¥ç è¡¨ï¼Œæ‰€ä»¥å¦‚æœé¢‘ç¹åœ°å†™æ–‡ä»¶ï¼Œæœ€å¥½ä½¿ç”¨BufferedWriterå¤„ç†ã€‚\n\n// FileReaderFileReader reader = new FileReader(&quot;d:/aa/hello.txt&quot;);char[] chars = new char[1024];reader.skip(4);int len = reader.read(chars, 0, 20);String str = new String(chars, 0, len);// BufferedReaderFileReader reader = new FileReader(&quot;d:/aa/hello.txt&quot;);BufferedReader bufferedReader = new BufferedReader(reader);String str;While ((str=bufferedReader.readLine()!=null)) &#123;    System.out.println(str);&#125;bufferedReader.close();\n\n\n\nå­—èŠ‚æµæ“ä½œæ–‡ä»¶ï¼š\n// FileInputStream ç›´æ¥è¯»å–åŸå§‹å­—èŠ‚æµFileInputStream fis = new FileInputStream(&quot;d:/aa/hello.txt&quot;);while(read = fis.read()!=1)    System.out.println((char)read);fis.close();// BufferedReader è¯»å–å­—èŠ‚æµè½¬æ¢ä¸ºå­—ç¬¦æµä¹‹åçš„ç»“æœFileInputStream fis = new FileInputStream(&quot;d:/aa/hello.txt&quot;);InputStreamReader isr = new InputStreamReader(fis, StandardCharsets.UTF_8);BufferedReader bufferedReader = new BufferedReader(isr);String read;while((read = bufferedReader.readLine())!=null) &#123;    System.out.println(read);&#125;fis.close();\n\n\n\næ–‡ä»¶å¤åˆ¶ï¼š\n// å¤šä¸ªå­—èŠ‚å¤åˆ¶FileInputStream fis;FileOutputStream fos;byte[] bytes = new byte[1024];int x;while((x = fis.read(bytes))!=-1) &#123;    fos.write(bytes, 0, x);&#125;fis.close();fos.close();// Buffered+å¤šä¸ªå­—èŠ‚å¤åˆ¶// å°†fiså’Œfosåˆ†åˆ«è½¬æ¢ä¸ºBufferedInputStreamå’ŒBufferedOutputStream,å…¶ä»–æ­¥éª¤ä¸€è‡´// transferToæ–¹æ³•fis.transferTo(fos);\n\n\n\n\n\nã€Javaçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ˜¯ä»€ä¹ˆï¼Ÿã€‘\nJavaçš„åºåˆ—åŒ–æ˜¯å¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚æµï¼Œç”¨äºä¼ è¾“ï¼Œä¿å­˜åˆ°ç¼“å­˜ä¸­æˆ–è€…å­˜å‚¨åˆ°é™æ€æ–‡ä»¶ä¸­ã€‚Javaçš„ååºåˆ—åŒ–æ˜¯å°†å­—èŠ‚æµè½¬æ¢ä¸ºå¯¹è±¡çš„è¿‡ç¨‹ã€‚\nä»£ç å®ä¾‹ï¼š\npublic class Student implements Seralizable &#123;    private static final long serialVersionUID = 1L;     private String name;    private int age;    // æ„é€ æ–¹æ³•    // getterå’Œsetter&#125;// åºåˆ—åŒ–ä¿å­˜åˆ°æ–‡ä»¶FileOutputStream fos = new FileOutputStream(&quot;d:/aa/stu.xxx&quot;)ObjectOutputStream oos = new ObjectOutputStream(fos);oos.writeObject(student);oos.close();// ååºåˆ—åŒ–FileInputStream fis = new FileInputStream(&quot;d:/aa/stu.xxx&quot;);ObjectInputStream ois = new ObjectInputStream(fis);Stuent student = (Student) ois.readObject();System.out.println(student);ois.close();\n\n\n\nã€ä¿¡æ¯çš„æœ€å°å­˜å‚¨å•ä½æ˜¯å­—èŠ‚ï¼Œä¸ºä»€ä¹ˆéœ€è¦å­—ç¬¦æµï¼Ÿã€‘\nå­—ç¬¦æµå°è£…äº†ç¼–ç è½¬æ¢ï¼Œå¼€å‘è€…æ— éœ€å…³æ³¨åº•å±‚å­—èŠ‚ä¸å­—ç¬¦çš„æ˜ å°„ã€‚å­—ç¬¦æµå†…éƒ¨ä½¿ç”¨ç¼“å­˜åŒºï¼Œä¸€æ¬¡è¯»å–å¤šä¸ªå­—èŠ‚å¹¶è½¬æ¢ä¸ºå­—ç¬¦ï¼Œå‡å°‘I&#x2F;Oæ“ä½œæ¬¡æ•°ã€‚\n\n\nã€BIOï¼ŒNIOå’ŒAIOæ˜¯ä»€ä¹ˆï¼Ÿã€‘\nåˆ†åˆ«æ˜¯é˜»å¡ï¼Œéé˜»å¡å’Œå¼‚æ­¥è¾“å…¥è¾“å‡ºã€‚BIOæ˜¯å¦‚æœè¦è¿›è¡ŒI&#x2F;Oæ“ä½œçš„æ•°æ®è¢«å ç”¨ï¼Œå°±é˜»å¡ï¼Œä¸€ç›´ç­‰å¾…ã€‚NIOæ˜¯å¦‚æœè¦è¿›è¡ŒI&#x2F;Oçš„æ•°æ®è¢«å ç”¨ï¼Œç«‹åˆ»è¿”å›ï¼Œå³ä½¿æ“ä½œæœªå®Œæˆã€‚AIOæ˜¯ä¸éœ€è¦ç­‰å¾…æ“ä½œå®Œæˆã€‚\n\n\n\n\nå…­. åå°„&amp;æ³¨è§£&amp;æ³›å‹\n\nã€javaåå°„æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆä¼˜ç‚¹ï¼Ÿã€‘\njavaçš„åå°„æœºåˆ¶æ˜¯æŒ‡åœ¨è¿è¡Œæ—¶è·å–ç±»çš„ç»“æ„ä¿¡æ¯ï¼Œæ¯”å¦‚å­—æ®µæ–¹æ³•ç­‰ï¼Œå¹¶ä¸”æ“ä½œå¯¹è±¡çš„ä¸€ç§æœºåˆ¶ã€‚å‘å°„æœºåˆ¶æä¾›äº†åœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ›å»ºå¯¹è±¡ï¼Œè®¿é—®å­—æ®µå’Œè°ƒç”¨æ–¹æ³•ï¼Œæ— éœ€åœ¨ç¼–è¯‘æ—¶çŸ¥é“è¿™äº›ç±»çš„å…·ä½“ä¿¡æ¯ã€‚\n\n\nã€è°ˆè°ˆå¯¹Javaæ³¨è§£çš„ç†è§£ï¼Œè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿã€‘\næ³¨è§£å°±æ˜¯ä¸€ç§æä¾›å…ƒæ•°æ®çš„æœºåˆ¶ï¼Œå¯ä»¥æ ‡è®°åœ¨ç±»ï¼Œå±æ€§å’Œæ–¹æ³•ä¸Šã€‚ä¸å½±å“ç¨‹åºçš„é€»è¾‘æ‰§è¡Œï¼Œå¯ä»¥ç”¨åå°„è·å–æ³¨è§£çš„å…ƒæ•°æ®ã€‚ç”¨åœ¨æ¡†æ¶é‡Œå°±å¯ä»¥ç®€åŒ–é…ç½®ã€‚\n\n\nã€Javaæ³›å‹çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿæ³›å‹æ“¦é™¤æŒ‡çš„æ˜¯ä»€ä¹ˆï¼Ÿã€‘\nJavaæ³›å‹ä½œç”¨æ˜¯é€šè¿‡åœ¨ç¼–è¯‘æ—¶æ£€æŸ¥ç±»å‹å®‰å…¨ï¼Œé¿å…åœ¨è¿è¡Œæ—¶å‘ç”Ÿç±»å‹è½¬æ¢çš„é”™è¯¯ã€‚å¦å¤–ï¼Œæ³›å‹è¿˜èƒ½ä½¿ä»£ç é€‚ç”¨äºå¤šç§ä¸åŒç±»å‹ï¼Œå‡å°‘ä»£ç é‡å¤ã€‚\næ³›å‹æ“¦é™¤æŒ‡çš„æ˜¯Javaç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶æ“¦é™¤æ³›å‹ä¿¡æ¯ï¼Œç”¨åˆé€‚çš„ç±»æ¥ä»£æ›¿æ³›å‹ç±»å‹çš„å‚æ•°ï¼Œé€šå¸¸æƒ…å†µä¸‹ä¼šç”¨å¯¹è±¡çš„ä¸Šé™æ¥ä»£æ›¿è¿™äº›ç±»å‹çš„å‚æ•°ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šä¸Šé™ï¼Œé»˜è®¤ç”¨Objectä»£æ›¿ã€‚\n\n\nã€Javaæ³›å‹æœ‰é‚£äº›é™åˆ¶ï¼Ÿã€‘\nJavaæ³›å‹çš„ä¸Šä¸‹ç•Œé™å®šç¬¦ç”¨äºå¯¹äºæ³›å‹ç±»å‹å‚æ•°è¿›è¡ŒèŒƒå›´é™åˆ¶ï¼Œä¸Šç•Œé™å®šç¬¦ï¼ˆ? extends Tï¼‰è¡¨ç¤ºé€šé…ç¬¦åªèƒ½æ˜¯Tç±»å‹æˆ–è€…Tçš„å­ç±»ï¼Œé€šå¸¸ç”¨äºè¯»å–æ“ä½œï¼Œä¸‹ç•Œé™å®šç¬¦ï¼ˆ? super Tï¼‰è¡¨ç¤ºé€šé…ç¬¦åªèƒ½æ˜¯Tç±»å‹æˆ–è€…Tç±»å‹çš„çˆ¶ç±»ï¼Œé€šå¸¸ç”¨äºå†™å…¥æ“ä½œã€‚\n\n\n\n\nå…­. åŸºç¡€å¤šçº¿ç¨‹\n\nç†è§£çº¿ç¨‹çš„åˆ›å»ºä¸å¯åŠ¨æ–¹å¼\næŒæ¡åŸºæœ¬çš„çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸç®¡ç†\n\n\n\n\nä¸ƒ. åŸºç¡€è®¾è®¡æ¨¡å¼\n\nï¼ˆ1ï¼‰äº†è§£åŸºç¡€è®¾è®¡æ¨¡å¼\nï¼ˆ2ï¼‰ç†è§£è®¾è®¡æ¨¡å¼çš„é€‚ç”¨åœºæ™¯ \nå•ä¾‹æ¨¡å¼ï¼ˆé¥¿æ±‰å¼ï¼Œæ‡’æ±‰å¼ï¼‰\nå·¥å‚æ¨¡å¼\n\n\n\n\nå…«. SPIè¿™ä¸€éƒ¨åˆ†ä¸ºè¿›é˜¶ï¼Œä¹‹ååœ¨åšã€‚\n","categories":["javaé¢è¯•"],"tags":["JavaåŸºç¡€"]},{"title":"é¢è¯•ç³»åˆ—ä¹‹MySQL","url":"/2025/05/04/%E9%9D%A2%E8%AF%95%E7%B3%BB%E5%88%97%E4%B9%8BMySQL/","content":"ä¸€. MySQLæ¶æ„\n\nMySQLæ¶æ„å…±æœ‰4å±‚ï¼Œç”±ä¸Šåˆ°ä¸‹åˆ†åˆ«ä¸ºè¿æ¥å±‚ï¼ŒæœåŠ¡å±‚ï¼Œå¼•æ“å±‚å’Œå­˜å‚¨å±‚ã€‚è¿æ¥å±‚è´Ÿè´£è®¿é—®æ ¡éªŒå’Œæˆæƒï¼ŒæœåŠ¡å±‚è´Ÿè´£sqlè¯­å¥çš„åˆ†æï¼Œä¼˜åŒ–ä»¥åŠæŸ¥è¯¢æ•°æ®çš„ç¼“å­˜ï¼Œå¼•æ“å±‚è´Ÿè´£æ•°æ®çš„å­˜å–ä»¥åŠç´¢å¼•çš„åˆ›å»ºï¼Œå­˜å‚¨å±‚è´Ÿè´£å°†æ•°æ®å­˜å‚¨åˆ°æ–‡ä»¶ç³»ç»Ÿä¸Šã€‚\n\n\nã€ä¸€æ¡sqlè¯­å¥åœ¨MySQLä¸­æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿã€‘\né¦–å…ˆåˆ°è¿æ¥å™¨éªŒè¯èº«ä»½å¹¶æˆæƒï¼Œç„¶åæŸ¥è¯¢ç¼“å­˜ï¼Œè‹¥æœ‰ç›¸åº”æ•°æ®ï¼Œç›´æ¥è¿”å›ï¼Œè‹¥æ²¡æœ‰ï¼Œåˆ™ä½¿ç”¨åˆ†æå™¨å¯¹SQLè¯­å¥è¿›è¡Œè¯­æ³•åˆ†æå’Œè¯æ³•åˆ†æï¼Œå†ä½¿ç”¨ä¼˜åŒ–å™¨å¯¹SQLè¯­å¥è¿›è¡Œä¼˜åŒ–ï¼Œåˆ°æ‰§è¡Œå™¨æ£€æŸ¥sqlè¯­å¥æ˜¯å¦æœ‰ç›¸åº”æƒé™ï¼Œå¦‚æœæœ‰å°±è°ƒç”¨å­˜å‚¨å¼•æ“æ‰§è¡Œsqlè¯­å¥ï¼Œè¿”å›æ•°æ®å¹¶ä¸”ä¿å­˜åˆ°ç¼“å­˜ä¸­ã€‚\n\n\nã€MySQLæœ‰é‚£äº›å­˜å‚¨å¼•æ“ï¼Œå®ƒä»¬ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿã€‘\nMySQLä¸»è¦çš„å­˜å‚¨å¼•æ“æ˜¯ MyISAM å’Œ InnoDBã€‚\nåŒºåˆ«ï¼š\n\nInnoDBçš„æ–‡ä»¶ç»“æ„ä¸º .frm æ–‡ä»¶ï¼ˆæ¯ä¸ªè¡¨éƒ½æœ‰çš„å…ƒæ•°æ®æ–‡ä»¶ï¼‰ï¼Œibd æ–‡ä»¶ï¼ˆç‹¬äº«è¡¨ç©ºé—´å­˜å‚¨æ–¹å¼ï¼Œæ¯ä¸ªè¡¨éƒ½æœ‰ä¸€ä¸ªï¼‰æˆ–è€… ibdataæ–‡ä»¶ï¼ˆå…±äº«è¡¨ç©ºé—´å­˜å‚¨æ–¹å¼ï¼Œåªæœ‰ä¸€ä¸ªï¼‰ï¼ŒMyISAMçš„æ–‡ä»¶ç»“æ„ä¸º .frm æ–‡ä»¶ï¼Œ.MYDæ–‡ä»¶ï¼ˆå­˜æ”¾æ•°æ®ï¼‰ï¼Œ.MYIæ–‡ä»¶ï¼ˆå­˜æ”¾ç´¢å¼•ï¼‰ã€‚\n\nInnoDBæ”¯æŒäº‹åŠ¡å’Œå¤–é”®ï¼Œæ˜¯èšç°‡ç´¢å¼•ï¼ŒMyISAMä¸æ”¯æŒäº‹åŠ¡å’Œå¤–é”®ï¼Œæ˜¯éèšç°‡ç´¢å¼•ã€‚\n\nInnoDBæœ€å°çš„é”ç²’åº¦æ˜¯è¡Œé”ï¼ŒMyISAMçš„æœ€å°é”ç²’åº¦æ˜¯è¡¨é”ï¼Œåè€…ä¸€æ¡æ›´æ–°è¯­å¥å°±ä¼šé”ç€æ•´å¼ è¡¨ï¼Œå…¶ä»–æŸ¥è¯¢æ›´æ–°è¯­å¥å°±ä¼šé˜»å¡ï¼Œå¯¼è‡´æ€§èƒ½è¾ƒå·®ã€‚\n\n\n\n\nã€MySQLå­—ç¬¦ä¸²ç±»å‹æœ‰é‚£äº›ï¼Ÿcharï¼Œvarcharæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿã€‘\nå­—ç¬¦ä¸²ç±»å‹æœ‰ï¼šchar, varchar, blob, text, set, enum\ncharæ˜¯å›ºå®šé•¿åº¦ï¼Œæœ€å¤šå­˜å‚¨255å­—èŠ‚ï¼Œvarcharæ˜¯æ ¹æ®å®é™…å­—ç¬¦æ‰€å å­—èŠ‚å†åŠ 1æˆ–2ï¼Œè¿™1æˆ–è€…2ä¸ªå­—èŠ‚æ˜¯å­˜å‚¨é•¿åº¦ã€‚è¶…è¿‡charæˆ–è€…varcharçš„æœ€å¤§é•¿åº¦é™åˆ¶çš„å­—ç¬¦ä¸²ä¼šè¢«æˆªæ–­ã€‚\n\n\n\n\näºŒ. ç´¢å¼•ç´¢å¼•æ˜¯å¸®åŠ©MySQLé«˜æ•ˆè·å–æ•°æ®çš„æ–¹å¼ï¼Œå¯ä»¥ç†è§£ä¸ºæ’å¥½åºçš„å¿«é€ŸæŸ¥æ‰¾çš„æ•°æ®ç»“æ„ã€‚\nä¸åŒçš„å­˜å‚¨å¼•æ“çš„ç´¢å¼•æœºåˆ¶ä¸åŒã€‚InnoDBçš„ç´¢å¼•å’ŒMyISAMçš„ç´¢å¼•éƒ½æ˜¯ç”¨B+æ ‘æ¥å®ç°çš„ã€‚InnoDBæ˜¯èšç°‡ç´¢å¼•ï¼Œç´¢å¼•å’Œæ•°æ®åœ¨ä¸€ä¸ªB+æ ‘ä¸Šï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªç£ç›˜å—ï¼Œéå¶å­èŠ‚ç‚¹å­˜å‚¨ç´¢å¼•ï¼Œå¶å­èŠ‚ç‚¹å­˜å‚¨æ•°æ®ã€‚è€ŒMyISAMæ˜¯éèšç°‡ç´¢å¼•ï¼Œéå¶å­èŠ‚ç‚¹å­˜å‚¨ç´¢å¼•ï¼Œå¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯æ•°æ®çš„å†…å­˜åœ°å€ã€‚\n\n\nã€MySQLç´¢å¼•çš„åº•å±‚å®ç°ä¸ºä»€ä¹ˆä¸ç”¨B-æ ‘ï¼Œä¸ºä»€ä¹ˆä¸ç”¨Hashï¼Ÿã€‘\nB-æ ‘å’ŒB+æ ‘çš„åŒºåˆ«åœ¨äºï¼ŒB-æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½å¯ä»¥å­˜å‚¨æ•°æ®ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªç£ç›˜å—ï¼Œå¤§å°å›ºå®šï¼Œå½“éå¶å­èŠ‚ç‚¹ä¸­çš„æ•°æ®è¾ƒå¤§æ—¶ï¼Œå®ƒèƒ½å­˜å‚¨çš„ç´¢å¼•æ•°é‡å°±è¾ƒå°‘ï¼Œé‚£ä¹ˆæ•´ä¸ªB-æ ‘è¦æƒ³å’ŒB+æ ‘å­˜å‚¨ç›¸åŒå¤§å°çš„æ•°æ®ï¼Œé«˜åº¦å°±æ›´å¤§ï¼Œè¿™ä¸ªæ—¶å€™è¦æƒ³æŸ¥æ‰¾å’Œæ“ä½œæ•°æ®çš„è¯ï¼Œç£ç›˜çš„IOæ¬¡æ•°å°±å¢å¤šï¼Œå°±é™ä½æŸ¥è¯¢å’Œæ“ä½œæ•°æ®çš„æ•ˆç‡ã€‚\nHashå®ç°ç´¢å¼•å°±æ˜¯ç”¨hashç®—æ³•å°†æ•°æ®åº“å­—æ®µæ•°æ®è½¬æ¢ä¸ºå®šé•¿çš„Hashå€¼ï¼Œä¸è¿™æ¡æ•°æ®çš„è¡ŒæŒ‡é’ˆä¸€èµ·å­˜å‚¨åˆ°hashè¡¨ä¸­ã€‚å­˜åœ¨hashç¢°æ’ï¼Œé€šè¿‡é“¾è¡¨æˆ–è€…ä¸€äº›å®šé•¿å¯»å€æ³•ï¼Œå¹³æ–¹å¯»å€æ³•è§£å†³ï¼Œåªèƒ½è¿›è¡Œç­‰å€¼æŸ¥è¯¢ï¼Œä¸èƒ½è¿›è¡Œé¡ºåºæŸ¥è¯¢å’ŒåŒºé—´æŸ¥è¯¢ï¼ŒæŸ¥è¯¢æ•ˆç‡æ¯”è¾ƒä½ã€‚\n\n\nã€å¦‚ä½•æ ¹æ®è¾…åŠ©ç´¢å¼•æŸ¥æ‰¾æ•°æ®ï¼Ÿã€‘\nä¾æ—§æ˜¯B+æ ‘å®ç°ï¼Œè¾…åŠ©ç´¢å¼•åœ¨éå¶å­èŠ‚ç‚¹å¹¶ä¸”æ ¹æ®ASCIIç è¿›è¡Œæ’åºï¼Œå¶å­èŠ‚ç‚¹å­˜å‚¨ä¸»é”®ï¼Œæ ¹æ®è¾…åŠ©ç´¢å¼•æŸ¥æ‰¾åˆ°ä¸»é”®ä¹‹åï¼Œå†é€šè¿‡ä¸»é”®è¿›è¡Œå›è¡¨æŸ¥è¯¢ã€‚\n\n\nInnoDBç´¢å¼•ç»“æ„è¦æ³¨æ„ä¸»é”®å ç”¨çš„å­˜å‚¨ç©ºé—´å°½é‡å°ä¸€ç‚¹ï¼Œä¾¿äºå­˜å‚¨ç´¢å¼•å’Œæ¯”è¾ƒå¤§å°\n\n\nã€è¦†ç›–ç´¢å¼•æ˜¯ä»€ä¹ˆï¼Ÿã€‘\nè¦†ç›–ç´¢å¼•æ˜¯æŸ¥è¯¢æ—¶selectçš„å­—æ®µè¢«ç´¢å¼•åŒ…å«ï¼Œé€šè¿‡æŸ¥æ‰¾ç´¢å¼•å°±èƒ½å¿«é€ŸæŸ¥æ‰¾åˆ°æ‰€éœ€çš„æ•°æ®ï¼Œä¸ä¸€å®šè¦åˆ°å¶å­èŠ‚ç‚¹æ‰¾åˆ°æ•´è¡Œæ•°æ®ã€‚MySQLæŸ¥è¯¢ä¼˜åŒ–å™¨åœ¨æŸ¥è¯¢å‰å°±ä¼šåˆ¤æ–­æ˜¯å¦å­˜åœ¨è¦†ç›–ç´¢å¼•çš„æƒ…å†µã€‚\n\n\n\n\nä¸‰. MySQLæŸ¥è¯¢\n\nsqlæŸ¥è¯¢è¯­å¥ï¼š\nSELECT DISTINCT &lt;select_list&gt;FROM  &lt;left_table&gt; &lt;join_type&gt;JOIN  &lt;right_table&gt; ON &lt;join_condition&gt;WHERE  &lt;where_condition&gt;GROUP BY  &lt;group_by_list&gt;HAVING &lt;having_condition&gt;ORDER BY &lt;order_by_condition&gt;LIMIT &lt;limit_number&gt;\n\n\n\nã€è”åˆæŸ¥è¯¢Joinæœ‰é‚£äº›ç±»å‹ï¼Œä¸åŒç±»å‹æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿã€‘\nLEFT JOIN: å·¦è¡¨æ‰€æœ‰æ•°æ® + ç¬¦åˆæ¡ä»¶çš„è”åˆæŸ¥è¯¢æ•°æ®RIGTH JOIN: å³è¡¨æ‰€æœ‰æ•°æ® + ç¬¦åˆæ¡ä»¶çš„è”åˆæŸ¥è¯¢æ•°æ®INNER JOIN: ç¬¦åˆæ¡ä»¶çš„è”åˆæŸ¥è¯¢æ•°æ®\n\n\n\n\n\nå››. äº‹åŠ¡\n\nï¼ˆ1ï¼‰äº‹åŠ¡çš„åŸºæœ¬è¦ç´  ACIDåŸå­æ€§ï¼šæ•´ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨ä¸å®Œæˆã€‚\nä¸€è‡´æ€§ï¼šäº‹åŠ¡çš„å¼€å§‹ä¹‹å‰ï¼Œäº‹åŠ¡ç»“æŸä¹‹åï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§çº¦æŸæ²¡æœ‰è¢«ç ´åã€‚\néš”ç¦»æ€§ï¼šä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œä¸èƒ½å…¶å®ƒäº‹åŠ¡å¹²æ‰°ã€‚\næŒä¹…æ€§ï¼šäº‹åŠ¡å®Œæˆæ—¶è¢«æ›´æ”¹çš„æ•°æ®æŒä¹…åœ°æŠ¥é”™åœ¨æ•°æ®åº“ä¸­ã€‚\n\n\nã€è¯´è¯´äº‹åŠ¡çš„å››å¤§ç‰¹æ€§å’Œå®ç°åŸç†ã€‘\näº‹åŠ¡çš„å››å¤§ç‰¹æ€§åˆ†åˆ«æ˜¯åŸå­æ€§ï¼Œä¸€è‡´æ€§ï¼Œéš”ç¦»æ€§å’ŒæŒä¹…æ€§ã€‚åŸå­æ€§ï¼Œä¸€è‡´æ€§å’ŒæŒä¹…æ€§æ˜¯é€šè¿‡äº‹åŠ¡æ—¥å¿—æ¥å®ç°ï¼Œéš”ç¦»æ€§æ˜¯é€šè¿‡é”æ¥å®ç°ã€‚\näº‹åŠ¡æ—¥å¿—åˆ†ä¸ºé‡åšæ—¥å¿—redoå’Œå›æ»šæ—¥å¿—undoï¼Œåœ¨äº‹åŠ¡å¯åŠ¨ä¹‹å‰ï¼Œå°†äº‹åŠ¡æ”¾å…¥å­˜å‚¨å¼•æ“çš„æ—¥å¿—ç¼“å†²é‡Œï¼Œåœ¨äº‹åŠ¡æäº¤å‰å°†æ—¥å¿—ç¼“å†²åˆ·æ–°åˆ°é‡åšæ—¥å¿—redoé‡Œï¼Œäº‹åŠ¡æäº¤ä¹‹åï¼Œåœ¨Buffer Poolä¸­æ˜ å°„çš„æ•°æ®æ–‡ä»¶ä¼šåœ¨åå°æ…¢æ…¢åœ°åˆ·æ–°åˆ°ç£ç›˜æ•°æ®æ–‡ä»¶ä¸­ï¼Œå®ç°æ•°æ®çš„æŒä¹…æ€§ã€‚å¦‚æœäº‹åŠ¡æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸æˆ–è€…æ•°æ®åº“å®•æœºï¼Œé‚£å°±å¯ä»¥é€šè¿‡é‡åšæ—¥å¿—redoæ¢å¤åˆ°è¯¥äº‹åŠ¡æ‰§è¡Œå‰çš„æ•°æ®çŠ¶æ€ï¼Œæˆ–è€…ç»§ç»­æäº¤ï¼Œä¿éšœäº†äº‹åŠ¡çš„åŸå­æ€§ã€‚è€Œå›æ»šæ—¥å¿—undoä¼šè®°å½•æ•°æ®æ“ä½œä¹‹å‰çš„çŠ¶æ€ï¼Œäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹æˆ–è€…å‡ºç°å¼‚å¸¸çš„æƒ…å†µéœ€è¦å›æ»šçš„è¯ï¼Œå°±å¯ä»¥æ ¹æ®å›æ»šæ—¥å¿—è¿›è¡Œå›æ»šï¼Œä¿éšœäº†æ•°æ®çš„ä¸€è‡´æ€§ã€‚\nï¼Ÿéš”ç¦»æ€§æ˜¯å¯ä»¥é€šè¿‡è®¾ç½®äº‹åŠ¡éš”ç¦»çº§åˆ«å’Œé”æ¥å®ç°\n\n\n\n\nï¼ˆ2ï¼‰å¹¶å‘äº‹åŠ¡å¼•å‘çš„é—®é¢˜å’Œéš”ç¦»çº§åˆ«\n\nã€äº‹åŠ¡å¹¶å‘å¼•å‘é‚£äº›é—®é¢˜ï¼Œé’ˆå¯¹è¿™äº›é—®é¢˜æœ‰é‚£äº›éš”ç¦»çº§åˆ«ï¼Ÿã€‘\n\n\nå¹¶å‘äº‹åŠ¡å¼•å‘é—®é¢˜ï¼š\nè„è¯»ï¼šäº‹åŠ¡Aè¯»å–äº†äº‹åŠ¡Bæ›´æ–°çš„æ•°æ®ï¼Œäº‹åŠ¡Bå›æ»šï¼Œè¿™ä¸ªæ—¶å€™ï¼Œäº‹åŠ¡Aè¯»åˆ°çš„æ•°æ®å°±æ˜¯è„æ•°æ®ã€‚\nä¸å¯é‡å¤è¯»ï¼šäº‹åŠ¡Aå¤šæ¬¡è¯»å–åŒä¸€æ•°æ®ï¼Œäº‹åŠ¡Båœ¨äº‹åŠ¡Aè¯»å–çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹è¯¥æ•°æ®è¿›è¡Œæ›´æ–°ï¼Œå¯¼è‡´Aå‰åè¯»å–çš„æ•°æ®ä¸ä¸€è‡´ã€‚\nå¹»è¯»ï¼šäº‹åŠ¡Aå¤šæ¬¡è¯»å–å‡ è¡Œæ•°æ®ï¼Œäº‹åŠ¡Båœ¨äº‹åŠ¡Aè¯»å–çš„è¿‡ç¨‹ä¸­æ’å…¥æ•°æ®ï¼Œé‚£äº‹åŠ¡Aå°±ä¼šè¯»å–åˆ°åŸæœ¬æ²¡æœ‰çš„æ•°æ®ï¼Œå¥½åƒå‘ç”Ÿäº†å¹»è§‰ã€‚\n\n\nä¸å¯é‡å¤è¯»å’Œå¹»è¯»çš„åŒºåˆ«åœ¨äºå‰è€…çš„ç€é‡ç‚¹åœ¨äºæ•°æ®è¢«ä¿®æ”¹ï¼Œåè€…åœ¨äºæ•°æ®çš„æ•°é‡å˜å¤šäº†æˆ–è€…å˜å°‘äº†ã€‚\n\n\né‚£ä¹ˆä¸ºäº†åº”å¯¹ä»¥ä¸Šçš„é—®é¢˜ï¼Œéœ€è¦è®¾ç½®éš”ç¦»çº§åˆ«ï¼š\nRead-uncommitted: å…è®¸è¯»å–å°šæœªæäº¤çš„æ•°æ®å˜æ›´ã€‚ä¼šå¯¼è‡´è„è¯»ï¼Œä¸å¯é‡å¤è¯»å’Œå¹»è¯»ã€‚\nRead-committed: å…è®¸è¯»å–å¹¶å‘äº‹åŠ¡ä¸­å·²ç»æäº¤çš„æ•°æ®ã€‚é¿å…è„è¯»ï¼Œä¼šå¯¼è‡´ ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ã€‚\nRepeatable-read: è¯»å–å·²ç»æäº¤çš„æ•°æ®ï¼Œå¹¶ä¿è¯å‰åè¯»å–æ•°æ®çš„ä¸€è‡´æ€§ã€‚é¿å…è„è¯»å’Œä¸å¯é‡å¤è¯»ï¼Œä½†è¿˜å¯èƒ½æœ‰å¹»è¯»ã€‚\nSerialiazable: äº‹åŠ¡é€ä¸ªè¿›è¡Œï¼Œé¿å…å¹¶å‘äº‹ç‰©çš„æ‰€æœ‰é—®é¢˜ã€‚\n\n\néš”ç¦»çº§åˆ«è¶Šé«˜ï¼Œå¹¶å‘æ€§è¶Šå·®ï¼ŒInnoDBå­˜å‚¨å¼•æ“çš„é»˜è®¤äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯Repeatable-readï¼Œä¿ç•™äº†æ¯”è¾ƒå¥½çš„å¹¶å‘æ€§ï¼Œè¿˜ä½¿ç”¨äº†Next-Key Lockç®—æ³•é¿å…äº†å‡ºç°å¹»è¯»çš„æƒ…å†µã€‚\n\n\n\n\nï¼ˆ3ï¼‰å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶MVCCã€äº†è§£MVCCå—ï¼Œè¯´è¯´å®ƒçš„åº•å±‚åŸç†ã€‘\n\n\nMVCCçš„å®ç°æ˜¯é€šè¿‡ä¿å­˜æ•°æ®åœ¨æŸä¸ªæ—¶é—´ç‚¹çš„å¿«ç…§æ¥å®ç°çš„ï¼Œæ¯ä¸ªäº‹åŠ¡çœ‹åˆ°çš„æ•°æ®éƒ½æ˜¯ç›¸åŒçš„ï¼Œå¯ä»¥å‡å°‘å¹¶å‘é”çš„æ·»åŠ ã€‚\n\n\nå¯ä»¥ä»¥InnoDBå­˜å‚¨å¼•æ“ä¸ºä¾‹ï¼Œè®¨è®ºMVCCæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚é€šè¿‡åœ¨æ¯è¡Œè®°å½•çš„åé¢ä¿å­˜ä¸¤ä¸ªéšè—åˆ—ï¼Œåˆ†åˆ«ä¸ºè¡Œç‰ˆæœ¬å·å’Œè¡Œåˆ é™¤æ ‡è¯†ï¼Œå‰è€…è¡¨ç¤ºåˆ›å»ºæˆ–è€…ä¿®æ”¹çš„æ—¶é—´ï¼Œåè€…è¡¨ç¤ºåˆ é™¤çš„æ—¶é—´ã€‚å½“æŸ¥è¯¢æ•°æ®æ—¶ï¼Œå°±ä¼šå°†å½“å‰çš„æ—¶é—´å’Œå‰é¢ä¸¤ä¸ªæ—¶é—´åšæ¯”è¾ƒï¼Œå½“å‰çš„æ—¶é—´ä¹Ÿå°±æ˜¯æŸ¥è¯¢çš„æ—¶é—´è¦åœ¨æ–°å¢æˆ–ä¿®æ”¹çš„æ—¶é—´ä¹‹åï¼Œåœ¨åˆ é™¤çš„æ—¶é—´ä¹‹å‰ã€‚ä¿è¯äº†æŸ¥è¯¢çš„æ˜¯æœ‰æ•ˆæ•°æ®å¹¶ä¸”é¿å…ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ã€‚\n\n\n\n\nï¼ˆ4ï¼‰äº‹åŠ¡æ—¥å¿—ã€äº‹åŠ¡æ—¥å¿—æœ‰ä»€ä¹ˆä¼˜ç‚¹ï¼Ÿã€‘\nInnoDBä½¿ç”¨æ—¥å¿—æ¥å‡å°‘æäº¤äº‹åŠ¡æ—¶çš„å¼€é”€ã€‚äº‹åŠ¡ä¿®æ”¹çš„æ•°æ®å’Œç´¢å¼•è¦æ˜ å°„åˆ°è¡¨ç©ºé—´ä¸­çš„éšæœºä½ç½®ï¼Œéœ€è¦å¾ˆå¤šIOï¼Œå¼€é”€æ¯”è¾ƒå¤§ï¼Œè¿˜å®¹æ˜“ä¸¢å¤±æ•°æ®ã€‚å°±å¯ä»¥åœ¨äº‹åŠ¡æäº¤ä¹‹å‰å°†äº‹åŠ¡è®°å½•åˆ°äº‹åŠ¡æ—¥å¿—æ–‡ä»¶å¹¶æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œäº‹åŠ¡æ—¥å¿—æ–‡ä»¶çš„è®°å½•æ˜¯è¿½åŠ å½¢å¼çš„ï¼Œå°±æ˜¯é¡ºåºIOï¼Œè¿˜èƒ½æé«˜è¯»å–æ€§èƒ½ï¼Œè¿™æ ·å°±ä¸æ€•æ•°æ®ä¸¢å¤±äº†ï¼Œé‚£ä¿®æ”¹çš„æ•°æ®å’Œç´¢å¼•å°±å¯ä»¥åœ¨åå°æ…¢æ…¢æŒä¹…åŒ–åˆ°ç£ç›˜æ•°æ®é‡Œäº†ã€‚\n\n\n\n\näº”. MySQLé”æœºåˆ¶\n\nMySQLé”ä¸»è¦åˆ†ä¸ºå…±äº«é”ï¼ˆè¯»é”ï¼ŒåŒä¸€ä»½æ•°æ®è¢«ä¸åŒäº‹åŠ¡åŒæ—¶è¯»å–ï¼‰å’Œæ’ä»–é”ï¼ˆå†™é”ï¼Œè¿›å½“å‰äº‹åŠ¡å¯è¯»å†™ï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½ï¼‰\nInnoDBæœ‰è¡¨é”å’Œè¡Œé”ï¼ˆé»˜è®¤ç”¨è¡Œé”ï¼Œç´¢å¼•å¤±æ•ˆåˆ™è½¬ä¸ºè¡¨é”ï¼‰ï¼ŒMyISAMåªæœ‰è¡¨é”ã€‚\n\n\nã€ä»€ä¹ˆæ˜¯ä¹è§‚é”å’Œæ‚²è§‚é”ï¼ŒInnoDBçš„è¡Œé”æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿã€‘\nä¹è§‚é”æ˜¯åœ¨è®¿é—®å’Œå¤„ç†æ•°æ®å‰ä¸åŠ é”ï¼Œåªæœ‰åœ¨æ›´æ–°æ•°æ®æ—¶æ ¹æ®ç‰ˆæœ¬å·æˆ–æ—¶é—´æˆ³åˆ¤æ–­æ˜¯å¦æœ‰å†²çªï¼Œæœ‰åˆ™å¤„ç†ï¼Œæ²¡æœ‰å°±æäº¤äº‹åŠ¡ã€‚æ‚²è§‚é”æ˜¯åœ¨è®¿é—®æˆ–å¤„ç†æ•°æ®å‰åŠ æ’ä»–é”ï¼Œäº‹åŠ¡æäº¤æˆ–è€…å›æ»šå°±é‡Šæ”¾é”ã€‚\nInnoDBæœ‰ä¸‰ç§è¡Œé”çš„ç®—æ³•ï¼Œç¬¬ä¸€ç§æ˜¯è®°å½•é”ï¼Œå¯¹å•ä¸ªè¡Œçš„ç´¢å¼•åŠ é”ï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½ä¿®æ”¹å’Œåˆ é™¤åŠ é”é¡¹ã€‚ç¬¬äºŒç§æ˜¯é—´éš™é”ï¼Œå°±æ˜¯ç´¢å¼•èŒƒå›´æŸ¥è¯¢æ—¶ï¼Œå°†è¯¥åŒºé—´é”ä½ï¼ˆä¸åŒ…æ‹¬é¦–å°¾ç´¢å¼•ï¼‰ï¼Œä¸èƒ½æ’å…¥åˆ é™¤å’Œä¿®æ”¹è¯¥åŒºé—´çš„å‘½ä»¤å°†è¢«é˜»å¡ï¼Œå¯ä»¥é¿å…å¹»è¯»ã€‚ç¬¬ä¸‰ç§æ˜¯ä¸´é”®é”ï¼Œæ˜¯è®°å½•é”å’Œé—´éš™é”çš„ç»„åˆï¼Œåªå­˜åœ¨ä¸éå”¯ä¸€ç´¢å¼•é¡¹ï¼Œå½“äº‹åŠ¡æŸ¥è¯¢è¯¥ç´¢å¼•åŒºé—´æ—¶ä¼šé”ä½å·¦å¼€å³é—­çš„åŒºé—´æ•°æ®ã€‚\n\n\nã€æ­»é”æ˜¯æ€ä¹ˆäº§ç”Ÿçš„ï¼Œå¦‚ä½•è§£å†³æ­»é”ï¼Ÿã€‘\nä¸¤ä¸ªæˆ–è€…å¤šä¸ªäº‹åŠ¡åœ¨åŒä¸€èµ„æºä¸Šäº’ç›¸å ç”¨ï¼Œå¹¶ä¸”è¯·æ±‚é”å®šå¯¹æ–¹çš„å ç”¨çš„èµ„æºå¯¼è‡´æ¶æ€§å¾ªç¯ï¼Œäº§ç”Ÿæ­»é”ã€‚\nInnoDBç›®å‰è§£å†³æ­»é”çš„æ–¹æ³•æ˜¯å°†æœ€å°‘è¡Œçº§æ’ä»–é”çš„äº‹åŠ¡è¿›è¡Œå›æ»šï¼Œç„¶åå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå†é‡æ–°æ‰§è¡Œå›æ»šçš„äº‹åŠ¡æ—¢å¯ã€‚\nå½“æ¶‰åŠè¡¨é”æ—¶InnoDBä¸èƒ½å®Œå…¨è‡ªåŠ¨æ£€æµ‹æ­»é”ï¼Œåˆ™ä¸ªæ—¶å€™å°±å¯ä»¥è®¾ç½®è¶…æ—¶ç­‰å¾…å‚æ•° innodb_lock_wait_timeout æ¥è§£å†³ã€‚\n\n\nã€innoDBæ˜¯å¦‚ä½•é¿å…æ­»é”çš„ï¼Ÿã€‘\n","categories":["javaé¢è¯•"],"tags":["mysql"]},{"title":"é¢è¯•ç³»åˆ—ä¹‹redis","url":"/2025/04/28/%E9%9D%A2%E8%AF%95%E7%B3%BB%E5%88%97%E4%B9%8BRedis/","content":"ä»‹ç»ï¼šredisæ˜¯ä¸€ç§æ— å…³ç³»å‹æ•°æ®åº“ï¼Œåœ¨é¡¹ç›®å’Œé¢è¯•ä¸­ç»å¸¸æåŠï¼Œæ­£å¥½å¼€å§‹ç³»ç»Ÿåœ°å­¦redisäº†ï¼Œä»Šå¤©æˆ‘ä»¬å°±ä»¥æ€»ç»“çš„æ–¹å¼å¼€å§‹javaé¢è¯•ä¹‹redisç¯‡ã€‚\n\n\n\n\nä¸€. æŒä¹…åŒ–\n\nï¼ˆ1ï¼‰Redis AOFä»‹ç»ï¼š AOF(append only file) æ˜¯ä¸€ç§åªè®°å½•å†™æ“ä½œçš„æ—¥å¿—ï¼Œrediså…ˆæ‰§è¡Œå‘½ä»¤å†è®°å½•æ—¥å¿—ï¼Œredisä¸ä¼šæ£€æŸ¥æ—¥å¿—ï¼Œå¦‚æœ.aofæ—¥å¿—å‡ºç°é—®é¢˜çš„è¯ï¼Œé€šå¸¸å¯ä»¥ç”¨redis-check-aof å‘½ä»¤è¿›è¡Œä¿®å¤ã€‚\n\n\n\nAOFä¸‰ç§å†™å›ç­–ç•¥\nåœ¨redisæ‰§è¡Œä¸€ä¸ªå†™å‘½ä»¤å®Œæˆåï¼Œå°±è®°å½•å†™æ—¥å¿—ï¼Œè¿™æ ·å¯¹redisçš„æ€§èƒ½ä¼šæœ‰è¾ƒå¤§çš„å½±å“ï¼Œå¦å¤–å¦‚æœè¿˜æ²¡æ¥å¾—åŠè®°å½•è®°æ—¥å¿—ï¼Œç³»ç»Ÿå°±å®•æœºäº†ï¼Œä¼šå¯¼è‡´æ•°æ®æ°¸ä¹…æ€§ä¸¢å¤±çš„é—®é¢˜ã€‚ä¸ºäº†è§£å†³ä»¥ä¸Šä¸¤ç§é—®é¢˜ï¼Œå¼•å…¥äº†AOFä¸‰ç§å†™å›ç­–ç•¥ï¼š\n\n\nalways: åŒæ­¥å†™å›everysec: å°†æ—¥å¿—å†™å…¥aofæ—¥å¿—ç¼“å†²åŒºï¼Œæ¯éš”ä¸€ç§’å†™å…¥ç£ç›˜æ–‡ä»¶ä¸­no: å°†æ—¥å¿—å†™å…¥aofæ—¥å¿—ç¼“å†²åŒºï¼Œç”±æ“ä½œç³»ç»Ÿå†³å®šä»€ä¹ˆæ—¶å€™å†™å…¥ç£ç›˜æ–‡ä»¶ä¸­\n\n\n\nä»¥ä¸Šä¸‰ç§ç­–ç•¥ noçš„æ€§èƒ½æœ€å¥½ï¼Œä½†æ˜¯å¯èƒ½å¤§é‡ä¸¢å¤±æ•°æ®ã€‚ alwayså¤§æ¦‚ç‡ä¸ä¼šä¸¢å¤±æ•°æ®ï¼Œä½†æ€§èƒ½è¾ƒå·®ï¼Œæ‰€ä»¥é€šå¸¸ä¼šè¿™ç§é‡‡å–everysecç­–ç•¥ã€‚\n\n\nAOFé‡å†™æœºåˆ¶\néšç€å†™æ“ä½œçš„æ•°é‡å¢å¤šï¼Œå ç”¨ç£ç›˜ç©ºé—´å¢å¤§ï¼Œä¸ºèŠ‚çœç£ç›˜ç©ºé—´ï¼Œå¯ä»¥é‡‡ç”¨AOFé‡å†™ï¼Œå³è¯»å–redisç°æœ‰çš„æ•°æ®ï¼Œæ ¹æ®æ•°æ®åˆ›å»ºå†™æ“ä½œçš„æ—¥å¿—ã€‚å¯ä»¥ä½¿ç”¨å‘½ä»¤ bgrewriteaof, å¯ä»¥åœ¨redis.confä¸­é…ç½®é‡å†™çš„ä¸´ç•Œæ¡ä»¶ï¼š\nauto-aof-rewrite-percentage 100auto-aof-rewrite-min-size 64mb\n\n\n\näº†è§£äº†é‡å†™çš„ç›®çš„ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹é‡å†™çš„æµç¨‹ï¼š\nbgrewriteaof å‘½ä»¤è¿›è¡Œé‡å†™ï¼Œå¦‚æœå½“å‰æœ‰é‡å†™æ­£åœ¨è¿›è¡Œå°±ç­‰å¾…ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œè¿™æ ·å°±ä¸ä¼šå¯¹ä¸»è¿›ç¨‹é€ æˆé˜»å¡ï¼Œå­è¿›ç¨‹å¾ªç¯éå†rediså†…å­˜æ•°æ®åˆ°ä¸´æ—¶æ–‡ä»¶ï¼Œåœ¨æ­¤æœŸé—´ï¼Œå®¢æˆ·ç«¯çš„å†™è¯·æ±‚ä¼šè®°å½•åˆ°aofç¼“å†²åŒºå’Œaofé‡å†™åŒºï¼Œç¡®ä¿åŸaofæ–‡ä»¶çš„å®Œæ•´å’Œæ–°çš„aofæ–‡ä»¶ç”ŸæˆæœŸé—´ä¸ä¼šæ¼æ‰å¢æ·»ä¿®æ”¹æ“ä½œï¼Œå­è¿›ç¨‹å†™å®Œæ–°çš„aofæ–‡ä»¶åå‘ä¸»è¿›ç¨‹å‘é€è¯·æ±‚ï¼Œä¸»è¿›ç¨‹æ¥æ”¶è¯·æ±‚åaofé‡å†™ç¼“å†²åŒºçš„æ•°æ®å†™å…¥æ–°çš„aofæ–‡ä»¶å¹¶ä¸”è¦†ç›–æ‰æ—§çš„aofæ–‡ä»¶ã€‚\n\n\nï¼ˆ2ï¼‰Redis RDBRDB(Redis Database)æ˜¯ä¸€ç§å†…å­˜å¿«ç…§ï¼Œè®°å½•å†…å­˜æŸä¸€æ—¶åˆ»çš„æ•°æ®çŠ¶æ€ã€‚ä½¿ç”¨å‘½ä»¤bgsaveï¼Œå³åœ¨ä¸»è¿›ç¨‹å¤–åˆåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œç”±è¿™ä¸ªå­è¿›ç¨‹æ¥å®ŒæˆRDBå¿«ç…§ï¼Œå‡å¦‚å†…å­˜å¿«ç…§æœ‰6GBçš„å†…å­˜æ•°æ®é‡ï¼Œéœ€è¦5sçš„æ—¶é—´æ¥å®ŒæˆRDBæ–‡ä»¶çš„å†™å…¥ï¼Œé‚£ä¹ˆåœ¨è¿™5så†…ï¼Œä»æ—§éœ€è¦å°†è¿™ä¸ªæ—¶é—´æ®µå†…çš„æ·»åŠ å’Œä¿®æ”¹æ•°æ®çš„æ“ä½œå†™å…¥åˆ°RDBæ–‡ä»¶ä¸­ï¼Œè¿™ä¸ªæ—¶å€™å°±ç”¨åˆ°å†™æ—¶å¤åˆ¶æŠ€æœ¯ï¼Œå¯¹äºå¢æ·»ä¿®æ”¹æ“ä½œæ˜¯é€šè¿‡å¤åˆ¶ä¸€ä¸ªå‰¯æœ¬ï¼Œå­è¿›ç¨‹å†æ‰§è¡Œï¼Œæ‰€ä»¥å­è¿›ç¨‹æ˜¯ä¸€è¾¹å†™å¿«ç…§ï¼Œä¸€éæ‰§è¡Œä¸»è¿›ç¨‹çš„æ“ä½œï¼Œä»è€Œé˜²æ­¢å¿«ç…§å¯¼å…¥RDBæ–‡ä»¶æ—¶æ•°æ®çš„ä¸¢å¤±ã€‚\n\n\nï¼ˆ3ï¼‰æ··åˆAOFå’ŒRDBredis.confä¸­æ‰“å¼€aofï¼Œæ‰“å¼€æ··åˆé…ç½®\nset k1 v1set k2 v2set k3 v3bgrewriteaofset k4 v4set k5 v5\n\nä»¥ä¸Šçš„æ‰§è¡Œç»“æœæ˜¯å‰ä¸‰æ¬¡æ“ä½œåçš„RDBå¿«ç…§æ˜¯aofæ–‡ä»¶çš„å‰ä¸€éƒ¨åˆ†ï¼Œåä¸¤ä¸ªæ“ä½œæ˜¯aofæ–‡ä»¶çš„åä¸€éƒ¨åˆ†ã€‚\nå¦‚æœæ•°æ®ä¸èƒ½ä¸¢å¤±ï¼Œä½¿ç”¨AOFå’ŒRDBæ··åˆæ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ã€‚\n\n\näºŒ. ä¸»ä»å¤åˆ¶\n\nç®€å•ç‚¹è¯´ï¼Œå°±æ˜¯ä¸»ä»åº“é‡‡ç”¨è¯»å†™åˆ†ç¦»çš„æ–¹å¼ï¼Œä¸»åº“è¿›è¡Œå†™æ“ä½œå¹¶å°†æ•°æ®åŒæ­¥ç»™ä»åº“ï¼Œä»åº“åªèƒ½è¿›è¡Œè¯»æ“ä½œã€‚\nè¿™æ ·æ¥æå‡è¯»å–çš„æ€§èƒ½ã€‚\n\n\nä¸»ä»åŒæ­¥åŸç†ï¼š\nç¬¬ä¸€é˜¶æ®µï¼š ä»åº“æ‰§è¡Œ replicaof å‘½ä»¤ï¼Œä¸»ä»åº“å»ºç«‹è¿æ¥ï¼Œä»åº“å‘ä¸»åº“å‘é€psyncæŒ‡ä»¤ï¼Œä¸»åº“è¿”å›ç»™ä»åº“å”¯ä¸€æ ‡è¯†runIDå’Œå¤åˆ¶è¿›åº¦offsetã€‚\nç¬¬äºŒé˜¶æ®µï¼šä¸»åº“å‘ä»åº“å‘é€rdbæ–‡ä»¶ï¼Œä»åº“æ¥æ”¶å¹¶åŠ è½½rdbæ–‡ä»¶\nç¬¬ä¸‰é˜¶æ®µï¼š å°†replication bufferå†…çš„æ•°æ®ï¼ˆå³rdbæ–‡ä»¶ç”Ÿæˆä¹‹åæ‰§è¡Œçš„å†™æ“ä½œï¼‰å‘é€ç»™ä»åº“ï¼Œä»åº“æ¥æ”¶å¹¶åŠ è½½ã€‚\n\n\n\nä¸Šé¢ä»‹ç»äº†ä¸»ä»åŒæ­¥éƒ¨åˆ†ï¼Œé‚£å¦‚æœåªæœ‰ä¸€ä¸ªä¸»åº“çš„è¯ï¼Œä»åº“å¤šäº†ï¼Œä¸»åº“åŒæ­¥ç»™ä»åº“çš„å‹åŠ›å°±ä¼šå¢å¤§ã€‚è¿™ä¸ªæ—¶å€™å°±ç”¨åˆ°ä¸»ä»ä»æ¨¡å¼äº†ï¼Œå³åœ¨ä¸»ä»æ¨¡å¼çš„åŸºç¡€ä¸Šï¼Œä»åº“ä¸åœ¨replicaofåˆ°ä¸»åº“ï¼Œè€Œæ˜¯replicaofåˆ°å…¶ä»–ä»åº“ï¼Œä»è€Œè®©ä»åº“åˆ†æ‹…æ•°æ®åŒæ­¥çš„å‹åŠ›ã€‚\n\n\nè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœåŒæ­¥è¿‡ç¨‹ä¸­ç½‘ç»œå¼‚å¸¸ï¼Œå†æ¬¡è¿æ¥å¯¼è‡´æ•°æ®ä¸¢å¤±æ€ä¹ˆåŠï¼Ÿredisé‡‡ç”¨repl_backlog_bufferç¼“å†²åŒºè®°å½•ä¸»åº“å†™åˆ°çš„ä½ç½®å’Œä»åº“è¯»åˆ°çš„ä½ç½®ã€‚è¿™æ ·å†æ¬¡è¿æ¥æ—¶ï¼Œå¦‚æœä»åº“è¯»åˆ°çš„ä½ç½®è½åäºä¸»åº“å†™åˆ°çš„ä½ç½®ï¼Œå°±ä¼šä»åº“ç»§ç»­è¯»å–ç›´è‡³ä¸åè€…ç›¸åŒã€‚\nç¼“å†²ç©ºé—´å¤§å°&#x3D;ä¸»åº“å†™å…¥é€Ÿåº¦ * æ“ä½œå¤§å°-ä¸»ä»åº“ç½‘ç»œä¼ è¾“é€Ÿåº¦ * æ“ä½œå¤§å°\nrepl_backlog_size&#x3D;ç¼“å†²ç©ºé—´å¤§å°*2\n\n\n\n\nä¸‰. å“¨å…µæ¨¡å¼\n\nä¸‹é¢æ˜¯æ¯”è¾ƒç®€å•çš„å“¨å…µé›†ç¾¤çš„æ•ˆæœå›¾ï¼š\n\n\n\n\næˆ‘ä»¬åœ¨è™šæ‹Ÿæœºçš„centosè¿™ä¸€ä¸ªæ“ä½œç³»ç»Ÿæ¨¡æ‹Ÿå“¨å…µé›†ç¾¤ï¼š ç”¨redis-serveræ¥å¯åŠ¨ä¸åŒæ¥å£çš„redisæœåŠ¡ï¼Œè®¾ç½®ä¸€ä¸»äºŒä»çš„å…³ç³»ï¼Œåœ¨ä»¥redis-sentinelå¯åŠ¨ä¸‰ä¸ªå“¨å…µï¼Œå“¨å…µçš„é…ç½®å¦‚ä¸‹ï¼š\n// ç«¯å£port 26379// ç›‘è§†  æ ¼å¼ï¼šsentinel monitor &lt;è‡ªå®šä¹‰çš„reidsä¸»èŠ‚ç‚¹åç§°&gt; &lt;IP&gt; &lt;port&gt; &lt;æ•°é‡&gt;sentinel monitor mymaster 127.0.0.1 6379 1// ä¸»èŠ‚ç‚¹å¤šå°‘æ¯«ç§’æœªåº”ç­”ï¼Œåˆ™ä¸‹çº¿sentinel down-after-milliseconds mymaster 30000\n\n\n\nï¼ˆ1ï¼‰ è”ç³»å¥½ï¼Œç°åœ¨åŸºæœ¬çš„æœåŠ¡éƒ½å¯åŠ¨äº†ï¼Œé‚£ä¹ˆæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ¯ä¸ªå“¨å…µéƒ½ç›‘è§†ä¸»åº“ï¼Œé‚£å“¨å…µæ˜¯å¦‚ä½•çŸ¥é“å½¼æ­¤çš„ï¼Ÿå“¨å…µåˆæ˜¯å¦‚ä½•ç›‘è§†ä»åº“çš„ï¼Ÿ\n\næ˜¯é€šè¿‡redisçš„pub&#x2F;subå‘å¸ƒè®¢é˜…æœºåˆ¶å®ç°å“¨å…µçš„è”ç³»ï¼Œä¸»åº“masteræœ‰ä¸€æ¡_sentinel__:helloçš„ä¸“ç”¨é€šé“ï¼Œç”¨äºå“¨å…µä¹‹é—´è®¢é˜…å‘é€æ¶ˆæ¯ã€‚å°±å¥½åƒæ˜¯masterå»ºäº†ä¸€ä¸ªå¾®ä¿¡ç¾¤ï¼Œå“¨å…µå¯ä»¥å‘é€æ¶ˆæ¯ï¼Œå¯ä»¥çœ‹åˆ°å…¶ä»–å“¨å…µçš„æ¶ˆæ¯ã€‚\n\nå“¨å…µå‘ä¸»åº“masterå‘é€infoå‘½ä»¤ï¼Œä¸»åº“å°†ä»åº“åˆ—è¡¨è¿”å›ç»™å“¨å…µï¼Œå“¨å…µå’Œä»åº“å»ºç«‹å’Œä»åº“å»ºç«‹è¿æ¥ï¼Œç›‘è§†ä»åº“ã€‚\n\n\nï¼ˆ2ï¼‰è¿è¡Œä»‹ç»å®Œè”ç³»ä¹‹åçœ‹çœ‹å¦‚æœä¸»åº“å®•æœºï¼Œå“¨å…µé›†ç¾¤å¦‚ä½•åˆ¤æ–­ä¸»åº“å®•æœºçš„ï¼Ÿæ˜¯å¦‚ä½•é€‰å–æ–°çš„ä¸»åº“çš„ï¼Ÿ\nåˆ¤æ–­ä¸»åº“å®•æœºå’Œé€‰å–æ–°çš„ä¸»åº“çš„è¿‡ç¨‹éƒ½è®¾è®¡åˆ°å“¨å…µå°‘æ•°æœä»å¤šæ•°çš„åŸåˆ™ï¼Œæ‰€ä»¥å“¨å…µçš„æ•°é‡åº”è¯¥æ˜¯å¥‡æ•°æ›´åˆé€‚ï¼Œä¸»åº“è¢«å“¨å…µé›†ç¾¤ç›‘æ§ï¼Œå¤šæ•°å“¨å…µåˆ¤æ–­ä¸»åº“ä¸‹çº¿äº†ï¼Œé‚£è®¤ä¸ºä¸»åº“å®•æœºäº†ï¼Œè¿™ä¸ªæ—¶å€™è¦é€‰å–æ–°çš„ä¸»åº“ï¼Œé‚£ç”±é‚£ä¸ªå“¨å…µæ¥è¿›è¡Œå‘¢ï¼Œè¿™ä¸ªæ—¶å€™ä¾æ—§æ˜¯å°‘æ•°æœä»å¤šæ•°ï¼Œå¾—åˆ°å¤šæ•°æŠ•ç¥¨çš„é‚£ä¸ªå“¨å…µæ¥é€‰å–æ–°çš„ä¸»åº“ï¼Œé€‰å–æ–°çš„ä¸»åº“æœ‰ä¸‰ä¸ªç­›é€‰æ¡ä»¶ï¼Œä¸€æ˜¯é€‰å–æ¯ä¸ªä»åº“é…ç½®ä¸­ä¼˜å…ˆçº§æœ€å¤§çš„é‚£ä¸ªï¼Œè¿™é€šå¸¸æ„å‘³ç€è¿™ä¸ªä»åº“çš„é…ç½®æ›´é«˜ï¼Œå†…å­˜æ›´å¤§ã€‚äºŒæ˜¯é€‰å–repl_backlog_bufferç¼“å†²åŒºä¸­å’Œä¸»åº“å†™æ“ä½œçš„ä½ç½®æœ€æ¥è¿‘çš„é‚£ä¸ªä»åº“ã€‚ä¸‰æ˜¯æ¯ä¸ªrediså®ä¾‹éƒ½æœ‰ä¸€ä¸ªid,é€‰æ‹©idæœ€å°çš„ã€‚\n\n\n\n\n\n\nå››. åˆ†ç‰‡é›†ç¾¤\n\nï¼ˆ1ï¼‰é…ç½®æˆ‘ä»¬ä¾æ—§åœ¨åŒä¸€ä¸ªè™šæ‹Ÿä¸»æœºå®Œæˆï¼Œredis-serverå¯åŠ¨å…­ä¸ªæ¥å£çš„redisæœåŠ¡, é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š\ninclude redis.confpidfile &quot;/var/run/redis_6379.pid&quot;port 6379dbfilename &quot;dump6379.rdb&quot;# æ‰“å¼€é›†ç¾¤æ¨¡å¼cluster-enabled yes# è®¾å®šèŠ‚ç‚¹é…ç½®æ–‡ä»¶cluster-config-file nodes-6379.conf# è®¾ç½®èŠ‚ç‚¹å¤±è”æ—¶é—´ï¼Œè¶…è¿‡ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œä¸»ä»åˆ‡æ¢cluster-node-timeout 15000\n\nä¿®æ”¹redis.confæ–‡ä»¶ï¼š\nbind 127.0.0.1 192.168.230.30(è™šæ‹Ÿä¸»æœºip)\n\nå…­ä¸ªæœåŠ¡å¯åŠ¨\nå…­ä¸ªæœåŠ¡åˆæˆä¸€ä¸ªé›†ç¾¤ï¼š\nredis-cli --cluster create --cluster-replicas 1 192.168.230.30:6379192.168.230.30:6380 192.168.230.30:6381 192.168.230.30:6579 192.168.230.30:6580192.168.230.30:6581// --cluster create: hash slotå¹³å‡åˆ†é…åˆ°å®ä¾‹ä¸­// --cluster-replicas 1: ä¸»ä»æ¯”ä¾‹1:1\n\n\n\nï¼ˆ2ï¼‰åŸç†ä»¥åŠå¸¸ç”¨å‘½ä»¤ä¸€ä¸ªåˆ†ç‰‡é›†ç¾¤æœ‰16384ä¸ªæ§½ï¼Œæˆ‘ä»¬å‘é›†ç¾¤ä¸­å­˜å‚¨é”®å€¼å¯¹çš„æ—¶å€™ï¼Œæ ¹æ®é”®å€¼å¯¹çš„key, æŒ‰ç…§CRC16ç®—æ³•è®¡ç®—å‡ºä¸€ä¸ª16bitçš„å€¼ï¼Œç”¨è¿™ä¸ªå€¼å¯¹16384å–æ¨¡è¿ç®—ï¼Œå¾—åˆ°çš„æ•°ä»£è¡¨å¯¹åº”çš„ç¼–å·çš„å“ˆå¸Œæ§½hash slotã€‚\n\n\nredis-cli -c -p 6379// å››å¤§æ•°æ®ç±»å‹ï¼Œbitmap,HyperLogLog æ“ä½œcluster nodes // æ˜¾ç¤ºé›†ç¾¤å„ä¸ªèŠ‚ç‚¹ä¿¡æ¯cluster keyslot &lt;key&gt;cluster countkeyinslot &lt;slot&gt;cluster getkeysinslot &lt;slot&gt; &lt;count&gt;\n\n\n\nå› ä¸ºä¸»ä»æ¯”ä¾‹ä¸º1:1ï¼Œæ‰€ä»¥å¦‚æœå…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹çš„ä¸»åº“å®•æœºï¼Œä»åº“å°±ä¼šæ¥æ‰‹ï¼Œå½“å¦‚æœè¯¥èŠ‚ç‚¹ä¸»ä»åº“å…¨éƒ¨å®•æœºçš„è¯ï¼Œé»˜è®¤æ•´ä¸ªé›†ç¾¤éƒ½æŒ‚æ‰ã€‚é»˜è®¤é…ç½®ï¼š\ncluster-require-full-coverage yes\n\nå¦‚æœé…ç½®ä¸ºnoçš„è¯ï¼Œåªæœ‰è¯¥èŠ‚ç‚¹ä¸å¯å­˜å–æ•°æ®ï¼Œæ•´ä¸ªé›†ç¾¤ä¸ä¼šæŒ‚æ‰ã€‚\n\n\n\n\näº”. Geospatial\n\né€šå¸¸ç”¨äºè¡¨ç¤ºåæ ‡ç›¸å…³æ•°æ®ï¼Œå¯ä»¥è®¡ç®—åæ ‡è·ç¦»å‘€ï¼Œä¸€ä¸ªåæ ‡èŒƒå›´å†…çš„å…¶ä»–åæ ‡å‘€ï¼Œå¯ä»¥çœ‹åšæ˜¯redisç¬¬å…­ç§æ•°æ®ç»“æ„äº†ï¼ŒåŸºäºzsetæœ‰åºé›†åˆï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯å®ƒçš„åˆ†æ•°æ˜¯ç”±åæ ‡è®¡ç®—è€Œæ¥ã€‚\n\n\nï¼ˆ1ï¼‰geoåŸç†geoæ˜¯å¦‚ä½•æ ¹æ®åæ ‡è®¡ç®—åˆ†æ•°çš„ï¼Ÿç­”æ¡ˆä¾¿æ˜¯GEOHashç¼–ç ï¼Œå°†ç»çº¬åº¦åˆ†åˆ«è¿›è¡Œç¼–ç ï¼Œå†äº¤å‰åˆå¹¶ï¼Œåˆå¹¶çš„å€¼ä½œä¸ºgeoå…ƒç´ çš„æƒé‡ã€‚  \n\n\n\nç»çº¬åº¦ç¼–ç ï¼šåšNæ¬¡äºŒåˆ†åŒºï¼Œæ¯”å¦‚ç»åº¦ä¸º135ï¼Œåšç¬¬ä¸€æ¬¡äºŒåˆ†åŒºï¼Œåˆ¤æ–­æ˜¯ä½äº[-180, 0)è¿˜æ˜¯[0, 180], å·¦åˆ†åŒºç”¨0è¡¨ç¤ºï¼Œå³åˆ†åŒºç”¨1è¡¨ç¤ºï¼Œ135ä½äºå³åˆ†åŒºï¼Œç”¨1è¡¨ç¤ºï¼Œæ‰€ä»¥æœ€åè·å¾—äº†Nä½0æˆ–1ç»„æˆçš„ç¼–ç ã€‚\n\näº¤å‰åˆå¹¶: åˆå¹¶çš„ç»“æœç¬¬ä¸€ä½æ˜¯ç»åº¦ç¼–ç çš„ç¬¬ä¸€ä½ï¼Œç»“æœçš„ç¬¬äºŒä½æ˜¯çº¬åº¦ç¼–ç çš„ç¬¬ä¸€ä½ï¼Œå°±è¿™æ ·ç»çº¬åº¦äº¤å‰è¿›è¡Œã€‚\n\n\nï¼ˆ2ï¼‰geoåº”ç”¨\nè®¡ç®—ä¸¤ä¸ªä½ç½®çš„è·ç¦»\ngeodist key member1 member2\n\n\n\nè·å–é™„è¿‘çš„geoå…ƒç´ \nå¦‚è·å–è·ç¦»è‡ªå·±500mä»¥å†…çš„å¥³ç¥å§“åï¼š\ngeoradius key è‡ªå·±ä½ç½®ä¿¡æ¯ 500 m [ASC|DESC] [count number]\n\nå¯ä»¥ç†è§£ä¸ºå°†äºŒç»´ä½ç½®æ˜ å°„åˆ°ä¸€ç»´çš„çº¿ä¸Šï¼Œè·ç¦»è¾ƒè¿‘çš„ä¸¤ä¸ªç‚¹ï¼Œå®é™…è·ç¦»ä¹Ÿæ˜¯æ¯”è¾ƒè¿‘çš„ã€‚\n\n\n\n\nå…­. äº‹åŠ¡\n\nredisäº‹åŠ¡åˆ†ä¸ºåŸå­æ€§ï¼Œä¸€è‡´æ€§ï¼Œéš”ç¦»æ€§å’ŒæŒä¹…æ€§ã€‚\n\n\n\nåŸå­æ€§ï¼šäº‹åŠ¡ä¸­æ‰€æœ‰çš„æŒ‡ä»¤è¦ä¹ˆéƒ½æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œã€‚\nå¯ä»¥æ ¹æ®é”™è¯¯çš„å‘ç”Ÿæ—¶æœºåˆ†ä¸ºEXECå‘½ä»¤æ‰§è¡Œå‰æŠ¥é”™ï¼Œæ‰§è¡Œæ—¶å‘ç”Ÿæ•…éšœï¼Œæ‰§è¡ŒåæŠ¥é”™è¿™ä¸‰ç§æƒ…å†µæ¥è®¨è®ºï¼Œåœ¨é”™è¯¯å‘½ä»¤å…¥é˜Ÿæ—¶ï¼Œrediså°±ä¼šæŠ¥é”™å¹¶è®°å½•è¿™ä¸ªé”™è¯¯ï¼Œå…¶ä»–å‘½ä»¤è¿˜èƒ½æ¥ç€å…¥é˜Ÿï¼Œåˆ°æ‰§è¡ŒEXECå‘½ä»¤æ—¶ï¼Œå°±ä¼šæŠ¥é”™ï¼Œæ•´ä¸ªäº‹åŠ¡å°±ä¸èƒ½æ‰§è¡Œã€‚å¦‚æœEXECå‘½ä»¤æ‰§è¡Œå‰æ²¡æŠ¥é”™ï¼Œæ‰§è¡Œæ—¶å‘ç”Ÿæ•…éšœï¼Œåªæœ‰éƒ¨åˆ†äº‹åŠ¡è®°å½•åˆ°AOFæ—¥å¿—æ–‡ä»¶ä¸­ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨redis-check-aofå·¥å…·å°†æœªå®Œæˆçš„äº‹åŠ¡ä»æ—¥å¿—ä¸­åˆ é™¤ï¼Œä»è€Œä¿è¯åŸå­æ€§ã€‚å¦‚æœå‰ä¸¤è€…éƒ½æ²¡é—®é¢˜ï¼Œåˆ°äº†æ‰§è¡ŒåæŠ¥é”™ï¼Œé‚£è¿™ä¸ªæ—¶å€™å¤§å¤šæ•°éƒ½æ˜¯äº‹åŠ¡ä¸­æ‰§è¡Œçš„æŒ‡ä»¤ä¸€èˆ¬éƒ½å’Œæ“ä½œç±»å‹ä¸åŒ¹é…æ‰å¯¼è‡´æŠ¥é”™ï¼Œæ­£ç¡®çš„æŒ‡ä»¤èƒ½æ‰§è¡Œï¼Œé”™è¯¯çš„æŒ‡ä»¤æ— æ³•æ‰§è¡Œï¼Œå› ä¸ºredisä¸æ”¯æŒå›æ»šï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™å°±æ— æ³•ä¿è¯åŸå­æ€§äº†ã€‚\n\n\nä¸€è‡´æ€§ï¼šäº‹åŠ¡æ‰§è¡Œå‰åï¼Œæ•°æ®åº“çŠ¶æ€ä¿æŒä¸€è‡´ï¼Œç¬¦åˆé¢„æœŸçš„è§„åˆ™å’Œçº¦æŸï¼Œæ¯”å¦‚è¯´ä¸»å¤–é”®å…³è”ï¼Œå®Œæ•´æ€§çº¦æŸç­‰ä¸€äº›æ•°æ®åº“å†…éƒ¨è§„åˆ™ä¸èƒ½è¢«ç ´åã€‚\næ‰§è¡Œå‰ï¼Œå…¥é˜ŸæŠ¥é”™ï¼Œäº‹åŠ¡ä¸æ‰§è¡Œï¼Œèƒ½ç¡®ä¿ä¸€è‡´æ€§ã€‚æ‰§è¡Œæ—¶æ•…éšœï¼Œä¸€è‡´æ€§å’Œæ•°æ®æ¢å¤æ–¹å¼æœ‰å…³ï¼šå¦‚æœåªå¼€å¯RDBå¿«ç…§ï¼Œäº‹åŠ¡æ“ä½œçš„ç»“æœæ²¡æœ‰è¢«ä¿å­˜åˆ°å¿«ç…§ä¸­ï¼Œå®ä¾‹é‡å¯æ—¶ï¼Œæ•°æ®æ˜¯ä¸€è‡´çš„ã€‚å¦‚æœå¼€å¯äº†RDBå’ŒAOFæ—¥å¿—ï¼Œéƒ¨åˆ†æ“ä½œè¢«è®°å½•åˆ°AOFæ—¥å¿—ä¸­ï¼Œå¯ä»¥ä½¿ç”¨redis-check-aofæ¸…é™¤äº‹åŠ¡ä¸­å·²ç»å®Œæˆçš„æ“ä½œä¿è¯äº‹åŠ¡çš„åŸå­æ€§ï¼Œä»è€Œä¿è¯äº†ä¸€è‡´æ€§ã€‚å¦‚æœEXECå‘½ä»¤æ‰§è¡ŒåæŠ¥é”™ï¼Œæ­£ç¡®çš„æŒ‡ä»¤å·²ç»æ‰§è¡Œï¼Œé”™è¯¯çš„æŒ‡ä»¤æ²¡æœ‰æ‰§è¡Œï¼Œå¯ä»¥ä¿è¯ä¸€è‡´æ€§ã€‚\n\n\néš”ç¦»æ€§ï¼šå¤šä¸ªäº‹åŠ¡å¹¶è¡Œæ‰§è¡Œæ—¶ï¼Œäº’ä¸å¹²æ‰°ã€‚\nå¹¶å‘æ“ä½œåœ¨EXECå‘½ä»¤æ‰§è¡Œå‰æ‰§è¡Œï¼Œéœ€è¦é€šè¿‡WATCHæœºåˆ¶è¿›è¡Œä¿è¯ï¼ŒWATCHæœºåˆ¶çš„ä½œç”¨æ˜¯ç›‘è§†è¯¥äº‹åŠ¡æ“ä½œçš„ä¸€ä¸ªæˆ–å¤šä¸ªé”®æ˜¯å¦è¢«å…¶ä»–äº‹åŠ¡ä¿®æ”¹ï¼Œå¦‚æœè¢«ä¿®æ”¹ï¼Œå°±æ”¾å¼ƒæ‰§è¡Œè¯¥äº‹åŠ¡ä»è€Œä¿è¯äº‹åŠ¡çš„éš”ç¦»æ€§ã€‚å¹¶å‘æ“ä½œåœ¨EXECå‘½ä»¤æ‰§è¡Œåæ‰§è¡Œä¸ä¼šç ´åäº‹åŠ¡çš„éš”ç¦»æ€§ï¼Œå› ä¸ºredisä½¿ç”¨å•çº¿ç¨‹æ‰§è¡Œå‘½ä»¤ï¼Œè€Œä¸”æ‰§è¡Œå®Œå‘½ä»¤ï¼Œå®ƒè¿˜ä¼šä¿è¯å‰ä¸€ä¸ªäº‹åŠ¡çš„æ‰€æœ‰å‘½ä»¤æ‰§è¡Œå®Œä¹‹åæ‰ä¼šæ‰§è¡Œä¹‹åçš„äº‹åŠ¡ã€‚\n\n\næŒä¹…æ€§ï¼š\næ²¡æœ‰ä½¿ç”¨RDBå’ŒAOFï¼Œæ•°æ®ä¸¢å¤±\nåªä½¿ç”¨RDBå¿«ç…§ï¼Œé‚£ä¹ˆåœ¨äº‹åŠ¡æ‰§è¡Œä¹‹åï¼Œå¿«ç…§æ‰§è¡Œä¹‹å‰å‘ç”Ÿå®•æœºï¼Œä¹Ÿä¼šæ•°æ®ä¸¢å¤±ï¼Œé‡‡ç”¨äº†RDBå’ŒAOFï¼ŒAOFçš„ä¸‰ç§é…ç½®é€‰é¡¹no, everysecå’Œalwaysä¹Ÿä¼šå‡ºç°æ•°æ®ä¸¢å¤±çš„æƒ…å†µï¼Œæ‰€ä»¥äº‹åŠ¡çš„æŒä¹…æ€§ä¸èƒ½ä¿è¯ã€‚\n\n\n\n\nredisçš„äº‹åŠ¡å¯ä»¥ä¿è¯ä¸€è‡´æ€§å’Œéš”ç¦»æ€§ï¼Œå…·å¤‡ä¸€å®šçš„åŸå­æ€§ä½†ä¸æ”¯æŒå›æ»šï¼Œæ— æ³•ä¿è¯æŒä¹…æ€§ã€‚\n\n\n\n\nä¸ƒ. ç¼“å­˜redisç¼“å­˜å±äºæ—è·¯å‹ç¼“å­˜ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æƒ…å†µï¼šç¼“å­˜å‘½ä¸­å’Œç¼“å­˜ç¼ºå¤±ï¼Œä¸¤ç§ç±»å‹ï¼šåªè¯»ç¼“å­˜å’Œè¯»å†™ç¼“å­˜ã€‚\nè¯»å–æ•°æ®æ—¶å¦‚æœç¼“å­˜å‘½ä¸­ï¼Œç›´æ¥è¿”å›ï¼Œå¦‚æœç¼“å­˜ç¼ºå¤±ï¼Œå‘æ•°æ®åº“è®¿é—®ï¼Œå¹¶åˆ·æ–°ç¼“å­˜ã€‚å‘ç¼“å­˜å†™æ•°æ®æ—¶ï¼Œç¼“å­˜å°†æ•°æ®åˆ·æ–°ç»™æ•°æ®åº“æ—¶å¯ä»¥åŒæ­¥ç›´å†™ï¼Œä¹Ÿå¯ä»¥å¼‚æ­¥å†™å›ã€‚\n\n\nï¼ˆ1ï¼‰ç¼“å­˜æ•°æ®çš„åˆ é™¤\nåˆ é™¤ç­–ç•¥\n\nç¼“å­˜æ•°æ®çš„åˆ é™¤å¤§å¤šæƒ…å†µä¸‹éƒ½æ˜¯è¿‡æœŸæ•°æ®çš„åˆ é™¤ï¼Œredisä¸­åˆ é™¤è¿‡æœŸæ•°æ®æœ‰ä¸¤ç§ç­–ç•¥ï¼šæƒ°æ€§åˆ é™¤å’Œå®šæœŸåˆ é™¤ã€‚æƒ°æ€§åˆ é™¤æ˜¯æ•°æ®è¿‡æœŸäº†ï¼Œå½“å†æ¬¡è®¿é—®è¯¥æ•°æ®æ—¶ä½¿ç”¨å†…éƒ¨å‡½æ•°expirelfNeededè¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœè¿‡æœŸï¼Œè¿›è¡Œåˆ é™¤ï¼ŒèŠ‚çº¦CPUèµ„æºä½†å†…å­˜å ç”¨å¤§ã€‚å®šæœŸåˆ é™¤æ˜¯æ¯éš”ä¸€æ®µæ—¶é—´è°ƒç”¨å‡½æ•°æŠ½å–20ä¸ªkeyè¿›è¡Œæ£€æµ‹ï¼Œåˆ é™¤è¿‡æœŸçš„keyï¼Œå¦‚æœè¿‡æœŸçš„keyçš„æ•°é‡å¤§äº25%ï¼Œé‚£å°±å¾ªç¯æ‰§è¡Œï¼Œæœ€å¤šæ‰§è¡ŒNæ¬¡ï¼Œè¿™ä¸ªNæ˜¯å¯ä»¥è®¾ç½®çš„ã€‚\n\n\n\næ·˜æ±°ç­–ç•¥\n\né‚£ä¹ˆå½“ç¼“å­˜çš„æ•°æ®è¶…è¿‡ç¼“å­˜çš„å®¹é‡æ—¶ï¼Œè¯¥å¦‚ä½•æ˜¯å¥½ï¼Ÿè¿™ä¸ªæ—¶å€™å°±è¦ç”¨åˆ°é€å‡ºç®—æ³•äº†ï¼Œåˆ¶å®šç¼“å­˜æ·˜æ±°ç­–ç•¥ã€‚\n\n\né’ˆå¯¹è¿‡æœŸæ•°æ®çš„æ·˜æ±°ç­–ç•¥æœ‰å››ç§ï¼š\nvalotile-ttl : æŒ‰ç…§è¿‡æœŸæ—¶é—´çš„å…ˆåé¡ºåºåˆ é™¤\nvalotile-random: éšæœºåˆ é™¤\nvalotile-lru: ä½¿ç”¨LRUç®—æ³•ç­›é€‰è¿‡æœŸçš„é”®å€¼å¯¹åˆ é™¤\nvalotile-lfu: ä½¿ç”¨LFUç®—æ³•ç­›é€‰è¿‡æœŸçš„é”®å€¼å¯¹åˆ é™¤\n\n\né’ˆå¯¹æ‰€æœ‰æ•°æ®æœ‰ä¸‰ç§ï¼šallkeys-random   allkeys-lru   allkeys-lfu\n\n\nLRUç®—æ³•æ˜¯å°†æœ€è¿‘ä¸ç”¨çš„æ•°æ®ç­›é€‰å‡ºæ¥ã€‚éœ€è¦ç»´æŠ¤ä¸€ä¸ªé“¾è¡¨æ¥ç®¡ç†æ‰€æœ‰çš„ç¼“å­˜æ•°æ®ï¼Œæ•°æ®è¢«è®¿é—®æ—¶ï¼Œæ‰§è¡Œé“¾è¡¨æ•°æ®çš„ç§»åŠ¨ï¼Œåˆ©ç”¨é“¾è¡¨çš„é¡ºåºç­›åºå‡ºNä¸ªæ•°æ®ï¼Œå†å°†æœ€å°çš„æ•°æ®æ·˜æ±°ã€‚\nLFUç®—æ³•æ˜¯å°†ä½¿ç”¨é¢‘ç‡æœ€å°çš„æ•°æ®ç­›é€‰å‡ºæ¥ã€‚æ¯ä¸ªæ•°æ®å—éƒ½æœ‰ä¸€ä¸ªå¼•ç”¨è®¡æ•°ï¼Œç»´æŠ¤ä¸€ä¸ªé˜Ÿåˆ—å°†æ•°æ®å—è¿›è¡Œæ’åºï¼Œæ·˜æ±°æ•°æ®æ—¶ï¼ŒæŠŠé˜Ÿåˆ—å°¾éƒ¨çš„æ•°æ®å—åˆ é™¤ã€‚\n\n\nè¿‡æœŸæ•°æ®æ·˜æ±°æ˜¯æ ¹æ®å…·ä½“æƒ…å†µé€‰ç”¨ï¼Œæ‰€æœ‰æ•°æ®æ·˜æ±°ä¸€èˆ¬æƒ…å†µä¸‹ç”¨allkeys-lruç­–ç•¥ï¼Œå¦‚æœæ•°æ®çš„ä½¿ç”¨é¢‘ç‡ç›¸å·®ä¸å¤§ï¼Œä¹Ÿå¯ä»¥ç”¨allkeys-randomç­–ç•¥ã€‚\n\n\nï¼ˆ2ï¼‰ç¼“å­˜å¼‚å¸¸\næ•°æ®ä¸ä¸€è‡´ï¼š\nå°±æ˜¯æ•°æ®æ›´æ–°ï¼Œè¯»å–åˆ°çš„ä¾ç„¶æ˜¯æ—§å€¼ã€‚é€šå¸¸æ˜¯ç”±ä¸¤ç§æƒ…å†µå¯¼è‡´ï¼Œä¸€ç§æ˜¯ç¼“å­˜åˆ é™¤äº†ï¼Œä½†æ˜¯æ•°æ®æ›´æ–°å¤±è´¥ï¼Œä¸€ç§æ˜¯æ•°æ®æ›´æ–°æˆåŠŸï¼Œä½†æ˜¯ç¼“å­˜åˆ é™¤å¤±è´¥ã€‚\nè§£å†³æ–¹æ¡ˆï¼šå°±æ˜¯åˆ©ç”¨é‡è¯•æœºåˆ¶ï¼ŒæŠŠè¦åˆ é™¤çš„ç¼“å­˜å€¼æˆ–è€…æ›´æ–°æ•°æ®åº“å€¼å…ˆå­˜å‚¨åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œå‡ºç°æ•°æ®ä¸ä¸€è‡´ï¼Œå°±é‡è¯•ã€‚\n\n\nå¦‚æœæ˜¯å¤šçº¿ç¨‹è®¿é—®ï¼Œåˆ†ä¸ºä¸¤ç§æƒ…å†µè®¨è®ºï¼Œå¦‚æœæ˜¯å…ˆåˆ é™¤ç¼“å­˜ï¼Œåæ›´æ–°æ•°æ®ï¼Œé‚£ä¹ˆä¸€ä¸ªç¼“å­˜åœ¨æ‰§è¡Œåˆ°æ•°æ®æ›´æ–°çš„è¿‡ç¨‹ä¸­ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹è®¿é—®æ•°æ®æ‹¿åˆ°çš„ä¾ç„¶æ˜¯æ—§å€¼ï¼Œå¹¶ä¸”è¿˜ä¼šåˆ·æ–°ç¼“å­˜ï¼Œå°±ä¸‹æ¥çš„å…¶ä»–æ‰€æœ‰çº¿ç¨‹æ‹¿åˆ°çš„éƒ½æ˜¯æ—§æ•°æ®ã€‚ä¸ºäº†é¿å…åç»­çš„çº¿ç¨‹æ‹¿åˆ°çš„éƒ½æ˜¯æ—§æ•°æ®ï¼Œå°±ä¼šç”¨åˆ°å»¶è¿ŸåŒåˆ ï¼Œè¿™ä¸ªå»¶è¿ŸåŒåˆ å…¶å®å°±æ˜¯çº¿ç¨‹æ‰§è¡Œå®Œåˆ é™¤ç¼“å­˜å’Œæ›´æ–°æ•°æ®ä¹‹åï¼Œä¼‘çœ ä¸€æ®µæ—¶é—´ï¼Œä¼‘çœ ç»“æŸå°±å†æ¬¡åˆ é™¤ç¼“å­˜ï¼Œè¿™æ ·ä¹‹åçš„å…¶ä»–çº¿ç¨‹è®¿é—®æ•°æ®æ—¶ï¼Œæ‹¿åˆ°çš„å°±æ˜¯æ–°å€¼ã€‚å¦‚æœæ˜¯ç¬¬äºŒç§æƒ…å†µï¼Œå…ˆæ›´æ–°æ•°æ®ï¼Œå†åˆ é™¤ç¼“å­˜ï¼Œé‚£ä¹ˆåœ¨çº¿ç¨‹æ›´æ–°æ•°æ®è¿™ä¸€æ—¶é—´å†…ï¼Œå…¶ä»–çº¿ç¨‹æ‹¿åˆ°çš„æ˜¯æ—§æ•°æ®ï¼Œæ›´æ–°å¹¶ä¸”åˆ é™¤ç¼“å­˜å®Œæˆåçš„å…¶ä»–çº¿ç¨‹æ‹¿åˆ°çš„æ˜¯æ–°æ•°æ®ã€‚\n\n\n\n\nç¼“å­˜å‡»ç©¿\nè¦è¯»å–çš„æ•°æ®åœ¨æ•°æ®åº“ä¸­å­˜åœ¨ï¼Œåœ¨ç¼“å­˜ä¸­å·²ç»è¿‡æœŸï¼Œä»æ•°æ®åº“è¯»å–çš„æ•°æ®åˆ·æ–°åˆ°ç¼“å­˜ä¸­ï¼Œè¿™ç§æƒ…å†µå«åšç¼“å­˜å‡»ç©¿ã€‚\n\n\né‚£ä¹ˆå¦‚æœå¤§é‡æ•°æ®åŒæ—¶è¿‡æœŸï¼Œè¿™äº›æ•°æ®åˆåŒæ—¶è¢«è®¿é—®ï¼Œé‚£ä¹ˆå°±ä¼šå¯¹æ•°æ®åº“é€ æˆè¾ƒå¤§å‹åŠ›ã€‚\nè§£å†³æ–¹æ¡ˆï¼š\nå¯¹äºçƒ­ç‚¹æ•°æ®ä¸è®¾ç½®è¿‡æœŸå€¼ï¼Œæˆ–è€…å¯¹äºåœ¨è®¾ç½®è¿‡æœŸæ—¶é—´çš„æ—¶å€™å†åŠ ä¸Šä¸€ä¸ªéšæœºæ—¶é—´ï¼Œè®©è¿‡æœŸæ—¶é—´ä¸åŒï¼Œé¿å…åŒæ—¶è¿‡æœŸã€‚è‡³äºä¸åŒæ—¶è¿‡æœŸçš„æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨redisåˆ é™¤è¿‡æœŸæ•°æ®ä¸¤ç§ç­–ç•¥ä¹‹ä¸€çš„å®šæœŸåˆ é™¤ã€‚ä¹Ÿå¯ä»¥é‡‡ç”¨é¢„çƒ­çš„æ–¹å¼ï¼Œå³å°†çƒ­é—¨æ•°æ®æå‰å­˜å…¥ç¼“å­˜ã€‚è¿˜å¯ä»¥ä½¿ç”¨é”ï¼Œç¼“å­˜å¤±æ•ˆæ—¶ï¼Œä¸æ˜¯ç›´æ¥è®¿é—®æ•°æ®åº“ï¼Œè€Œæ˜¯åªæœ‰è·å–ä¸€ä¸ªåˆ†å¸ƒå¼é”æ‰èƒ½è®¿é—®æ•°æ®åº“ï¼Œå¦‚æœä¸èƒ½è·å–åˆ†å¸ƒå¼é”ï¼Œè¯´æ˜å·²ç»æœ‰çº¿ç¨‹åœ¨æ‰§è¡Œï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼‘çœ ä¸€æ®µæ—¶é—´ï¼Œåœ¨å»è·å–åˆ†å¸ƒå¼é”ã€‚\n\n\n\n\nç¼“å­˜ç©¿é€\nè¦è¯»å–çš„æ•°æ®åœ¨ç¼“å­˜ä¸­æ²¡æœ‰ï¼Œåœ¨æ•°æ®åº“ä¸­ä¹Ÿæ²¡æœ‰ã€‚æ¯æ¬¡éƒ½ä¼šç©¿é€åˆ°æ•°æ®åº“ï¼Œç¼“å­˜æˆäº†æ‘†è®¾ï¼Œå¢å¤§æ•°æ®åº“çš„å‹åŠ›ã€‚\n\n\nè§£å†³æ–¹æ¡ˆï¼š\nå¯ä»¥è®¾ç«‹ç¼ºçœå€¼ï¼Œå‘ç°ç¼“å­˜ç©¿é€çš„æ•°æ®å°±è®¾ç«‹ä¸€ä¸ªç¼ºçœå€¼ï¼Œåç»­è®¿é—®æ—¶è¿”å›ç©ºå€¼ã€‚\nè¿˜å¯ä»¥ç”¨å¸ƒéš†è¿‡æ»¤å™¨ï¼Œå°±æ˜¯æ•°æ®å†™å…¥æ•°æ®åº“æ—¶ï¼Œå°†æ•°æ®çš„ id å­˜å…¥å¸ƒéš†è¿‡æ»¤å™¨ä¸­ï¼Œ è¯»å–æ•°æ®æ—¶åœ¨è¿‡æ»¤å™¨ä¸­æŸ¥æ‰¾æ•°æ® id ï¼Œå¦‚æœæ²¡æœ‰å°±ä¸ä¼šåˆ°æ•°æ®åº“ä¸­æŸ¥è¯¢ã€‚å¸ƒéš†è¿‡æ»¤å™¨çš„ç®—æ³•å°±æ˜¯ç»´æŠ¤ä¸€ä¸ªbitç±»å‹çš„æ•°ç»„ï¼Œå†™å…¥æ•°æ® id ï¼Œä½¿ç”¨ä¸‰ä¸ªhashå‡½æ•°ï¼Œä¸€ä¸ªidæ˜ å°„åˆ°ä¸‰ä¸ªä½ç½®å¹¶å­˜å…¥1ï¼ŒæŸ¥è¯¢ idï¼Œå¦‚æœè¿™ä¸ªidæ˜ å°„çš„ä¸‰ä¸ªä½ç½®æœ‰0ï¼Œé‚£ä¹ˆidä¸å­˜åœ¨ã€‚æ‰€ä»¥å¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­idå­˜åœ¨æ—¶ï¼Œidå¯èƒ½å­˜åœ¨ï¼Œåˆ¤æ–­idä¸å­˜åœ¨æ—¶ï¼Œidå°±ä¸å¯èƒ½å­˜åœ¨ã€‚\n\n\n\n\nç¼“å­˜é›ªå´©\nå¤§é‡è¯·æ±‚æ— æ³•åœ¨ç¼“å­˜ä¸­å¤„ç†ï¼Œå…¨éƒ¨æ‰“åˆ°æ•°æ®åº“ä¸­è‡´ä½¿æ•°æ®åº“å‹åŠ›å‰§å¢ç”šè‡³å®•æœºã€‚ä¸€ä¸ªrediså®ä¾‹æ”¯æŒ10ä¸‡çš„QPSï¼Œè€Œä¸€ä¸ªæ•°æ®åº“å®ä¾‹ä¸€èˆ¬åªæœ‰1000QPSã€‚å’Œç¼“å­˜å‡»ç©¿ç›¸ä¼¼çš„ä¸€ç‚¹æ˜¯ç¼“å­˜éƒ½æ— æ•ˆï¼ŒåŒºåˆ«äºç¼“å­˜å‡»ç©¿çš„ä¸€ç‚¹æ˜¯ç¼“å­˜é›ªå´©æ˜¯å¤§é‡æ•°æ®åŒæ—¶å¤±æ•ˆï¼Œç¼“å­˜å‡»ç©¿æ˜¯æŸä¸ªçƒ­ç‚¹æ•°æ®å¤±æ•ˆã€‚æœ‰ä¸¤ç§æƒ…å†µï¼šå¤§é‡æ•°æ®åŒæ—¶è¿‡æœŸï¼Œrediså®•æœº\n\n\nè§£å†³æ–¹æ¡ˆï¼š\nè®¾ç½®è¿‡æœŸæ—¶é—´æ—¶å†åŠ ä¸Šä¸€ä¸ªéšæœºæ—¶é—´ï¼Œé˜²æ­¢å¤§é‡æ•°æ®åŒæ—¶è¿‡æœŸã€‚ä¹Ÿå¯ä»¥è¿›è¡Œæ¥å£é™æµï¼Œå‡å°æ•°æ®åº“å‹åŠ›ã€‚\nå¯¹äºrediså®•æœºå¼•å‘çš„ç¼“å­˜é›ªå´©çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼šé™æµå’ŒæœåŠ¡ç†”æ–­ã€‚æœåŠ¡ç†”æ–­æŒ‡çš„æ˜¯ä»ç¼“å­˜è·å–æ•°æ®å¼‚å¸¸å°±ç›´æ¥è¿”å›é”™è¯¯ç»™å‰ç«¯ï¼Œé˜²æ­¢æ‰“åˆ°æ•°æ®åº“ã€‚å½“ç„¶ï¼Œæœ€å¥½çš„æ–¹æ³•å°±æ˜¯æ„å»ºé«˜å¯ç”¨çš„ç¼“å­˜é›†ç¾¤ï¼Œä¸»åº“å®•æœºï¼Œä»åº“æ¥æ›¿ä¸»åº“ã€‚\n\n\n\n\nå…«. jedis\n\nspringbot å¼•å…¥ jedis ä¾èµ–åŒ…ï¼Œåˆ©ç”¨ Jedis å¯¹è±¡æ¥è¿æ¥rediså’Œæ“ä½œredisæ•°æ®ã€‚\n\n\nè¿™é‡Œè®²è®² redis äº”å¤§åŸºæœ¬æ•°æ®ç±»å‹ï¼Œgeoçš„å¸¸ç”¨å‘½ä»¤ï¼Œå¢åˆ æ”¹æŸ¥çš„é¡ºåºï¼š\n\n\nï¼ˆ1ï¼‰redis äº”å¤§åŸºæœ¬æ•°æ®ç±»å‹\nString: [set, setnx, setex, setrange, mset, msetnx]  [unlink, del] [append, incr, decr, incrby, decrby] [get, mget, getrange, substr, strlen]\nList(åŒå‘é“¾è¡¨): [lpush, rpush, lpushx, linsert]  [lpop, rpop, lrem, brpop]  [lset]  [lrange, lindex, llen]\nHash: [hset, hsetnx, ]  [hdel]  [hincrby, hincrbyfloat]  [hget, hmget, hgetall, hexists, hkeys,hvals,hlen]\nSet: [sadd, ]  [spop, srem, smove ]  []  [amembers, sismember, scard, srandmember, sinter, sunion, sdiff, sinterstore]\nzset: [zadd]  [zrem]  [zincrby]  [zrange, zrevrange, zrangebyscore, zrevrangebyscore, zrangebylex, zcard, zcount, zrank, zscore]\n\n\n\nï¼ˆ2ï¼‰geogeoadd &lt; key&gt; &lt; longitude&gt;&lt; latitude&gt;&lt; member&gt;\ngeopos &lt; key&gt;&lt; member&gt; [&lt; member&gt;â€¦]\ngeodist &lt; key&gt;&lt; member1&gt;&lt; member2&gt;\ngeoradius &lt; key&gt;&lt; longitude&gt; &lt; latitue&gt; radius [m | km| fm| mi] count number\n","categories":["javaé¢è¯•"],"tags":["redis"]},{"title":"é¢è¯•ç³»åˆ—ä¹‹Javaé›†åˆ","url":"/2025/05/13/%E9%9D%A2%E8%AF%95%E7%B3%BB%E5%88%97%E4%B9%8BJava%E9%9B%86%E5%90%88/","content":"\n\nä»Šå¤©ä¹Ÿæ˜¯è¿›å…¥Javaé›†åˆçš„é¢è¯•æ€»ç»“äº†ï¼Œæ˜å¤©å°±å¼€å§‹æJUCå’ŒJVMäº†ï¼Œæå®Œäº†å…«è‚¡æ–‡ç³»åˆ—å°±å®Œç»“äº†ï¼Œä¹‹åå†å»æŠ•ç®€å†ï¼ŒåŒæ—¶ç»§ç»­å­¦ä¹ å¾®æœåŠ¡ã€‚ä¹Ÿæ˜¯è¢«æˆ‘å®‰æ’çš„æ˜æ˜ç™½ç™½çš„ğŸƒã€‚\n\n\nè€è§„çŸ©ï¼Œå…ˆæ”¾å¤§æ¦‚å›¾ï¼š\n\n\n\n\n\n\næ˜¨å¤©æ™šä¸Šå’Œä»Šå¤©ä¸Šåˆçœ‹äº†HashMapå¤§æ¦‚å’Œputæµç¨‹ä»¥åŠputæºç ï¼Œç°åœ¨å…ˆæ€»ç»“ä¸€ä¸‹HashMapçš„è¿™å‡ éƒ¨åˆ†ï¼Œä¹‹åå†ç»§ç»­çœ‹çœ‹HashMapçš„æ‰©å®¹æºç ã€‚\n\n\nä¸€. HashMap\n\nã€è¯´è¯´HashMapçš„å®ç°åŸç†ï¼Ÿã€‘\nHashMapåº•å±‚é‡‡ç”¨æ•°ç»„åŠ é“¾è¡¨å’Œçº¢é»‘æ ‘ã€‚\nå½“æˆ‘ä»¬å‘HashMapä¸­å­˜å…¥å¯¹è±¡æ—¶ï¼Œç”±keyå¯¹è±¡ç»è¿‡hashæ–¹æ³•ï¼ˆè·å–hashCodeå€¼ï¼Œå³ç§»16ä½ å’ŒåŸæ¥çš„hashCodeå€¼åšå¼‚æˆ–è¿ç®—ï¼‰ï¼Œå†å’Œæ¡¶æ•°ç»„çš„é•¿åº¦å–ä½™ï¼Œè®¡ç®—å‡ºç´¢å¼•ï¼Œå†å°†keyå’Œvalueå°è£…æˆEntryå¯¹è±¡ï¼Œå­˜å…¥å¯¹åº”ç´¢å¼•ä½ç½®ã€‚å¦‚æœå¯¹åº”ç´¢å¼•å·²ç»å­˜åœ¨Entryå¯¹è±¡ï¼Œå°±å°†è¯¥å¯¹è±¡çš„keyå’Œè¦å­˜å…¥çš„keyæ¯”è¾ƒï¼Œç›¸ç­‰çš„è¯å°±ç›´æ¥è¦†ç›–ï¼Œä¸ç›¸ç­‰çš„è¯å°±å°†å½“å‰çš„Entryå¯¹è±¡æ·»åŠ åˆ°é“¾è¡¨æˆ–è€…çº¢é»‘æ ‘ä¸­ã€‚\n\n\nã€HashMapçš„jdk1.7å’Œjdk1.8æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿã€‘\njdk1.7é‡‡ç”¨çš„æ˜¯æ‹‰é“¾æ³•ï¼Œå°±æ˜¯æ•°ç»„å’Œé“¾è¡¨ç»“åˆï¼Œå‘ç”Ÿå†²çªæ—¶å°†å†²çªçš„å€¼æ”¾å…¥é“¾è¡¨ä¸­ã€‚jdk1.8åœ¨è§£å†³å“ˆå¸Œå†²çªæ–¹é¢åŠ å…¥äº†çº¢é»‘æ ‘çš„è§£å†³æ–¹æ³•ï¼Œå½“é“¾è¡¨çš„é•¿åº¦å¤§äº8ï¼Œæ•°ç»„çš„é•¿åº¦è¾¾åˆ°64æ—¶ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œå½“æ‰©å®¹åï¼Œçº¢é»‘æ ‘çš„èŠ‚ç‚¹æ•°é‡å°äºç­‰äº6æ—¶ï¼Œå°±é€€åŒ–æˆé“¾è¡¨ã€‚\n\n\nã€HashMapçš„putæ–¹æ³•çš„å…·ä½“æµç¨‹ã€‘\nHashMapæ˜¯é‡‡ç”¨æ‡’æƒ°åŠ è½½çš„æ–¹å¼ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨putæ–¹æ³•æ—¶ï¼Œä¼šåˆå§‹åŒ–æˆé»˜è®¤çš„64å¤§å°å®¹é‡çš„æ¡¶æ•°ç»„ã€‚ä»Keyå¯¹è±¡è®¡ç®—å‡ºç´¢å¼•åï¼Œçœ‹æŒ‡å®šç´¢å¼•ä½ç½®æ˜¯å¦æœ‰Entryå¯¹è±¡ï¼Œæ²¡æœ‰çš„è¯å°±ç›´æ¥æ’å…¥ï¼Œè¿›å…¥æ‰©å®¹çš„é€»è¾‘ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œåˆ¤æ–­Entryå¯¹è±¡çš„keyæ˜¯å¦ç›¸åŒï¼Œç›¸åŒçš„è¯å°±ç›´æ¥è¦†ç›–ï¼Œç„¶åç»“æŸã€‚ä¸åŒçš„è¯åˆ¤æ–­æ˜¯å¦ä¸ºçº¢é»‘æ ‘ï¼Œæ˜¯çº¢é»‘æ ‘å°±æ·»åŠ åˆ°çº¢é»‘æ ‘ä¸­ï¼Œä¸æ˜¯çš„è¯ï¼Œå°±å¾ªç¯é“¾è¡¨åˆ¤æ–­æ˜¯å¤Ÿå­˜åœ¨keyç›¸åŒï¼Œå­˜åœ¨å°±ç›´æ¥è¦†ç›–ï¼Œä¸å­˜åœ¨çš„è¯å°±æ·»åŠ åˆ°é“¾è¡¨ä¸­ï¼Œå¦‚æœæ»¡è¶³è½¬æ¢ä¸ºçº¢é»‘æ ‘çš„æ¡ä»¶ï¼Œå°±è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œæœ€åè¿›å…¥æ‰©å®¹çš„é€»è¾‘ã€‚\n\n\nã€è¯´è¯´HashMapçš„æ‰©å®¹æœºåˆ¶ã€‘\nåœ¨åˆå§‹åŒ–å’Œæ·»åŠ å…ƒç´ çš„æ—¶å€™éƒ½éœ€è¦è°ƒç”¨resizeæ–¹æ³•æ‰©å®¹ï¼Œç¬¬ä¸€æ¬¡æ·»åŠ æ•°æ®åˆå§‹åŒ–æ•°ç»„çš„é•¿åº¦ä¸º16ï¼Œä¹‹åæ¯æ¬¡æ‰©å®¹éƒ½æ˜¯å…ƒç´ æ•°é‡åˆ°è¾¾æ‰©å®¹é˜ˆå€¼ï¼Œæ‰©å®¹åä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œå®¹é‡å’Œæ‰©å®¹é˜ˆå€¼éƒ½æ˜¯åŸæ¥çš„ä¸¤å€ï¼ŒæŠŠåŸæ¥æ•°ç»„çš„æ•°æ®æŒªåˆ°æ–°çš„æ•°ç»„ä¸­ï¼Œæ²¡æœ‰hashå†²çªçš„èŠ‚ç‚¹ï¼Œç›´æ¥ç”¨hashå€¼ä¸newCap-1å–ä½™çš„ç»“æœè®¡ç®—ç´¢å¼•å¹¶å­˜å‚¨ï¼Œæœ‰hashå†²çªçš„èŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œå°±èµ°çº¢é»‘æ ‘çš„æ·»åŠ ï¼Œå¦‚æœæ˜¯é“¾è¡¨ï¼Œå°±éå†æ‹†åˆ†é“¾è¡¨ï¼Œè®¡ç®—èŠ‚ç‚¹çš„hashå€¼å’Œ(newCap-1)çš„ä¸è¿ç®—çš„ç»“æœï¼Œå¦‚æœä¸º0ï¼Œå°±åœç•™åœ¨åŸä½ç½®ï¼Œå¦åˆ™ç§»åŠ¨åˆ°åŸå§‹ä½ç½®+å¢åŠ çš„æ•°ç»„å¤§å°è¿™ä¸ªä½ç½®ä¸Šã€‚\n\n\nã€ä¸ºä½•HashMapçš„æ•°ç»„é•¿åº¦ä¸€å®šæ˜¯2çš„æ¬¡å¹‚ï¼Ÿã€‘\n2çš„næ¬¡å¹‚å¯ä»¥ä½¿ç”¨ä½ä¸è¿ç®—ä»£æ›¿å–æ¨¡ï¼Œè®¡ç®—ç´¢å¼•çš„æ•ˆç‡æ›´é«˜ã€‚æ‰©å®¹æ—¶é‡æ–°è®¡ç®—ç´¢å¼•çš„æ•ˆç‡ä¹Ÿæ›´é«˜ï¼Œhash&amp;oldCap&#x3D;&#x3D;0,å…ƒç´ ç•™åœ¨åŸæ¥ä½ç½®ï¼Œå¦åˆ™æ–°ä½ç½®&#x3D;æ—§ä½ç½®+oldCapã€‚\n\n\nã€HashSetå’ŒHashMapæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿã€‘\nHashSetå®ç°äº†Setæ¥å£ï¼Œåªå­˜å‚¨å¯¹è±¡ï¼ŒHashMapå®ç°äº†Mapæ¥å£ï¼Œå­˜å‚¨çš„æ˜¯é”®å€¼å¯¹ã€‚HashSetåº•å±‚æ˜¯ç”¨HashMapå®ç°å­˜å‚¨çš„ï¼Œå°è£…äº†ä¸€ç³»åˆ—HashMapçš„æ–¹æ³•ï¼Œvalueé»˜è®¤å°±æ˜¯Objectå¯¹è±¡ï¼ŒHashSetä¸å…è®¸å‡ºç°é‡å¤å€¼ã€‚\n\n\nã€HashTableä¸HashMapçš„åŒºåˆ«ã€‘\nHashTableæ˜¯æ•°ç»„+é“¾è¡¨ï¼Œhashç®—æ³•å°±æ˜¯keyçš„hashCodeå€¼ï¼ˆHashMapæ˜¯äºŒæ¬¡hashï¼‰ï¼Œæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ˆhashMapæ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼‰ï¼Œä½†æ˜¯å®é™…å¼€å‘ä¸­ä¸å»ºè®®ä½¿ç”¨HashTableï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¯ä»¥ä½¿ç”¨ConcurrentHashMapç±»ã€‚\n\n\n\n\näºŒ. List\n\nã€è¯´è¯´Javaæä¾›çš„å¸¸è§é›†åˆï¼Ÿã€‘\nJavaé›†åˆä¸»è¦åˆ†ä¸ºCollectionå•åˆ—é›†åˆå’ŒMapåŒåˆ—é›†åˆã€‚Collectionä¸­æœ‰Listå’ŒSetæ¥å£ï¼Œå¹³æ—¶ä½¿ç”¨è¾ƒå¤šçš„æœ‰ArrayListå’ŒLinkedListï¼ŒMapä¸­å¸¸è§çš„å®ç°ç±»æœ‰HashMapï¼ŒTreeMapï¼Œçº¿ç¨‹å®‰å…¨çš„ConcurrentHashMapã€‚\n\n\nã€ArrayListåº•å±‚æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿã€‘\næˆ‘ä¸»è¦è¯´è¯´addæ–¹æ³•å§ï¼Œä¸ºäº†ç¡®ä¿æ•°ç»„çš„size+1ä¹‹åè¶³å¤Ÿå­˜ä¸‹ä¸‹ä¸€ä¸ªæ•°æ®ï¼Œè®¡ç®—å‡ºæ•°ç»„çš„å®¹é‡ï¼Œå¦‚æœå½“å‰æ•°ç»„çš„size+1å¤§äºé•¿åº¦ï¼Œå°±è°ƒç”¨growæ–¹æ³•æ‰©å®¹åˆ°1.5å€ï¼Œç¡®ä¿æ–°å¢çš„æ•°æ®æœ‰åœ°æ–¹å­˜å‚¨ä¹‹åå†æ·»åŠ æ–°å…ƒç´ ã€‚\n\n\nã€å¦‚ä½•å®ç°æ•°ç»„å’ŒListä¹‹é—´çš„è½¬æ¢ï¼Ÿè½¬æ¢å‰åæœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿã€‘\næ•°ç»„è½¬listæ˜¯è°ƒç”¨Arrays.asListæ–¹æ³•ï¼Œè½¬åŒ–ä¹‹åçš„Listæ˜¯å¯¹æ•°ç»„çš„åŒ…è£…ï¼Œæ•°ç»„æ”¹å˜ï¼ŒListä¹Ÿè·Ÿç€æ”¹å˜ï¼ŒListè½¬æ•°ç»„æ˜¯è°ƒç”¨toArrayæ–¹æ³•ï¼Œæ˜¯å¯¹Liståº•å±‚æ•°ç»„çš„æ‹·è´ï¼Œä¿®æ”¹äº†Listï¼Œæ•°ç»„ä¸ä¼šæ”¹å˜ã€‚\n\n\nã€ArrayListå’ŒLinkedListçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿã€‘\nArrayListæ˜¯åŠ¨æ€æ•°ç»„ï¼ŒLinkedListæ˜¯åŒå‘é“¾è¡¨ï¼ŒArrayListæ”¯æŒä¸‹æ ‡æŸ¥è¯¢ï¼ŒLinkedListä¸æ”¯æŒï¼ŒArrayListå’ŒLinkedListéå†æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(n)ï¼ŒArrayListå°¾éƒ¨çš„å¢åˆ ï¼ŒLinkedListå¤´å°¾èŠ‚ç‚¹çš„å¢åˆ æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(1)ï¼Œå…¶ä»–ä½ç½®çš„å¢åˆ çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(n)ã€‚\nArrayListåº•å±‚æ˜¯æ•°ç»„ï¼Œéœ€è¦è¿ç»­çš„å†…å­˜ï¼ŒèŠ‚çœå†…å­˜ï¼ŒLinkedListåˆ™éœ€è¦å­˜å‚¨æ•°æ®å’Œä¸¤ä¸ªæŒ‡é’ˆï¼Œæ›´å ç”¨å†…å­˜ã€‚\n\n\nã€ArrayListå’ŒLinkedListéƒ½ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¦‚ä½•è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Ÿã€‘\nä¸»è¦æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼Œä¸€ä¸ªæ˜¯åœ¨å±€éƒ¨å˜é‡ä¸­ä½¿ç”¨ï¼Œä¸ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œç¬¬äºŒä¸ªæ˜¯ç”¨Collectionsçš„synchronizedListæ–¹æ³•å°†ArrayListè½¬æ¢æˆçº¿ç¨‹å®‰å…¨çš„å®¹å™¨ï¼Œç”¨ConcurrentLinkedQueueæ›¿æ¢LinkedListæ¥ä½¿ç”¨ã€‚\n","categories":["javaé¢è¯•"],"tags":["Javaé›†åˆ"]}]