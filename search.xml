<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>vue-element-adminä¹‹å¢åˆ æ”¹æŸ¥</title>
    <url>/2025/04/20/vue-element-admin%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/</url>
    <content><![CDATA[<p>ä»‹ç»ï¼š æ˜¯ä¸€ä¸ªåå°å‰ç«¯è§£å†³æ–¹æ¡ˆï¼Œå®ƒåŸºäº <a href="https://github.com/vuejs/vue">vue</a> å’Œ <a href="https://github.com/ElemeFE/element">element-ui</a>å®ç°ã€‚å®ƒä½¿ç”¨äº†æœ€æ–°çš„å‰ç«¯æŠ€æœ¯æ ˆï¼Œå†…ç½®äº† i18 å›½é™…åŒ–è§£å†³æ–¹æ¡ˆï¼Œ<em><strong>åŠ¨æ€è·¯ç”±</strong></em>ï¼Œ<em><strong>æƒé™éªŒè¯</strong></em>ï¼Œæç‚¼äº†å…¸å‹çš„ä¸šåŠ¡æ¨¡å‹ï¼Œæä¾›äº†ä¸°å¯Œçš„<em><strong>åŠŸèƒ½ç»„ä»¶</strong></em>ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿæ­å»ºä¼ä¸šçº§ä¸­åå°äº§å“åŸå‹</p>
<br>

<br>

<h4 id="ä¸‹é¢å°±ä»¥ç”¨æˆ·ç®¡ç†ä¸ºä¾‹æ¥è®²è®²å¢åˆ æ”¹æŸ¥å§"><a href="#ä¸‹é¢å°±ä»¥ç”¨æˆ·ç®¡ç†ä¸ºä¾‹æ¥è®²è®²å¢åˆ æ”¹æŸ¥å§" class="headerlink" title="ä¸‹é¢å°±ä»¥ç”¨æˆ·ç®¡ç†ä¸ºä¾‹æ¥è®²è®²å¢åˆ æ”¹æŸ¥å§"></a>ä¸‹é¢å°±ä»¥ç”¨æˆ·ç®¡ç†ä¸ºä¾‹æ¥è®²è®²å¢åˆ æ”¹æŸ¥å§<img src="https://dl4.weshineapp.com/gif/20231204/8c7dd83ead6a7b1cdbd02c3a67b4ef37.gif?f=micro_" alt="img" style="zoom: 25%;" /></h4><p>æ•°æ®åº“ç»“æ„ï¼š</p>
<img src="\images\vue\deptè¡¨.png" alt="éƒ¨é—¨è¡¨"  />

<img src="\images\vue\userè¡¨.png" alt="ç”¨æˆ·è¡¨" style="zoom: 50%;" />

<br>

<p>é¡µé¢æˆå“ï¼š</p>
<img src="\images\vue\å¢åˆ æ”¹æŸ¥åŸå‹.png" alt="å¢åˆ æ”¹æŸ¥åŸå‹" style="zoom:80%;" />

<br>

<p>æ¦‚è¿°ï¼š æ€»ç»“å¸¸è§çš„å¢åˆ æ”¹æŸ¥ç»†èŠ‚ï¼š </p>
<p>ï¼ˆ1ï¼‰ element-ui æ•°æ®å‘ˆç°çš„å½¢å¼</p>
<p>ï¼ˆ2ï¼‰ ç›¸å…³å‡½æ•°çš„è°ƒç”¨ç»†èŠ‚</p>
<br>

<ol>
<li><h4 id="æŸ¥è¯¢ï¼š"><a href="#æŸ¥è¯¢ï¼š" class="headerlink" title="æŸ¥è¯¢ï¼š"></a><em><strong>æŸ¥è¯¢ï¼š</strong></em></h4><p>æ¯”è¾ƒå¸¸è§„ï¼ŒæŸ¥è¯¢è¡¨å•ç»‘å®šæäº¤çš„æŸ¥è¯¢æ•°æ®æ¨¡å‹ï¼Œç‚¹å‡»æŒ‰é’®è§¦å‘æäº¤æ–¹æ³•ï¼Œæ–¹æ³•è°ƒç”¨@&#x2F;apiä¸­çš„æ–¹æ³•è°ƒç”¨åç«¯æ¥å£ï¼Œè¿”å›æ•°æ®ï¼Œè¡¨æ ¼ç»‘å®šæŒ‡å®šæ•°æ®å¹¶é€šè¿‡æ•°æ®çš„å±æ€§ä¸€ä¸€å‘ˆç°ã€‚</p>
<br>

<p>å€¼å¾—ä¸€æçš„æ˜¯ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š</p>
<br>

<h6 id="1-åå°è¿”å›éƒ¨é—¨æ ‘å½¢ç»“æ„æ•°æ®å¹¶é€šè¿‡å‰ç«¯å‘ˆç°ï¼Œå…¶ä¸­æ¶‰åŠåˆ°-é€’å½’-çš„ä½¿ç”¨ï¼š"><a href="#1-åå°è¿”å›éƒ¨é—¨æ ‘å½¢ç»“æ„æ•°æ®å¹¶é€šè¿‡å‰ç«¯å‘ˆç°ï¼Œå…¶ä¸­æ¶‰åŠåˆ°-é€’å½’-çš„ä½¿ç”¨ï¼š" class="headerlink" title="(1) åå°è¿”å›éƒ¨é—¨æ ‘å½¢ç»“æ„æ•°æ®å¹¶é€šè¿‡å‰ç«¯å‘ˆç°ï¼Œå…¶ä¸­æ¶‰åŠåˆ° é€’å½’ çš„ä½¿ç”¨ï¼š"></a><strong>(1) åå°è¿”å›éƒ¨é—¨æ ‘å½¢ç»“æ„æ•°æ®å¹¶é€šè¿‡å‰ç«¯å‘ˆç°ï¼Œå…¶ä¸­æ¶‰åŠåˆ° é€’å½’ çš„ä½¿ç”¨ï¼š</strong></h6><img src="\images\vue\æŸ¥è¯¢æ ‘å½¢ç»“æ„.png" alt="æŸ¥è¯¢æ ‘å½¢ç»“æ„"  />

<br>

<p>åç«¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Dept&gt; <span class="title function_">buildTree</span><span class="params">(List&lt;Dept&gt; deptList, <span class="type">int</span> pid)</span> &#123;</span><br><span class="line">           <span class="comment">// 0ï¼›çˆ¶èŠ‚ç‚¹ å…¶ä»–ï¼šå­èŠ‚ç‚¹</span></span><br><span class="line">           List&lt;Dept&gt; deptTree = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">           Optional.ofNullable(deptList).orElse(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;())</span><br><span class="line">                   .stream().filter(dept -&gt; dept!=<span class="literal">null</span> &amp;&amp; dept.getPid()==pid)</span><br><span class="line">                   .forEach(dept -&gt; &#123;</span><br><span class="line">                       <span class="type">Dept</span> <span class="variable">dept1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dept</span>();</span><br><span class="line">                       BeanUtils.copyProperties(dept, dept1);</span><br><span class="line">                       dept1.setChildren(buildTree(deptList, dept.getId()));</span><br><span class="line">                       deptTree.add(dept1);</span><br><span class="line">                   &#125;);</span><br><span class="line">           <span class="keyword">return</span> deptTree;</span><br><span class="line">       &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="comment">// æŸ¥è¯¢æ‰€æœ‰çš„deptè¡¨æ•°æ® List&lt;Dept&gt; deptListï¼Œå†æ·»åŠ é¡¶éƒ¨æ•°æ®ï¼š</span></span><br><span class="line">   <span class="type">Dept</span> <span class="variable">dept</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dept</span>();</span><br><span class="line">   dept.setDeptName(<span class="string">&quot;æ‰€æœ‰éƒ¨é—¨&quot;</span>).setId(<span class="number">0</span>).setPid(-<span class="number">1</span>);</span><br><span class="line">   deptList.add(dept);</span><br><span class="line"></span><br><span class="line">   <span class="comment">// æ„é€ æ ‘å½¢æ•°æ®ç»“æ„</span></span><br><span class="line"><span class="keyword">return</span> DeptTreeUtils.buildTree(deptList, -<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<br>

<p>å‰ç«¯ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">   <span class="tag">&lt;<span class="name">el-tree</span> <span class="attr">:data</span>=<span class="string">&quot;treeData&quot;</span> <span class="attr">:props</span>=<span class="string">&quot;defaultProps&quot;</span> <span class="attr">node-key</span>=<span class="string">&quot;id&quot;</span> <span class="attr">:default-expand-all</span>=<span class="string">&quot;true&quot;</span> <span class="attr">empty-text</span>=<span class="string">&quot;æš‚æ— æ•°æ®&quot;</span> @<span class="attr">node-click</span>=<span class="string">&quot;handleNodeClick&quot;</span> <span class="attr">:highlight-current</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-tree</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">   props: å‘ˆç°çš„å±æ€§</span></span><br><span class="line"><span class="comment">   node-key çš„ä½œç”¨ï¼šåªæ˜¯å‘Šè¯‰ç»„ä»¶ç”¨å“ªä¸ªå­—æ®µä½œä¸ºèŠ‚ç‚¹çš„å”¯ä¸€æ ‡è¯†ï¼ˆç±»ä¼¼ä¸»é”®ï¼‰ï¼Œç”¨äºç»„ä»¶å†…éƒ¨ç®¡ç†èŠ‚ç‚¹çŠ¶æ€ï¼ˆå¦‚å±•å¼€ã€é€‰ä¸­ã€æŸ¥æ‰¾ç­‰ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">   handleNodeClick çš„ä½œç”¨ï¼šç‚¹å‡»èŠ‚ç‚¹æ—¶ï¼Œå®ƒä¼šä¼ é€’å®Œæ•´çš„èŠ‚ç‚¹æ•°æ®å¯¹è±¡ç»™ä½ </span></span><br><span class="line"><span class="comment">   å…¶ä»–ï¼š é»˜è®¤å±•å¼€ï¼Œ æ ¡éªŒï¼Œ ç‚¹å‡»äº‹ä»¶ï¼Œ é€‰ä¸­é«˜äº®æ˜¾ç¤º</span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br><span class="line">   </span><br><span class="line">   handleNodeClick(data) &#123;</span><br><span class="line">    this.userModel.deptId = data.id;</span><br><span class="line">       this.search();</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>å¥½çš„ï¼Œå¦‚æ­¤ä¾¿å¯å‘ˆç°æ ‘å½¢ç»“æ„æ•°æ®äº†ï¼Œç‚¹å‡»æ—¢å¯å°†dept_idèµ‹å€¼ç»™userModelçš„deptIdå±æ€§ï¼Œå®ç°æŸ¥è¯¢åŠŸèƒ½ã€‚</p>
<br></li>
</ol>
<p>æ­¤æ—¶ï¼Œä¾¿æœ‰ä¸€ä¸ªé—®é¢˜äº†ï¼Œç‚¹å‡»é¡¶çº§èœå•â€æ‰€æœ‰éƒ¨é—¨â€ä¸ºä»€ä¹ˆä¼šå‘ç”ŸæŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·ï¼Ÿè¿™å°±éœ€è¦å‘å†…çœ‹çœ‹æŸ¥è¯¢çš„é€»è¾‘äº†ï¼š</p>
<p>é€»è¾‘å¾ˆå¯»å¸¸ï¼Œæˆ‘è®¾ç½®çš„æ‰€æœ‰ç”¨æˆ·çš„dept_idéƒ½ä¸ºç©ºï¼Œè¯»å–mysqlæ•°æ®åº“çš„dept_idåˆ—æ—¶ï¼ŒResultSet.getInt()ä¼šè¿”å›0ï¼Œè€Œé¡¶çº§èœå•çš„idå³ä¸º0ï¼Œæ‰€ä»¥æŸ¥è¯¢å…¨éƒ¨ç”¨æˆ·ã€‚ğŸ˜‚</p>
<br>

<br>

<h6 id="2-å¤é€‰æ¡†"><a href="#2-å¤é€‰æ¡†" class="headerlink" title="(2) å¤é€‰æ¡†"></a>(2) å¤é€‰æ¡†</h6><img src="\images\vue\è§’è‰²ç»‘å®š.png" alt="è§’è‰²ç»‘å®š"  />

<br>

<p>ç›¸å¯¹æ¥è®²æ¯”è¾ƒç®€å•: å°±æ˜¯ç‚¹å‡»æŒ‰é’®å‘åç«¯è¯·æ±‚æ‰€æœ‰é€‰é¡¹æ•°æ®roleListï¼Œå‘ˆç°çš„å±æ€§æ˜¯roleName, å€¼ï¼ˆlabelï¼‰ä¸ºidï¼Œé»˜è®¤é€‰é¡¹ä¸ºel-checkbox-groupæ ‡ç­¾çš„ç»‘å®šæ¨¡å‹roleIdså†…çš„å…ƒç´ ï¼Œç‚¹é€‰å¤é€‰æ¡†ï¼Œå¯æ”¹å˜roleIdså†…çš„å…ƒç´ ï¼Œä»¥ä¸‹ä¸ºå‰ç«¯æ ‡ç­¾ç»“æ„ï¼š</p>
<br>

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">title</span>=<span class="string">&quot;è§’è‰²ç»‘å®š&quot;</span> <span class="attr">:visible.sync</span>=<span class="string">&quot;dialogRoleVisible&quot;</span> <span class="attr">width</span>=<span class="string">&quot;30%&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-checkbox-group</span> <span class="attr">v-model</span>=<span class="string">&quot;roleIds&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-checkbox</span> <span class="attr">v-for</span>=<span class="string">&quot;item in roleList&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item.id&quot;</span> <span class="attr">:label</span>=<span class="string">&quot;item.id&quot;</span>&gt;</span>&#123;&#123;item.roleName&#125;&#125;<span class="tag">&lt;/<span class="name">el-checkbox</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-checkbox-group</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">slot</span>=<span class="string">&quot;footer&quot;</span> <span class="attr">class</span>=<span class="string">&quot;dialog-footer&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;clearBind&quot;</span>&gt;</span>å–æ¶ˆ<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleBindRole&quot;</span>&gt;</span>ç¡®å®š<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br></pre></td></tr></table></figure>

<br>

<p>å¤„ç†é€»è¾‘ï¼š ç‚¹å‡»è§’è‰²ç»‘å®šæŒ‰é’®ï¼Œå‘åå°å‘é€2ä¸ªè¯·æ±‚ ï¼šï¼ˆ1ï¼‰æ‰€æœ‰çš„è§’è‰²æ•°æ®  ï¼ˆ2ï¼‰ä¸ç”¨æˆ·è”ç³»çš„è§’è‰²id</p>
<p>ç‚¹é€‰å¤é€‰æ¡†ä¹‹åï¼Œå‘é€è¯·æ±‚æºå¸¦userIdå’ŒroleListï¼Œåå°å…ˆåˆ é™¤userIdç›¸å…³è”çš„roleId, åœ¨æ‰¹é‡æ’å…¥ç”¨æˆ·è§’è‰²å…³ç³»ã€‚ğŸ˜</p>
<br>

<br>

<h6 id="ï¼ˆ3ï¼‰åˆ†é¡µæŸ¥æ‰¾çš„é€»è¾‘"><a href="#ï¼ˆ3ï¼‰åˆ†é¡µæŸ¥æ‰¾çš„é€»è¾‘" class="headerlink" title="ï¼ˆ3ï¼‰åˆ†é¡µæŸ¥æ‰¾çš„é€»è¾‘"></a>ï¼ˆ3ï¼‰åˆ†é¡µæŸ¥æ‰¾çš„é€»è¾‘</h6><br>

<p>å•è¡¨åˆ†é¡µæŸ¥è¯¢çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨baseMapper.selectByPage(page, æŸ¥è¯¢å¯¹è±¡)</p>
<br>

<p>å¤šè¡¨è”åˆæŸ¥è¯¢çš„æƒ…å†µä¸‹:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">ä½¿ç”¨ï¼š</span><br><span class="line">baseMapper.searchByPage(page, autoInfo);</span><br><span class="line"></span><br><span class="line">AutoInfoMapperä¸­å®šä¹‰searchByPageæ–¹æ³•</span><br><span class="line">Page<span class="tag">&lt;<span class="name">AutoInfo</span>&gt;</span> searchByPage(Page<span class="tag">&lt;<span class="name">AutoInfo</span>&gt;</span> page, AutoInfo autoInfo);</span><br><span class="line"></span><br><span class="line">Mapper.xmlä¸­ï¼š</span><br><span class="line">AutoInfo.xmlï¼š</span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;searchByPage&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.coder.rental.entity.AutoInfo&quot;</span>&gt;</span></span><br><span class="line">    select i.*, m.name, b.brand_name </span><br><span class="line">    from auto_info i, auto_maker m, auto_brand b</span><br><span class="line">	where i.maker_id = m.id and i.brand_id = b.id åç»­ä¸ºå¯¹è±¡æ¡ä»¶æŸ¥è¯¢</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œä¼ å…¥çš„pageå¯¹è±¡å¥½åƒåœ¨æŸ¥è¯¢ä¸­ç”¨ä¸åˆ°ï¼Œåº”è¯¥åœ¨è¿”å›ä¸­ä½¿List&lt;.AutoInfo.&gt;è‡ªåŠ¨è½¬åŒ–æˆPageå¯¹è±¡å§ï¼ŒæŒºé‚ªä¹çš„ğŸ˜’</p>
<br>

<br>

<h6 id="ï¼ˆ4ï¼‰æ ¹æ®èº«ä»½è¯å·ç¡®å®šå‡ºç”Ÿæ—¥æœŸ-æ€§åˆ«å’Œå¹´é¾„"><a href="#ï¼ˆ4ï¼‰æ ¹æ®èº«ä»½è¯å·ç¡®å®šå‡ºç”Ÿæ—¥æœŸ-æ€§åˆ«å’Œå¹´é¾„" class="headerlink" title="ï¼ˆ4ï¼‰æ ¹æ®èº«ä»½è¯å·ç¡®å®šå‡ºç”Ÿæ—¥æœŸ,æ€§åˆ«å’Œå¹´é¾„"></a>ï¼ˆ4ï¼‰æ ¹æ®èº«ä»½è¯å·ç¡®å®šå‡ºç”Ÿæ—¥æœŸ,æ€§åˆ«å’Œå¹´é¾„</h6><br>

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;èº«ä»½è¯å·&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;idNum&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;saveCustomer.idNum&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;setCustomerInfo&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span>               </span><br><span class="line"><span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;å®¢æˆ·å¹´é¾„&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;age&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;saveCustomer.age&quot;</span> <span class="attr">:readonly</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;å®¢æˆ·æ€§åˆ«&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;gender&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-radio-group</span> <span class="attr">v-model</span>=<span class="string">&quot;saveCustomer.gender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-radio-button</span> <span class="attr">:label</span>=<span class="string">&quot;1&quot;</span> <span class="attr">disabled</span>&gt;</span>ç”·<span class="tag">&lt;/<span class="name">el-radio-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-radio-button</span> <span class="attr">:label</span>=<span class="string">&quot;0&quot;</span> <span class="attr">disabled</span>&gt;</span>å¥³<span class="tag">&lt;/<span class="name">el-radio-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-radio-group</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;å‡ºç”Ÿæ—¥æœŸ&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;birthday&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-date-picker</span> <span class="attr">v-model</span>=<span class="string">&quot;saveCustomer.birthday&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">type</span>=<span class="string">&quot;date&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;é€‰æ‹©æ—¥æœŸ&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">value-format</span>=<span class="string">&quot;yyyy-MM-dd&quot;</span> <span class="attr">:readonly</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-date-picker</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">setCustomerInfo</span>(<span class="params">val</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//220202199911312661</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//å¤„ç†æ€§åˆ«</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> sex = val.<span class="title function_">charAt</span>(val.<span class="property">length</span> - <span class="number">2</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">saveCustomer</span>.<span class="property">gender</span> = sex % <span class="number">2</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//è·å–ç”¨æˆ·èº«ä»½è¯ä¸Šçš„å‡ºç”Ÿæ—¥æœŸ</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> birthday = val.<span class="title function_">substring</span>(<span class="number">6</span>, <span class="number">14</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//å½“å‰ç³»ç»Ÿæ—¶é—´</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>()</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> birthDate = <span class="keyword">new</span> <span class="title class_">Date</span>(birthday.<span class="title function_">substring</span>(<span class="number">0</span>, <span class="number">4</span>), birthday.<span class="title function_">substring</span>(<span class="number">4</span>, <span class="number">6</span>) - <span class="number">1</span>, birthday.<span class="title function_">substring</span>(<span class="number">6</span>, <span class="number">8</span>))</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> timeDiff = <span class="title class_">Math</span>.<span class="title function_">abs</span>(now.<span class="title function_">getTime</span>() - birthDate.<span class="title function_">getTime</span>())</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (timeDiff &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//è®¡ç®—å¹´é¾„</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">saveCustomer</span>.<span class="property">age</span> = <span class="title class_">Math</span>.<span class="title function_">floor</span>(timeDiff / (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">365</span>))</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//è®¡ç®—å‡ºç”Ÿæ—¥æœŸ</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">saveCustomer</span>.<span class="property">birthday</span> = birthDate<span class="comment">//birthday.substring(0,4)+&quot;-&quot;+birthday.substring(4,6)+&quot;-&quot;+birthday.substring(6,8)</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.$forceUpdate()</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<br>

<br>

<h6 id="5-æ—¥æœŸé€‰æ‹©"><a href="#5-æ—¥æœŸé€‰æ‹©" class="headerlink" title="(5) æ—¥æœŸé€‰æ‹©"></a>(5) æ—¥æœŸé€‰æ‹©</h6><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-date-picker</span> <span class="attr">v-</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">model</span>=<span class="string">&quot;violationModel.violationTimeVal&quot;</span> <span class="attr">type</span>=<span class="string">&quot;datetimerange&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">value-format</span>=<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span> <span class="attr">:picker-</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">options</span>=<span class="string">&quot;pickerOptions&quot;</span> <span class="attr">range-separator</span>=<span class="string">&quot;è‡³&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">start-placeholder</span>=<span class="string">&quot;å¼€å§‹æ—¥æœŸ&quot;</span> <span class="attr">end-placeholder</span>=<span class="string">&quot;ç»“æŸæ—¥æœŸ&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">align</span>=<span class="string">&quot;right&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-date-picker</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;è¿ç« æ—¶é—´&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;vtime&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-date-picker</span> <span class="attr">v-model</span>=<span class="string">&quot;saveViolation.vtime&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">type</span>=<span class="string">&quot;datetime&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;é€‰æ‹©æ—¥æœŸ&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">value-format</span>=<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">åç«¯å®ä½“ç±»æ•°æ®ï¼š</span></span><br><span class="line"><span class="comment">@ApiModelProperty(&quot;è¿ç« æ—¶é—´&quot;)</span></span><br><span class="line"><span class="comment">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class="line"><span class="comment">private LocalDateTime vtime;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure>

<br>

<br>

<h6 id="6-ä¸‹æ‹‰æ¡†"><a href="#6-ä¸‹æ‹‰æ¡†" class="headerlink" title="(6) ä¸‹æ‹‰æ¡†"></a>(6) ä¸‹æ‹‰æ¡†</h6><p>è½¦è¾†ä¿å…»çš„æ–°å¢é€‰æ‹©è½¦ç‰Œï¼Œè½¦è¾†ä¿¡æ¯æ–°å¢æ‰€å±å‚å•†ï¼Œæ±½è½¦å‡ºç§Ÿ</p>
<br>

<br>

<h6 id="7-ä¾§è¾¹æ "><a href="#7-ä¾§è¾¹æ " class="headerlink" title="(7) ä¾§è¾¹æ "></a>(7) ä¾§è¾¹æ </h6><ol start="2">
<li><h4 id="æ·»åŠ å’Œä¿®æ”¹ï¼š"><a href="#æ·»åŠ å’Œä¿®æ”¹ï¼š" class="headerlink" title="æ·»åŠ å’Œä¿®æ”¹ï¼š"></a><em><strong>æ·»åŠ å’Œä¿®æ”¹ï¼š</strong></em></h4>å¼¹å‡ºæ·»åŠ ä¿®æ”¹å¯¹è¯æ¡†ï¼Œæ³¨æ„å»¶è¿Ÿæ ¡éªŒï¼Œè¡¨å•ç»‘å®šä¿å­˜æ•°æ®æ¨¡å‹saveUserï¼Œæ­¤æ—¶æœ‰å¯»å¸¸ç¼–è¾‘çš„æƒ…å†µï¼Œæœ‰ç‚¹å‡»å¼¹å‡ºæ ‘å½¢ç»“æ„ï¼Œè¿›è¡Œç‚¹é€‰çš„æƒ…å†µï¼ˆä¸Šé¢æŸ¥è¯¢æ—¶å·²ç»ä»‹ç»è¿‡äº†ï¼‰ï¼Œ è¿™é‡Œé‡ç‚¹ä»‹ç»ä¸Šä¼ å¤´åƒçš„æƒ…å†µï¼š</li>
</ol>
<p>å¯¹ï¼Œæˆ‘ä»¬ç”¨åˆ°çš„å°±æ˜¯aliyunçš„ossæœåŠ¡ï¼Œè¯¦ç»†çš„ä¸Šä¼ å’Œåˆ é™¤è¯·å‚è€ƒ<a href="https://jixu0610.github.io/2025/04/20/%E9%98%BF%E9%87%8C%E4%BA%91OSS/#more">é˜¿é‡Œäº‘ä¸Šä¼ å’Œåˆ é™¤å›¾ç‰‡</a>ï¼Œæˆ‘ä»¬è¿™é‡Œåªè°ˆä¸€è°ˆå¢æ·»å¤´åƒçš„é€»è¾‘ï¼š</p>
<p>ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡ï¼Œåç«¯è¿”å›å›¾ç‰‡åœ°å€ï¼Œå‰ç«¯åˆ©ç”¨åœ°å€æ˜¾ç¤ºå›¾ç‰‡å³å¯</p>
<p>æ‰€ä»¥è¿™é‡Œåªè®¨è®ºå‰ç«¯ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;ç”¨æˆ·å¤´åƒ&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;avatar&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-upload</span></span></span><br><span class="line"><span class="tag">               <span class="attr">class</span>=<span class="string">&quot;avatar-uploader&quot;</span></span></span><br><span class="line"><span class="tag">               <span class="attr">:action</span>=<span class="string">&quot;uploadPath&quot;</span></span></span><br><span class="line"><span class="tag">               <span class="attr">:show-file-list</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">               <span class="attr">:on-success</span>=<span class="string">&quot;handleAvatarSuccess&quot;</span></span></span><br><span class="line"><span class="tag">               <span class="attr">:before-upload</span>=<span class="string">&quot;beforeAvatarUpload&quot;</span></span></span><br><span class="line"><span class="tag">               <span class="attr">:data</span>=<span class="string">&quot;uploadToken&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">v-if</span>=<span class="string">&quot;saveUser.avatar&quot;</span> <span class="attr">:src</span>=<span class="string">&quot;saveUser.avatar&quot;</span> <span class="attr">class</span>=<span class="string">&quot;avatar&quot;</span> <span class="attr">width</span>=<span class="string">&quot;80&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">i</span> <span class="attr">v-else</span> <span class="attr">class</span>=<span class="string">&quot;el-icon-plus avatar-uploader-icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-upload</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">uploadPath</span>: process.<span class="property">env</span>.<span class="property">VUE_APP_BASE_API</span> + <span class="string">&#x27;rental/oss/upload&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">uploadToken</span>: &#123;<span class="attr">token</span>: <span class="title function_">getToken</span>()&#125;,</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">handleAvatarSuccess</span>(<span class="params">res, file</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">saveUser</span>.<span class="property">avatar</span> = res.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.$forceUpdate();</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">beforeAvatarUpload</span>(<span class="params">file</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// ä¸Šä¼ å¤´åƒä¹‹å‰çš„éªŒè¯</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> isJPG = file.<span class="property">type</span> === <span class="string">&#x27;image/jpeg&#x27;</span> || file.<span class="property">type</span> === <span class="string">&#x27;image/png&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> isLt2M = file.<span class="property">size</span>/<span class="number">1024</span>/<span class="number">1024</span> &lt; <span class="number">2</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (!isJPG) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&#x27;ä¸Šä¼ å¤´åƒåªèƒ½æ˜¯ JPG æˆ– PNG æ ¼å¼ï¼&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (!isLt2M) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&#x27;ä¸Šä¼ å¤´åƒå¤§å°ä¸èƒ½è¶…è¿‡2MB!&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> isJPG &amp;&amp; isLt2M;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>okï¼Œæ­£å¦‚ä¸Šæ‰€ç¤ºï¼Œæœ‰ä¸Šä¼ åœ°å€ï¼Œæºå¸¦tokenä»¤ç‰Œï¼Œä¸Šä¼ ä¹‹å‰è¿›è¡ŒéªŒè¯ï¼Œä¸Šä¼ æˆåŠŸåå›¾ç‰‡åœ°å€èµ‹å€¼ç»™saveUser.avatar</p>
<br>

<p>è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼š</p>
<p>ä»¥ä¸‹ä¸¤ä¸ªè¯­å¥çš„å¼•ç”¨é€»è¾‘ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; getToken &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/auth&#x27;</span>;</span><br><span class="line"><span class="comment">// VUE_APP_BASE_API å®šä¹‰åœ¨ @/env.developmentæ–‡ä»¶ä¸‹ï¼ˆï¼‰, å¯ä»¥ç›´æ¥é€šè¿‡processå¼•ç”¨</span></span><br><span class="line"><span class="attr">uploadPath</span>: process.<span class="property">env</span>.<span class="property">VUE_APP_BASE_API</span> + <span class="string">&#x27;rental/oss/upload&#x27;</span>, </span><br><span class="line"><span class="comment">// getToken() å®šä¹‰åœ¨@/utils/authä¸­</span></span><br><span class="line"><span class="attr">uploadToken</span>: &#123;<span class="attr">token</span>: <span class="title function_">getToken</span>()&#125;,</span><br><span class="line">    </span><br><span class="line"><span class="comment">// å¥½çš„ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹tokençš„è·å–è¿‡ç¨‹ï¼šå°±æ˜¯å°è£…çš„Cookiesä¸­è·å–</span></span><br><span class="line"><span class="comment">// @/utils/auth.js: </span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Cookies</span> <span class="keyword">from</span> <span class="string">&#x27;js-cookie&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">TokenKey</span> = <span class="string">&#x27;Admin-Token&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getToken</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Cookies</span>.<span class="title function_">get</span>(<span class="title class_">TokenKey</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<ol start="3">
<li><h4 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a><em><strong>åˆ é™¤</strong></em></h4></li>
</ol>
<p>è¿™é‡Œçš„åˆ é™¤å¯ä»¥æ˜¯æŒ‡å®šè¡Œçš„å…ƒç´ åˆ é™¤ï¼Œä¹Ÿå¯ä»¥æ˜¯é€‰ä¸­æ•°è¡Œè¿›è¡Œæ‰¹é‡åˆ é™¤</p>
<br>

<p>æŒ‡å®šè¡Œçš„åˆ é™¤ï¼š å¡æ§½è·å–å¯¹è±¡ï¼Œå°†å¯¹è±¡ä¼ å…¥åˆ é™¤å‡½æ•°æ ¹æ®idè¿›è¡Œåˆ é™¤</p>
<p>æ‰¹é‡åˆ é™¤ï¼š åˆ©ç”¨ el-table-column type&#x3D;â€selectionâ€ æ„å»ºåŸºæœ¬å¤é€‰æ¡†ï¼Œç‚¹å‡»æ—¶è§¦å‘ el-table @selection-changeäº‹ä»¶</p>
<p>ä¸‹é¢æ¥è¯¦ç»†çœ‹çœ‹æ‰¹é‡åˆ é™¤çš„å…ƒç´ å‹¾é€‰ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">multipleSelection</span>: [],  <span class="comment">// è·å–åˆ é™¤çš„æ‰¹é‡id</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123; </span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">handleSelectionChange</span>(<span class="params">val</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">multipleSelection</span> = [];</span></span><br><span class="line"><span class="language-javascript">            val.<span class="title function_">forEach</span>(<span class="function"><span class="params">element</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">multipleSelection</span>.<span class="title function_">push</span>(element.<span class="property">id</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ¯æ¬¡ç‚¹å‡»çš„æ—¶å€™è¦æ¸…é™¤multipleSelection</p>
<br>

<p>okäº†ï¼Œä¸€äº›å¸¸è§çš„å¢åˆ æ”¹æŸ¥æ“ä½œå·²ç»æ€»ç»“å®Œæ¯•ï¼Œå¦‚æœåç»­å‡ºç°æ–°çš„æƒ…å†µï¼Œä¼šè¿›è¡Œè¡¥å……çš„ğŸƒ</p>
]]></content>
      <categories>
        <category>vue</category>
        <category>vue-element-admin</category>
        <category>javaé¡¹ç›®</category>
        <category>æ±½è½¦ç§Ÿèµç®¡ç†ç³»ç»Ÿ</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>vue-element-admin</tag>
      </tags>
  </entry>
  <entry>
    <title>GitHub Page + Hexo åˆ›å»ºä¸ªäººåšå®¢</title>
    <url>/2025/04/14/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</url>
    <content><![CDATA[<p>ä»‹ç»ï¼š ç¼–å†™mdæ ¼å¼æ–‡ä»¶ï¼Œä½¿ç”¨ <em><strong>Hexo</strong></em> æ¸²æŸ“æˆé™æ€ç½‘é¡µæ–‡ä»¶ï¼Œç”¨<em><strong>git</strong></em>ä¸Šä¼ è‡³githubä»“åº“ï¼ˆä»“åº“åå³ç”¨æˆ·åï¼‰ï¼Œå¯ç”± <em><strong>ä»“åº“å.github.io</strong></em> åœ°å€è®¿é—®ã€‚</p>
<br>

<h4 id="ä¸€-åˆæ¬¡ä½¿ç”¨ï¼š"><a href="#ä¸€-åˆæ¬¡ä½¿ç”¨ï¼š" class="headerlink" title="ä¸€. åˆæ¬¡ä½¿ç”¨ï¼š"></a>ä¸€. åˆæ¬¡ä½¿ç”¨ï¼š</h4><ol>
<li><p>ç¯å¢ƒå‡†å¤‡ï¼š</p>
<p>git</p>
<p>nodeï¼ˆç‰ˆæœ¬14.0.0+ï¼‰</p>
<br>
</li>
<li><p>Hexoå®‰è£…ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>åˆå§‹åŒ–æ¡†æ¶, åˆ›å»ºå·¥ä½œæ–‡ä»¶å¤¹test:</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm init test;</span><br><span class="line">npm install; // å®‰è£…æ¡†æ¶æ‰€éœ€</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>ç”Ÿæˆé™æ€ç½‘é¡µ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure></li>
</ol>
<br>

<ol start="5">
<li><p>å¯åŠ¨æœåŠ¡</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure></li>
</ol>
<br>

<p>â€‹	è®¿é—® 127.0.0.1:4000 æŸ¥çœ‹é¡µé¢æ•ˆæœã€‚</p>
<br>

<br>

<h4 id="äºŒ-Nextä¸»é¢˜"><a href="#äºŒ-Nextä¸»é¢˜" class="headerlink" title="äºŒ. Nextä¸»é¢˜:"></a>äºŒ. Nextä¸»é¢˜:</h4><ol>
<li><p>ä¸‹è½½nextä¸»é¢˜ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd test</span><br><span class="line">git clone https://github.com/iissnan/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>_config.yml æ–‡ä»¶æ‰¾åˆ° theme, æ›´æ”¹ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">theme:</span> <span class="string">next</span></span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>é€‰æ‹©ä¸»é¢˜å½¢å¼ï¼š åœ¨&#x2F;theme&#x2F;next&#x2F;_config.ymlæ‰¾åˆ° scheme</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Schemes</span></span><br><span class="line"><span class="comment"># scheme: Muse</span></span><br><span class="line"><span class="comment"># scheme: Mist</span></span><br><span class="line"><span class="comment"># scheme: Pisces</span></span><br><span class="line"><span class="attr">scheme:</span> <span class="string">Gemini</span>  <span class="comment"># æ¨è</span></span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>è®¾ç½®è¯­è¨€ï¼šåœ¨_config.ymlä¸­æ‰¾åˆ° languageï¼Œ è®¾ç½®ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">language:</span> <span class="string">zh-Hans</span> <span class="comment"># é»˜è®¤en</span></span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>è®¾ç½®èœå•ï¼š åœ¨&#x2F;theme&#x2F;next&#x2F;_config.ymlæ‰¾åˆ° menu</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">/</span>              <span class="comment"># é¦–é¡µ</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">/archives</span>  <span class="comment"># å½’æ¡£</span></span><br><span class="line">  <span class="comment">#about: /about</span></span><br><span class="line">  <span class="comment">#categories: /categories</span></span><br><span class="line">  <span class="comment">#tags: /tags</span></span><br><span class="line">  <span class="comment">#commonweal: /404.html</span></span><br></pre></td></tr></table></figure>

<br>

<p><img src="/images/menu.png" alt="menu"></p>
<br>

<p>è‹¥ä½ çš„ç«™ç‚¹è¿è¡Œåœ¨å­ç›®å½•ä¸­ï¼Œè¯·å°†é“¾æ¥å‰ç¼€çš„ &#x2F; å»æ‰</p>
</li>
</ol>
<br>

<br>

<h4 id="ä¸‰-ä¿®æ”¹ä¸ªäººä¿¡æ¯"><a href="#ä¸‰-ä¿®æ”¹ä¸ªäººä¿¡æ¯" class="headerlink" title="ä¸‰. ä¿®æ”¹ä¸ªäººä¿¡æ¯"></a>ä¸‰. ä¿®æ”¹ä¸ªäººä¿¡æ¯</h4><ol>
<li><p>ç¼–è¾‘_config.ymlï¼Œ è®¾ç½®authorï¼Œtitle,  subtitle, descriptionç­‰:</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">yourTitle</span>   <span class="comment">#æ ‡é¢˜</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">&#x27;&#x27;</span>       <span class="comment">#å‰¯æ ‡é¢˜</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="attr">keywords:</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">you</span>        <span class="comment">#ä½œè€…</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-Hans</span>  <span class="comment">#è¯­è¨€</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">&#x27;Asia/Shanghai&#x27;</span> <span class="comment">#æ—¶åŒº</span></span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>è®¾ç½®å¤´åƒï¼š åœ¨sourceæ–‡ä»¶å¤¹ä¸‹åˆ›å»º imageæ–‡ä»¶å¤¹ï¼Œæ”¾ç½®å›¾ç‰‡</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">avatar:</span> <span class="string">/images/åšå®¢å¤´åƒ.png</span>  <span class="comment"># /images/å›¾ç‰‡.png   å›¾ç‰‡çš„æ ¼å¼ </span></span><br></pre></td></tr></table></figure>

<br></li>
</ol>
<br>

<h4 id="å››-ç¼–å†™æ–‡ç« "><a href="#å››-ç¼–å†™æ–‡ç« " class="headerlink" title="å››. ç¼–å†™æ–‡ç« "></a>å››. ç¼–å†™æ–‡ç« </h4><p>ç¼–å†™mdæ ¼å¼æ–‡ç« ï¼Œæ”¾åœ¨ source&#x2F;_posts æ–‡ä»¶å¤¹ä¸‹</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo new &quot;post title&quot; # åˆ›å»ºæ–‡ç« ï¼Œé»˜è®¤mdæ ¼å¼</span><br><span class="line">host g  # å…¨éƒ¨åŸæ–‡ç« æ¸²æŸ“åˆ°publicé™æ€ç›®å½•</span><br></pre></td></tr></table></figure>

<br>

<br>

<h4 id="äº”-ä¸Šä¼ è‡³github"><a href="#äº”-ä¸Šä¼ è‡³github" class="headerlink" title="äº”. ä¸Šä¼ è‡³github"></a>äº”. ä¸Šä¼ è‡³github</h4><ol>
<li><p>å®‰è£…ä¸€é”®éƒ¨ç½²æ’ä»¶ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>_config.ymlä¸­æ·»åŠ éƒ¨ç½²é…ç½®ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:&lt;username&gt;/&lt;project&gt;</span></span><br><span class="line">  <span class="comment">#example,https://github.com/hexojs/hexojs.github.io</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span>  <span class="comment"># ä¸Šä¼ githubä»“åº“åˆ†æ”¯ï¼Œå¯æ›´æ”¹</span></span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>ä¸Šä¼ ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>è®¿é—®åœ°å€ï¼šyourUserName.github.io  (æ³¨æ„ä½ ä¸Šä¼ çš„ä»“åº“åå’Œä½ çš„githubçš„ç”¨æˆ·åå¿…é¡»ç›¸åŒï¼)</p>
</li>
</ol>
<br>

<p>æ­å–œä½ å·²ç»åˆ›å»ºäº†å±äºä½ çš„åšå®¢ã€‚</p>
]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>åˆ›å»ºåšå®¢</tag>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>é˜¿é‡Œäº‘OSS</title>
    <url>/2025/04/20/%E9%98%BF%E9%87%8C%E4%BA%91OSS/</url>
    <content><![CDATA[<p>ä»‹ç»ï¼š æœ‰æ—¶ï¼Œæˆ‘ä»¬å°†å›¾ç‰‡ç­‰é™æ€èµ„æºå­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šï¼Œä½†å½“å›¾ç‰‡å¤šæ—¶ï¼Œç½‘ç«™åŠ è½½å›¾ç‰‡ç­‰é™æ€èµ„æºçš„æ—¶é—´ä¼šå˜é•¿ï¼ŒæœåŠ¡ä½“æ£€å°±ä¼šæ‰“æŠ˜æ‰£ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ©é˜¿é‡Œäº‘ç­‰äº‘æœåŠ¡çš„å¯¹è±¡å­˜å‚¨æœåŠ¡ç›´æ¥ä¸Šä¼ å›¾ç‰‡ï¼Œåœ¨ç½‘ç«™htmlé¡µé¢å¼•ç”¨å›¾ç‰‡åœ°å€å³å¯ã€‚<img src="https://dl4.weshineapp.com/gif/20161214/413c2f733a5e0583da34fd30c3a3d223.gif?f=micro_5bCP6KGo5oOF" alt="img"></p>
<br>

<br>

<p>springbootå¦‚ä½•ä»‹å…¥aliyun OSSæœåŠ¡å‘¢?  é‚£ä¹ˆç°åœ¨å¼€å§‹å§</p>
<br>

<ol>
<li><p>é¦–å…ˆæ˜¯åœ¨ springboot é…ç½®æ–‡ä»¶ application.yml ä¸­åŠ å…¥ä»¥ä¸‹:</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">aliyun:</span></span><br><span class="line">  <span class="attr">oss:</span></span><br><span class="line">    <span class="attr">endpoint:</span></span><br><span class="line">    <span class="attr">access-key-id:</span></span><br><span class="line">    <span class="attr">access-key-secret:</span></span><br><span class="line">    <span class="attr">bucket-name:</span></span><br></pre></td></tr></table></figure>

<p>éœ€è¦æ³¨å†Œé˜¿é‡Œäº‘çš„OSSæœåŠ¡æ‰å¯ä»¥æœ‰bucket-nameå’Œendpoint, èº«ä»½è®¤è¯çš„ä¸¤ä¸ªå±æ€§ï¼šaccess-key-id å’Œ access-key-secret</p>
<br>

<br>
</li>
<li><p>å†æŠŠå®ƒå°è£…æˆä¸€ä¸ªå¯¹è±¡OSSConfig, æ–¹ä¾¿æ“ä½œğŸ‘</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OSSConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;aliyun.oss.endpoint&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String endpoint;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;aliyun.oss.access-key-id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String accessKeyId;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;aliyun.oss.access-key-secret&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String accessKeySecret;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;aliyun.oss.bucket-name&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String bucketName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<br>
</li>
<li><p>å†å°±æ˜¯åˆ›å»ºä¸€ä¸ªæ¥å£åŠå…¶å®ç°ç±»ï¼Œå®Œæˆå›¾ç‰‡çš„ä¸Šä¼ å’Œåˆ é™¤é€»è¾‘ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å…ˆåˆ›å»ºIOssServiceï¼Œå®šä¹‰ä¸Šä¼ å’Œåˆ é™¤æ–¹æ³•</span></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.util.StrUtil;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.oss.OSS;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.oss.OSSClientBuilder;</span><br><span class="line"><span class="keyword">import</span> com.coder.rental.config.OSSConfig;</span><br><span class="line"><span class="keyword">import</span> com.coder.rental.service.IOssService;</span><br><span class="line"><span class="keyword">import</span> com.coder.rental.utils.FileUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.multipart.MultipartFile;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OssServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">IOssService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OSSConfig ossConfig;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">upload</span><span class="params">(MultipartFile file)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">originalFilename</span> <span class="operator">=</span> file.getOriginalFilename();</span><br><span class="line">        <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> FileUtils.getFileName(originalFilename);</span><br><span class="line">        <span class="type">OSS</span> <span class="variable">ossClient</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OSSClientBuilder</span>().build(</span><br><span class="line">                ossConfig.getEndpoint(),</span><br><span class="line">                ossConfig.getAccessKeyId(),</span><br><span class="line">                ossConfig.getAccessKeySecret()</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// å®Œæˆä¸Šä¼ å¤„ç†</span></span><br><span class="line">            ossClient.putObject(ossConfig.getBucketName(), fileName, file.getInputStream());</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;https://&quot;</span> + ossConfig.getBucketName() + <span class="string">&quot;.&quot;</span> +  ossConfig.getEndpoint() + <span class="string">&quot;/&quot;</span> + fileName;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;ä¸Šä¼ æ–‡ä»¶å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (ossClient != <span class="literal">null</span>) &#123;</span><br><span class="line">                ossClient.shutdown();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">delete</span><span class="params">(String url)</span> &#123;</span><br><span class="line">        <span class="type">OSS</span> <span class="variable">ossClient</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OSSClientBuilder</span>().build(</span><br><span class="line">                ossConfig.getEndpoint(),</span><br><span class="line">                ossConfig.getAccessKeyId(),</span><br><span class="line">                ossConfig.getAccessKeySecret()</span><br><span class="line">        );</span><br><span class="line">        <span class="type">String</span> <span class="variable">host</span> <span class="operator">=</span> <span class="string">&quot;https://&quot;</span> + ossConfig.getBucketName() + <span class="string">&quot;.&quot;</span> + ossConfig.getEndpoint() + <span class="string">&quot;/&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">objectName</span> <span class="operator">=</span> StrUtil.removePrefix(url, host);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ossClient.deleteObject(ossConfig.getBucketName(), objectName);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;åˆ é™¤å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (ossClient != <span class="literal">null</span>) &#123;</span><br><span class="line">                ossClient.shutdown();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<br>
</li>
<li><p>æœ€åå°±æ˜¯ controller å±‚çš„è°ƒç”¨äº†</p>
<br>

<br>

<p>å°±æ˜¯è¿™ä¹ˆç®€å•<img src="https://dl4.weshineapp.com/gif/20220109/04099f6774f94c95bfd233c841b3acc7.gif?f=micro_" alt="img" style="zoom:25%;" /></p>
</li>
</ol>
]]></content>
      <categories>
        <category>äº‘æœåŠ¡</category>
        <category>é˜¿é‡Œäº‘OSS</category>
      </categories>
      <tags>
        <tag>é˜¿é‡Œäº‘OSS</tag>
      </tags>
  </entry>
  <entry>
    <title>vue-element-adminåˆå§‹æ­å»º</title>
    <url>/2025/04/23/vue-element-admin%E5%88%9D%E5%A7%8B%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<p>ä»‹ç»ï¼š åˆå§‹æ­å»ºæ˜¯åœ¨åç«¯çš„è®¿é—®æƒé™æ¨¡å—å®Œæˆä¹‹åè¿›è¡Œçš„ï¼Œä¸»è¦å†…å®¹ä¸ºç™»å½•é€€å‡ºï¼Œèœå•è·¯ç”±å¯¼èˆªè¿™ä¸¤éƒ¨åˆ†ï¼Œæ„å»ºä¸€ä¸ªå¤§ä½“æ¡†æ¶ï¼Œä¹‹åå†…å®¹çš„ç¼–å†™å°±åªéœ€æ³¨é‡å†…å®¹æœ¬èº«å³å¯ã€‚</p>
<br>

<h3 id="ä¸€-vue-element-adminå®‰è£…"><a href="#ä¸€-vue-element-adminå®‰è£…" class="headerlink" title="ä¸€. vue-element-adminå®‰è£…"></a>ä¸€. <a href="https://panjiachen.github.io/vue-element-admin-site/zh/guide/#%E5%AE%89%E8%A3%85">vue-element-adminå®‰è£…</a></h3><br>

<br>

<h3 id="äºŒ-åç«¯"><a href="#äºŒ-åç«¯" class="headerlink" title="äºŒ.åç«¯"></a>äºŒ.åç«¯</h3><ol>
<li><p>ç”¨æˆ·ç™»å½•è·å–è¯¥ç”¨æˆ·ä¿¡æ¯(id, ç”¨æˆ·å, å¤´åƒ, è§’è‰²åç§°æ•°ç»„)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/getInfo&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">getUserInfo</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// ä»securityContextHolderä¸Šä¸‹æ–‡ä¸­è·å–è®¤è¯ä¿¡æ¯</span></span><br><span class="line">    <span class="type">Authentication</span> <span class="variable">authentication</span> <span class="operator">=</span></span><br><span class="line">        SecurityContextHolder.getContext().getAuthentication();</span><br><span class="line">    <span class="keyword">if</span> (authentication == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> Result.fail().setMessage(<span class="string">&quot;è®¤è¯ä¿¡æ¯ä¸ºç©º&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) authentication.getPrincipal();</span><br><span class="line">    <span class="comment">// æŸ¥è¯¢ç”¨æˆ·è§’è‰²åç§°</span></span><br><span class="line">    <span class="comment">/*List&lt;String&gt; list = userService.selectRoleName(user.getId());</span></span><br><span class="line"><span class="comment">Â  Â  Â  Â Object[] array = list.toArray(); */</span><span class="comment">// å°†è§’è‰²åç§°åˆ—è¡¨è½¬æ¢ä¸ºæ•°ç»„</span></span><br><span class="line">    List&lt;Permission&gt; permissionList = user.getPermissionList();</span><br><span class="line">    Object[] array = permissionList.stream().filter(Objects::nonNull)</span><br><span class="line">        .map(Permission::getPermissionCode)</span><br><span class="line">        .toArray();</span><br><span class="line">    <span class="comment">// åˆ›å»ºå¹¶å¡«å……ç”¨æˆ·ä¿¡æ¯è§†å›¾å¯¹è±¡</span></span><br><span class="line">    <span class="type">UserInfoVo</span> <span class="variable">userInfoVo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserInfoVo</span>(user.getId(),</span><br><span class="line">                                           user.getUsername(),</span><br><span class="line">                                           user.getAvatar(), user.getNickname(), array);</span><br><span class="line">    <span class="keyword">return</span> Result.success(userInfoVo).setMessage(<span class="string">&quot;è·å–ç”¨æˆ·ä¿¡æ¯æˆåŠŸ&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„è§’è‰²æ•°ç»„è¦ç”¨ Permission ä¸­çš„ permissionCode</p>
<br>
</li>
<li><p>å‚ç…§<strong>router-&gt;index.js</strong>ä¸­çš„è·¯ç”±é€‰é¡¹ï¼Œç¼–å†™<strong>routerVO</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/error&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Layout</span>,</span><br><span class="line">    <span class="attr">redirect</span>: <span class="string">&#x27;noRedirect&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;ErrorPages&#x27;</span>,</span><br><span class="line">    <span class="attr">meta</span>: &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;Error Pages&#x27;</span>,</span><br><span class="line">      <span class="attr">icon</span>: <span class="string">&#x27;404&#x27;</span>,</span><br><span class="line">      <span class="attr">roles</span>: [<span class="string">&#x27;admin&#x27;</span>, <span class="string">&#x27;editor&#x27;</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;401&#x27;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/error-page/401&#x27;</span>),</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;Page401&#x27;</span>,</span><br><span class="line">        <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;401&#x27;</span>, <span class="attr">noCache</span>: <span class="literal">true</span> &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;404&#x27;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/error-page/404&#x27;</span>),</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;Page404&#x27;</span>,</span><br><span class="line">        <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;404&#x27;</span>, <span class="attr">noCache</span>: <span class="literal">true</span> &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@JsonInclude(JsonInclude.Include.NON_EMPTY)</span> <span class="comment">// æ³¨æ„åŠ ä¸Šè¯¥æ³¨è§£ï¼Œä¸åºåˆ—åŒ–ç©ºchildren</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RouteVO</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String path;</span><br><span class="line">    <span class="keyword">private</span> String component;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Boolean alwaysShow;</span><br><span class="line">    <span class="keyword">private</span> Meta meta;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;RouteVO&gt; children;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Data</span></span><br><span class="line">    <span class="meta">@NoArgsConstructor</span></span><br><span class="line">    <span class="meta">@AllArgsConstructor</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Meta</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String title;</span><br><span class="line">        <span class="keyword">private</span> String icon;</span><br><span class="line">        <span class="keyword">private</span> String[] roles;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>æ ¹æ®æƒé™åˆ—è¡¨ï¼Œç»è¿‡è·¯ç”±èœå•å·¥å…·ç±»è·å–è·¯ç”±ä¿¡æ¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/menuList&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">getMenuList</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    <span class="type">Authentication</span> <span class="variable">authentication</span> <span class="operator">=</span></span><br><span class="line">        SecurityContextHolder.getContext().getAuthentication();</span><br><span class="line">    <span class="keyword">if</span> (authentication == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> Result.fail().setMessage(<span class="string">&quot;è®¤è¯ä¿¡æ¯ä¸ºç©º&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) authentication.getPrincipal();</span><br><span class="line">    <span class="comment">//è·å–ç”¨æˆ·çš„æƒé™åˆ—è¡¨</span></span><br><span class="line">    List&lt;Permission&gt; permissionList = user.getPermissionList();</span><br><span class="line">    <span class="comment">//è·å–ç”¨æˆ·çš„èœå•</span></span><br><span class="line">    <span class="comment">//å°†permission_typeä¸º2çš„æŒ‰é’®ç§»é™¤ï¼Œä¸éœ€è¦ç”Ÿæˆå¯¹åº”çš„èœå•</span></span><br><span class="line">    permissionList.removeIf(permission -&gt;</span><br><span class="line">                            Objects.equals(permission.getPermissionType(), <span class="number">2</span>));</span><br><span class="line">    List&lt;RouteVO&gt; routeVOList =</span><br><span class="line">        RouteTreeUtils.buildRouteTree(permissionList, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> Result.success(routeVOList).setMessage(<span class="string">&quot;è·å–èœå•åˆ—è¡¨æˆåŠŸ&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>é€€å‡ºç™»å½•æ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/logout&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">logout</span><span class="params">(HttpServletRequest request, HttpServletResponse</span></span><br><span class="line"><span class="params">                     response)</span>&#123;</span><br><span class="line">    String token=request.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (StrUtil.isEmpty(token))&#123;</span><br><span class="line">        token=request.getParameter(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">Authentication</span> <span class="variable">authentication</span> <span class="operator">=</span></span><br><span class="line">        SecurityContextHolder.getContext().getAuthentication();</span><br><span class="line">    <span class="keyword">if</span> (authentication!=<span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="comment">//ç”¨æˆ·ä¸€æ—¦ç™»å‡ºç³»ç»Ÿï¼Œåˆ™æ¸…é™¤redisä¸­çš„token</span></span><br><span class="line">        redisUtils.del(<span class="string">&quot;token:&quot;</span>+token);</span><br><span class="line">        <span class="type">SecurityContextLogoutHandler</span> <span class="variable">handler</span> <span class="operator">=</span> <span class="keyword">new</span></span><br><span class="line">            <span class="title class_">SecurityContextLogoutHandler</span>();</span><br><span class="line">        handler.logout(request,response,authentication);</span><br><span class="line">        <span class="keyword">return</span> Result.success().setMessage(<span class="string">&quot;ç™»å‡ºæˆåŠŸ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Result.fail().setMessage(<span class="string">&quot;ç™»å‡ºå¤±è´¥&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>è¿™ä¸ªæ—¶å€™åç«¯å°±å®Œæˆäº†ï¼Œæ€»ç»“ä»¥ä¸‹åç«¯å®Œæˆå†…å®¹å§ğŸƒï¼š</p>
<p>ï¼ˆ1ï¼‰è·å–ç”¨æˆ·ä¿¡æ¯  ï¼ˆ2ï¼‰è·å–è·¯ç”±ä¿¡æ¯   ï¼ˆ3ï¼‰é€€å‡ºç™»å½•</p>
</li>
</ol>
<br>

<br>

<h3 id="ä¸‰-å‰ç«¯ä¹‹ç™»å½•é€€å‡º"><a href="#ä¸‰-å‰ç«¯ä¹‹ç™»å½•é€€å‡º" class="headerlink" title="ä¸‰.å‰ç«¯ä¹‹ç™»å½•é€€å‡º"></a>ä¸‰.å‰ç«¯ä¹‹ç™»å½•é€€å‡º</h3><br>

<ol>
<li>å¥½çš„ï¼Œæˆ‘ä»¬ç°åœ¨å¼€å§‹å‰ç«¯éƒ¨åˆ†ï¼Œé¦–å…ˆæ˜¯å‰ç«¯ç™»å½•ï¼šå…ˆç¨å¾®ä¿®æ”¹ä¸€ä¸‹å‰ç«¯é¡µé¢ğŸ˜ï¼Œç„¶åå°±æœ‰ä¸€ä¸ªé—®é¢˜äº†ï¼Œæ€ä¹ˆè®©å‰ç«¯å‘é€ç™»å½•è¯·æ±‚åˆ°åç«¯å‘¢ï¼Ÿæˆ‘ä»¬æ¥è§£å†³ï¼š</li>
</ol>
<br>

<p>ï¼ˆ1ï¼‰å…ˆä¿®æ”¹ä»¥ä¸‹å¼€å‘ç¯å¢ƒ**.env.development<strong>å’Œç”Ÿäº§ç¯å¢ƒ</strong>.env.production**çš„æ–‡ä»¶ï¼š</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">VUE_APP_BASE_API</span> = <span class="string">&#x27;http://localhost:8888/&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<p>ï¼ˆ2ï¼‰ ç„¶åä¿®æ”¹å‘é€è¯·æ±‚çš„æ–‡ä»¶<strong>request.js</strong>:</p>
<br>

<p>â€‹	å®‰è£…qsä¾èµ–ï¼Œå®ç°å‚æ•°åºåˆ—åŒ–å¤„ç†ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install qs</span><br></pre></td></tr></table></figure>

<br>

<p>â€‹	ä¿®æ”¹serviceï¼Œç”¨ <strong>process.env.VUE_APP_BASE_API</strong> æ¥è¡¨ç¤ºè¦å‘é€çš„æœåŠ¡å™¨åŠå…¶ç«¯å£</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// create an axios instance</span></span><br><span class="line"><span class="keyword">const</span> service = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">    <span class="attr">baseURL</span>: process.<span class="property">env</span>.<span class="property">VUE_APP_BASE_API</span>, <span class="comment">// url = base url + request url</span></span><br><span class="line">    <span class="comment">// withCredentials: true, // send cookies when cross-domain requests</span></span><br><span class="line">    <span class="attr">timeout</span>: <span class="number">5000</span> <span class="comment">// request timeout</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¥ä¸‹æ¥å°±æ˜¯requestæ‹¦æˆª, åœ¨Headerä¸­æ”¾ç½®token</span></span><br><span class="line"><span class="comment">// responseæ‹¦æˆªï¼Œåˆ¤æ–­å“åº”codeæ¥åšå¤„ç†</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰requestHttp,ç”¨äºå‘é€è¯·æ±‚ï¼šget, post, put, delete, upload, login</span></span><br><span class="line"><span class="comment">// ä¸‹é¢ä»¥postä¸ºä¾‹ï¼š</span></span><br><span class="line"><span class="title function_">post</span>(<span class="params">url,params</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> service.<span class="title function_">post</span>(</span><br><span class="line">        url, params, &#123;</span><br><span class="line">            <span class="attr">transformRequest</span>: [<span class="function">(<span class="params">params</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(params)</span><br><span class="line">            &#125;],</span><br><span class="line">            <span class="attr">headers</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// serviceçš„postæ–¹æ³•å‘é€çš„urlå‚æ•°å’Œè‡ªèº«å®šä¹‰æ—¶çš„baseUrlç›¸ç»“åˆã€‚</span></span><br></pre></td></tr></table></figure>

<br>

<p>å¥½çš„ï¼Œæˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹å‘é€è¯·æ±‚çš„é—®é¢˜å§ï¼Œå‘é€è¯·æ±‚çš„æ–¹å¼æ˜¯<strong>Axios</strong>ï¼Œå®šä¹‰<strong>service</strong>æ—¶è®¾ç½®<strong>baseURL</strong>ä¸ºæœåŠ¡å™¨åŠå…¶ç«¯å£ï¼Œåç»­è°ƒç”¨serviceæ–¹æ³•è¯·æ±‚æ—¶ï¼Œä¼ å…¥è¯·æ±‚è·¯å¾„ï¼ˆåœ¨baseURLçš„åŸºç¡€ä¸Šï¼‰å’Œå‚æ•°å³å¯ã€‚</p>
<br>

<p>ï¼ˆ3ï¼‰æˆ‘ä»¬ææ¸…æ¥šè¯·æ±‚è·¯å¾„ä¹‹åå°±å¯ä»¥åœ¨<strong>api&#x2F;user.js</strong>ä¸­å®šä¹‰è¯·æ±‚æ–¹æ³•ç”¨äºè·å–ç”¨æˆ·ä¿¡æ¯å’Œè·¯ç”±ä¿¡æ¯äº†</p>
<br>

<p>ï¼ˆ4ï¼‰ ç™»å½•çš„æœ€åéƒ¨åˆ†ï¼Œè¿˜æœ‰ä¸€äº›å°ç»†èŠ‚éœ€è¦ä¿®æ”¹â•°(<em>Â°â–½Â°</em>)â•¯ï¼š è¿”å›çš„tokenéœ€è¦å­˜å‚¨å‘€ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; getToken, setToken, removeToken &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/auth&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">  <span class="attr">token</span>: <span class="title function_">getToken</span>(),</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">avatar</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">introduction</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">roles</span>: [],</span><br><span class="line">  <span class="attr">createrId</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">  <span class="attr">SET_TOKEN</span>: <span class="function">(<span class="params">state, token</span>) =&gt;</span> &#123;</span><br><span class="line">    state.<span class="property">token</span> = token</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// user login</span></span><br><span class="line"><span class="title function_">login</span>(<span class="params">&#123; commit &#125;, userInfo</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; username, password &#125; = userInfo</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">login</span>(&#123; <span class="attr">username</span>: username.<span class="title function_">trim</span>(), <span class="attr">password</span>: password &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123; token &#125; = response</span><br><span class="line">            <span class="title function_">commit</span>(<span class="string">&#x27;SET_TOKEN&#x27;</span>, token)</span><br><span class="line">            <span class="title function_">setToken</span>(token)</span><br><span class="line">            <span class="title function_">resolve</span>()</span><br><span class="line">        &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">reject</span>(error)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>ç™»å½•æˆåŠŸåï¼Œ<strong>state</strong>å°±å¯ä»¥å­˜å‚¨userä¿¡æ¯äº†</p>
<br>

<br>

<ol start="2">
<li><p>é‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯é€€å‡ºç™»å½•äº†:</p>
<br>

<p>ï¼ˆ1ï¼‰åœ¨ api&#x2F;user.js ä¸­å®šä¹‰é€€å‡ºæ–¹æ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">logout</span>(<span class="params">param</span>)&#123;</span><br><span class="line">Â <span class="keyword">return</span> <span class="keyword">await</span> requestHttp.<span class="title function_">post</span>(<span class="string">&#x27;/rental/auth/logout&#x27;</span>,param)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<p>ï¼ˆ2ï¼‰åœ¨ utils&#x2F;auth.js ä¸­å®šä¹‰æ¸…é™¤ sessionStorage æ–¹æ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">removeSessionStoreage</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">sessionStorage</span>.<span class="title function_">clear</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<p>ï¼ˆ3ï¼‰ ä¿®æ”¹ layout&#x2F;components&#x2F;Navbar.vue æ–‡ä»¶ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;logout&#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/user&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;getToken, removeToken, removeSessionStorage&#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/auth&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">logout</span>(<span class="params"></span>) &#123;</span><br><span class="line">Â  Â  Â  <span class="comment">//ä¿®æ”¹logoutæ–¹æ³•</span></span><br><span class="line">Â  Â  Â <span class="comment">//await this.$store.dispatch(&#x27;user/logout&#x27;)</span></span><br><span class="line">Â  Â  Â <span class="comment">//this.$router.push(`/login?redirect=$&#123;this.$route.fullPath&#125;`)</span></span><br><span class="line">Â  Â  Â <span class="variable language_">this</span>.$confirm(<span class="string">&#x27;ç¡®å®šé€€å‡ºç³»ç»Ÿå—?&#x27;</span>, <span class="string">&#x27;æç¤º&#x27;</span>, &#123;</span><br><span class="line">Â  Â  Â  Â <span class="attr">confirmButtonText</span>: <span class="string">&#x27;ç¡®å®š&#x27;</span>,</span><br><span class="line">Â  Â  Â  Â <span class="attr">cancelButtonText</span>: <span class="string">&#x27;å–æ¶ˆ&#x27;</span>,</span><br><span class="line">Â  Â  Â  Â <span class="attr">type</span>: <span class="string">&#x27;warning&#x27;</span></span><br><span class="line">Â  Â  &#125;).<span class="title function_">then</span>(<span class="title function_">async</span>() =&gt; &#123;</span><br><span class="line">Â  Â  Â  Â <span class="keyword">let</span> token = &#123; <span class="attr">token</span>: getToken &#125;    <span class="comment">// è·å–token</span></span><br><span class="line">Â  Â  Â  Â <span class="keyword">let</span> res = <span class="keyword">await</span> <span class="title function_">logout</span>(token)      <span class="comment">// è°ƒç”¨é€€å‡ºç™»å½•æ–¹æ³•</span></span><br><span class="line">Â  Â  Â  Â <span class="keyword">if</span> (res.<span class="property">success</span>)&#123;</span><br><span class="line">Â  Â  Â  Â  Â <span class="title function_">removeToken</span>()	<span class="comment">// å»é™¤token</span></span><br><span class="line">Â  Â  Â  Â  Â <span class="title function_">removeSessionStoreage</span>() Â  Â <span class="comment">// æ¸…é™¤SessionStoreage Â  Â </span></span><br><span class="line">Â  Â  Â  Â  Â <span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(<span class="string">`/login?redirect=<span class="subst">$&#123;<span class="variable language_">this</span>.$route.fullPath&#125;</span>`</span>)</span><br><span class="line">Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;).<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">Â  Â  Â  Â <span class="variable language_">this</span>.$message(&#123;</span><br><span class="line">Â  Â  Â  Â  Â <span class="attr">type</span>: <span class="string">&#x27;info&#x27;</span>,</span><br><span class="line">Â  Â  Â  Â  Â <span class="attr">message</span>: <span class="string">&#x27;å·²å–æ¶ˆé€€å‡º&#x27;</span></span><br><span class="line">Â  Â  Â  &#125;);</span><br><span class="line">Â  Â &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<br>

<h3 id="å‰ç«¯ä¹‹åŠ¨æ€è·¯ç”±èœå•"><a href="#å‰ç«¯ä¹‹åŠ¨æ€è·¯ç”±èœå•" class="headerlink" title="å‰ç«¯ä¹‹åŠ¨æ€è·¯ç”±èœå•"></a>å‰ç«¯ä¹‹åŠ¨æ€è·¯ç”±èœå•</h3><p>ç™»å½•æ—¶è·å–äº†ç”¨æˆ·ä¿¡æ¯å’Œè·¯ç”±ä¿¡æ¯ï¼Œå…¶ä¸­ç”¨æˆ·ä¿¡æ¯å­˜å‚¨åœ¨ store&#x2F;modules&#x2F;user.js çš„stateä¸­ï¼Œè€Œè·å–çš„è·¯ç”±ä¿¡æ¯å¾—è½¬åŒ–ä¸ºåŠ¨æ€è·¯ç”±èœå•ï¼Œå¥½çš„ï¼Œç°åœ¨æˆ‘ä»¬æ¥å¼€å§‹è¿™ä¸€éƒ¨åˆ†ï¼š</p>
<br>

<ol>
<li><p>åœ¨ api&#x2F;user.js ä¸­ï¼Œå†™è·å–èœå•çš„æ–¹æ³•:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getMenuList</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> requestHttp.<span class="title function_">get</span>(<span class="string">&#x27;/rental/auth/menuList&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>ä¿®æ”¹ store&#x2F;permission.js æ–‡ä»¶ï¼Œå®ç°åŠ¨æ€è·¯ç”±èœå•</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">    <span class="title function_">generateRoutes</span>(<span class="params">&#123; commit &#125;, roles</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">getMenuList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (response.<span class="property">code</span> === <span class="number">200</span>) &#123;</span><br><span class="line">                    <span class="keyword">const</span> accessedRoutes = <span class="title function_">filterAsyncRoutes</span>(response.<span class="property">data</span>, roles)</span><br><span class="line">                    <span class="title function_">commit</span>(<span class="string">&#x27;SET_ROUTES&#x27;</span>, accessedRoutes)</span><br><span class="line">                    <span class="title function_">resolve</span>(accessedRoutes)  <span class="comment">// è¿›è¡Œç´¢å¼•å¯¼èˆª</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="title function_">reject</span>(response.<span class="property">msg</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;).<span class="title function_">catch</span>(</span><br><span class="line">                <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="title function_">reject</span>(error)</span><br><span class="line">                &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­¤æ—¶getMenuList()çš„response.dataè¦ç»è¿‡filterAsyncRoutesé€’å½’å¤„ç†</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">filterAsyncRoutes</span>(<span class="params">routes, roles</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> res = []</span><br><span class="line">    routes.<span class="title function_">forEach</span>(<span class="function"><span class="params">route</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> tmp = &#123; ...route &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">hasPermission</span>(roles, tmp)) &#123;</span><br><span class="line">            <span class="keyword">let</span> component = tmp.<span class="property">component</span>  <span class="comment">// ç»„ä»¶å¯¹åº”permissionä¸­çš„route_url</span></span><br><span class="line">            <span class="keyword">if</span> (route.<span class="property">component</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (component === <span class="string">&#x27;Layout&#x27;</span>) &#123;</span><br><span class="line">                    tmp.<span class="property">component</span> = <span class="title class_">Layout</span>  <span class="comment">// é»˜è®¤å¸ƒå±€å·²ç»å­˜åœ¨è¯¥ç»„ä»¶</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    tmp.<span class="property">component</span> = <span class="function">(<span class="params">resolve</span>) =&gt;</span> <span class="built_in">require</span>([<span class="string">`@/views<span class="subst">$&#123;component&#125;</span>`</span>],</span><br><span class="line">                                                         resolve)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (tmp.<span class="property">children</span>) &#123;</span><br><span class="line">                tmp.<span class="property">children</span> = <span class="title function_">filterAsyncRoutes</span>(tmp.<span class="property">children</span>, roles)</span><br><span class="line">            &#125;</span><br><span class="line">            res.<span class="title function_">push</span>(tmp)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">    <span class="attr">SET_ROUTES</span>: <span class="function">(<span class="params">state, routes</span>) =&gt;</span> &#123;</span><br><span class="line">        state.<span class="property">addRoutes</span> = routes</span><br><span class="line">        state.<span class="property">routes</span> = constantRoutes.<span class="title function_">concat</span>(routes)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»è¿‡å¤„ç†åçš„routesä¿å­˜åœ¨routeçš„routeså±æ€§ä¸­</span></span><br><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">Â <span class="attr">routes</span>: [],</span><br><span class="line">Â <span class="attr">addRoutes</span>: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<p>å¥½ï¼Œæˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹åŠ¨æ€ç´¢å¼•èœå•æ˜¯å¦‚ä½•è¿›è¡Œçš„ï¼šå‘åç«¯è¯·æ±‚å¾—åˆ°æ•°æ®åï¼Œç”¨filterAsyncRoutesé€’å½’å¤„ç†ç´¢å¼•è·¯å¾„ component, å°±å¯ä»¥è¿›è¡Œå­˜å‚¨å’Œè½¬æ¢äº†ã€‚</p>
<br>

<br>
</li>
<li><p>æœ€åï¼Œè¿˜æœ‰ä¸€äº›ç»†èŠ‚éœ€è¦ä¿®æ”¹ï¼š</p>
<p>ï¼ˆ1ï¼‰ä¿®æ”¹router-&gt;index.jsæ–‡ä»¶ï¼Œæ³¨é‡Šæ‰documentå’Œguideèœå•ï¼Œå¹¶å°†dashboardæ”¹æˆâ€é¦–é¡µâ€å­—æ ·</p>
<p>ï¼ˆ2ï¼‰ä¿®æ”¹utils-&gt;validate.jsæ–‡ä»¶ï¼Œå¯¹ç”¨æˆ·åçš„æ ¡éªŒ</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">validUsername</span>(<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="comment">//const valid_map = [&#x27;admin&#x27;, &#x27;editor&#x27;]</span></span><br><span class="line">    <span class="keyword">return</span> str.<span class="property">length</span>&gt;<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰ä¿®æ”¹layout-&gt;components-&gt;Navbar.vueæ–‡ä»¶</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">logout</span>(<span class="params"></span>) &#123;</span><br><span class="line">Â  Â  Â  <span class="comment">//ä¿®æ”¹logoutæ–¹æ³•</span></span><br><span class="line">Â  Â  Â <span class="comment">//await this.$store.dispatch(&#x27;user/logout&#x27;)</span></span><br><span class="line">Â  Â  Â <span class="comment">//this.$router.push(`/login?redirect=$&#123;this.$route.fullPath&#125;`)</span></span><br><span class="line">Â  Â  Â <span class="variable language_">this</span>.$confirm(<span class="string">&#x27;ç¡®å®šé€€å‡ºç³»ç»Ÿå—?&#x27;</span>, <span class="string">&#x27;æç¤º&#x27;</span>, &#123;</span><br><span class="line">Â  Â  Â  Â <span class="attr">confirmButtonText</span>: <span class="string">&#x27;ç¡®å®š&#x27;</span>,</span><br><span class="line">Â  Â  Â  Â <span class="attr">cancelButtonText</span>: <span class="string">&#x27;å–æ¶ˆ&#x27;</span>,</span><br><span class="line">Â  Â  Â  Â <span class="attr">type</span>: <span class="string">&#x27;warning&#x27;</span></span><br><span class="line">Â  Â  &#125;).<span class="title function_">then</span>(<span class="title function_">async</span>() =&gt; &#123;</span><br><span class="line">Â  Â  Â  Â <span class="keyword">let</span> token = &#123; <span class="attr">token</span>: getToken &#125;    <span class="comment">// è·å–token</span></span><br><span class="line">Â  Â  Â  Â <span class="keyword">let</span> res = <span class="keyword">await</span> <span class="title function_">logout</span>(token)      <span class="comment">// è°ƒç”¨é€€å‡ºç™»å½•æ–¹æ³•</span></span><br><span class="line">Â  Â  Â  Â <span class="keyword">if</span> (res.<span class="property">success</span>)&#123;</span><br><span class="line">Â  Â  Â  Â  Â <span class="title function_">removeToken</span>()	<span class="comment">// å»é™¤token</span></span><br><span class="line">Â  Â  Â  Â  Â <span class="title function_">removeSessionStoreage</span>() Â  Â <span class="comment">// æ¸…é™¤SessionStoreage Â  Â </span></span><br><span class="line">Â  Â  Â  Â  Â <span class="comment">// this.$router.push(`/login?redirect=$&#123;this.$route.fullPath&#125;`)</span></span><br><span class="line">         <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">&#x27;/&#x27;</span></span><br><span class="line">Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;).<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">Â  Â  Â  Â <span class="variable language_">this</span>.$message(&#123;</span><br><span class="line">Â  Â  Â  Â  Â <span class="attr">type</span>: <span class="string">&#x27;info&#x27;</span>,</span><br><span class="line">Â  Â  Â  Â  Â <span class="attr">message</span>: <span class="string">&#x27;å·²å–æ¶ˆé€€å‡º&#x27;</span></span><br><span class="line">Â  Â  Â  &#125;);</span><br><span class="line">Â  Â &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<br>

<br>

<h3 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h3><p>ç›®å‰å·²ç»å®Œæˆäº†é¡¹ç›®çš„å‰ç«¯å¤§ä½“æ¡†æ¶ï¼Œåç»­åœ¨è¿›è¡Œ<strong>è®¿é—®æƒé™æ¨¡å—</strong>å’Œ<strong>é¡¹ç›®å„éƒ¨åˆ†æ¨¡å—ä¹‹é—´çš„å…³ç³»</strong>æ€»ç»“ã€‚</p>
<p>(<em>&#x2F;Ï‰ï¼¼</em>)</p>
]]></content>
      <categories>
        <category>vue</category>
        <category>vue-element-admin</category>
        <category>javaé¡¹ç›®</category>
        <category>æ±½è½¦ç§Ÿèµç®¡ç†ç³»ç»Ÿ</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>vue-element-adminä¹‹è´¢åŠ¡ç®¡ç†</title>
    <url>/2025/04/24/%E7%BB%9F%E8%AE%A1%E5%9B%BE_excel%E5%AF%BC%E5%87%BA_%E5%8F%91%E9%82%AE%E4%BB%B6/</url>
    <content><![CDATA[<h5 id="ä»‹ç»ï¼šåœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥å­¦ä¹ ä¸‰ä¸ªå°çŸ¥è¯†ï¼š-echarts-ç»Ÿè®¡å›¾ï¼Œ-excel-å¯¼å‡º-å’Œ-å‘é€é‚®ä»¶ã€‚"><a href="#ä»‹ç»ï¼šåœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥å­¦ä¹ ä¸‰ä¸ªå°çŸ¥è¯†ï¼š-echarts-ç»Ÿè®¡å›¾ï¼Œ-excel-å¯¼å‡º-å’Œ-å‘é€é‚®ä»¶ã€‚" class="headerlink" title="ä»‹ç»ï¼šåœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥å­¦ä¹ ä¸‰ä¸ªå°çŸ¥è¯†ï¼š echarts ç»Ÿè®¡å›¾ï¼Œ excel å¯¼å‡º å’Œ å‘é€é‚®ä»¶ã€‚"></a>ä»‹ç»ï¼šåœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥å­¦ä¹ ä¸‰ä¸ªå°çŸ¥è¯†ï¼š <em><strong>echarts</strong></em> ç»Ÿè®¡å›¾ï¼Œ <em><strong>excel</strong></em> å¯¼å‡º å’Œ å‘é€é‚®ä»¶ã€‚</h5><br>

<br>

<h5 id="ä¸€-echartsç»Ÿè®¡å›¾"><a href="#ä¸€-echartsç»Ÿè®¡å›¾" class="headerlink" title="ä¸€.  echartsç»Ÿè®¡å›¾"></a>ä¸€.  echartsç»Ÿè®¡å›¾</h5><br>

<p><a href="https://echarts.apache.org/examples/zh/">echartsä¸­æ–‡å®˜ç½‘</a>, è¿™é‡Œæˆ‘ä»¬åªçœ‹é‡å æŠ˜çº¿ç»Ÿè®¡å›¾ï¼Œç®€è¦æ€è·¯å°±æ˜¯ xè½´æ•°æ®ä¸ºå°æ—¶æˆ–æ—¥æœŸæ•°ç»„ï¼Œè€Œseriesçš„æ•°ç»„ä¸ºæ‰€å±•ç°çš„æ•°æ®çš„å¤§å°ï¼Œè¿™ä¸¤éƒ¨åˆ†çš„æ•°ç»„ç´¢å¼•ä¸€ä¸€å¯¹åº”ã€‚</p>
<br>

<p>ç¤ºä¾‹æ•ˆæœï¼š</p>
<img src="\images\vue\æ•°æ®ç»Ÿè®¡ä¹‹æŠ˜çº¿å›¾.png" alt="æŠ˜çº¿å›¾" style="zoom: 50%;"/>

<br>

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-card</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&quot;Mychart&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; width: &#x27;80%&#x27;, height: &#x27;400px&#x27; &#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-card</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">Mychart</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">xArray</span>: [],</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">y1Array</span>: [],</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">mouted</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">initRentalChart</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">initRentalChart</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">Mychart</span> = echarts.<span class="title function_">init</span>(<span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">Mychart</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">Mychart</span>.<span class="title function_">setOption</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">title</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">text</span>: <span class="string">&#x27;æ—¥æŠ¥å‡ºç§Ÿæ•°æ®ç»Ÿè®¡&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">subtext</span>: <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">toLocaleDateString</span>(),</span></span><br><span class="line"><span class="language-javascript">                &#125;,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">tooltip</span>: &#123; <span class="comment">// ä¸€äº›ä¾‹å¦‚ç‚¹é€‰çš„æ•ˆæœ</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">trigger</span>: <span class="string">&#x27;axis&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">axisPointer</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="attr">type</span>: <span class="string">&#x27;shadow&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                &#125;,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">legend</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">data</span>: [<span class="string">&#x27;å‡ºç§Ÿæ•°é‡&#x27;</span>] <span class="comment">// serieså†…å®¹æ•°ç»„</span></span></span><br><span class="line"><span class="language-javascript">                &#125;,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">grid</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">left</span>: <span class="string">&#x27;3%&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">right</span>: <span class="string">&#x27;4%&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">bottom</span>: <span class="string">&#x27;3%&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">containLabel</span>: <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">                &#125;,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">toolbox</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">show</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">orient</span>: <span class="string">&#x27;vertical&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">left</span>: <span class="string">&#x27;right&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">top</span>: <span class="string">&#x27;center&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">feature</span>: &#123; <span class="comment">// ä¾§è¾¹æ ï¼šæ•°æ®å±•ç¤ºï¼Œå›¾çš„åˆ‡æ¢ï¼Œä¿å­˜å›¾ç‰‡</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="attr">mark</span>: &#123;<span class="attr">show</span>: <span class="literal">true</span>&#125;,</span></span><br><span class="line"><span class="language-javascript">                        <span class="attr">dataView</span>: &#123;<span class="attr">readOnly</span>: <span class="literal">false</span>, <span class="attr">show</span>: <span class="literal">true</span>&#125;,</span></span><br><span class="line"><span class="language-javascript">                        <span class="attr">magicType</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="attr">type</span>: [<span class="string">&#x27;line&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>],</span></span><br><span class="line"><span class="language-javascript">                            <span class="attr">show</span>: <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">                        &#125;,</span></span><br><span class="line"><span class="language-javascript">                        <span class="attr">saveAsImage</span>: &#123;<span class="attr">show</span>: <span class="literal">true</span>&#125;</span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                &#125;,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">xAxis</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">type</span>: <span class="string">&#x27;category&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">boundaryGap</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">axisTick</span>: &#123;<span class="attr">show</span>: <span class="literal">false</span>&#125;,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">data</span>: <span class="variable language_">this</span>.<span class="property">xArray</span></span></span><br><span class="line"><span class="language-javascript">                &#125;,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">yAxis</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">type</span>: <span class="string">&#x27;value&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                &#125;,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">series</span>: [</span></span><br><span class="line"><span class="language-javascript">                    &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">name</span>: <span class="string">&#x27;å‡ºç§Ÿæ•°é‡&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="comment">// type: &#x27;bar&#x27;,</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">type</span>: <span class="string">&#x27;line&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="comment">// stack: &#x27;Total&#x27;,</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">barGap</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">data</span>: <span class="variable language_">this</span>.<span class="property">y1Array</span></span></span><br><span class="line"><span class="language-javascript">                    &#125;,</span></span><br><span class="line"><span class="language-javascript">                ]</span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<br>

<br>

<br>

<h5 id="äºŒ-excelå¯¼å‡º"><a href="#äºŒ-excelå¯¼å‡º" class="headerlink" title="äºŒ. excelå¯¼å‡º"></a>äºŒ. excelå¯¼å‡º</h5><br>

<p>å°†å¯¹è±¡æ•°ç»„è½¬åŒ–ä¸ºexcelè¡¨ï¼Œå±æ€§ä½œä¸ºè¡¨å¤´ï¼Œå¯ä»¥èµ·åˆ«åå“¦ğŸƒã€‚éœ€è¦ <em><strong>hutool</strong></em> ä¾èµ–åŒ…æ¥å®Œæˆï¼š</p>
<br>

<p>å¯¼å‡ºæ•ˆæœï¼š</p>
<img src="\images\vue\excelå¯¼å‡ºæ•ˆæœ.png" alt="excelå¯¼å‡ºæ•ˆæœ"/>

<br>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cn.hutool.poi.excel.ExcelUtil;</span><br><span class="line"><span class="keyword">import</span> cn.hutool.poi.excel.ExcelWriter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(&quot;exportExcel&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">export</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    List&lt;AutoBrand&gt; list=autoBrandService.list();</span><br><span class="line">    <span class="comment">// åˆ—è¡¨è½¬åŒ–ä¸ºexcelæ–‡ä»¶</span></span><br><span class="line">    ExcelWriter writer= ExcelUtil.getWriter(<span class="literal">true</span>);</span><br><span class="line">    writer.addHeaderAlias(<span class="string">&quot;brandName&quot;</span>,<span class="string">&quot;å“ç‰Œåç§°&quot;</span>);</span><br><span class="line">    writer.addHeaderAlias(<span class="string">&quot;deleted&quot;</span>,<span class="string">&quot;æ˜¯å¦åˆ é™¤&quot;</span>);</span><br><span class="line">    writer.write(list,<span class="literal">true</span>);</span><br><span class="line">    <span class="comment">// è®¾ç½®responseæ ¼å¼å’Œä¼ è¾“çš„æ–‡ä»¶å</span></span><br><span class="line">    response.setContentType(<span class="string">&quot;application/vnd.openxmlformats-</span></span><br><span class="line"><span class="string">                            officedocument.spreadsheetml.sheet;charset:utf-8&quot;</span>);</span><br><span class="line">    String fileName= URLEncoder.encode(<span class="string">&quot;æ±½è½¦å“ç‰Œ&quot;</span>,StandardCharsets.UTF_8);</span><br><span class="line">    response.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>,<span class="string">&quot;attachment;</span></span><br><span class="line"><span class="string">                       filename=&quot;</span>+fileName+<span class="string">&quot;.xlsx&quot;</span>);                                      	  writer.flush(response.getOutputStream(),<span class="literal">true</span>);</span><br><span class="line">    writer.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<br>

<br>

<h5 id="ä¸‰-å‘é‚®ä»¶"><a href="#ä¸‰-å‘é‚®ä»¶" class="headerlink" title="ä¸‰. å‘é‚®ä»¶"></a>ä¸‰. å‘é‚®ä»¶</h5><br>

<ol>
<li><p>è¿›è¡Œ<strong>application.yml</strong>é…ç½®:</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">mail:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">smtp.163.com</span> <span class="comment"># smtpä¸ºç®€å•é‚®ä»¶åè®®</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">25</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">a838211536@163.com</span> <span class="comment"># é‚®ç®±å</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">QNg9GeYBpeybQRMT</span> <span class="comment"># æˆæƒå¯†ç </span></span><br><span class="line">    <span class="attr">properties:</span></span><br><span class="line">      <span class="attr">mail.smtp.auth:</span> <span class="literal">true</span> <span class="comment"># å¯ç”¨è®¤è¯</span></span><br><span class="line">      <span class="attr">mail.smtp.starttls.enable:</span> <span class="literal">true</span>  <span class="comment"># å¯ç”¨TLS</span></span><br><span class="line">      <span class="attr">mail.smtp.starttls.required:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>å®šä¹‰<strong>IMailService</strong>æ¥å£åŠå…¶å®ä¹ ç±»<strong>MailServiceImpl</strong>, éœ€æ³¨æ„ï¼šå¦‚æœ<strong>javaMailSender</strong>æ— æ³•è‡ªåŠ¨æ³¨å…¥çš„è¯ï¼Œè¿˜éœ€è¦è‡ªå·±å†™ä¸€ä¸ªäº§ç”Ÿ javaMailSender bean çš„é…ç½®ç±»ã€‚</p>
<br>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MailServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">IMailService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JavaMailSender javaMailSender;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘é€é‚®ä»¶</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> mail é‚®ä»¶æ•°æ®å¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹å…³é”®å­—æ®µï¼š</span></span><br><span class="line"><span class="comment">     *             - from:    å‘ä»¶äººåœ°å€</span></span><br><span class="line"><span class="comment">     *             - to:      æ”¶ä»¶äººåœ°å€ï¼ˆæ”¯æŒå¤šä¸ªï¼‰</span></span><br><span class="line"><span class="comment">     *             - subject: é‚®ä»¶ä¸»é¢˜</span></span><br><span class="line"><span class="comment">     *             - content: é‚®ä»¶æ­£æ–‡å†…å®¹</span></span><br><span class="line"><span class="comment">     * å®ç°è¯´æ˜ï¼š</span></span><br><span class="line"><span class="comment">     * 1. ä½¿ç”¨SimpleMailMessageæ„å»ºåŸºç¡€é‚®ä»¶ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * 2. è®¾ç½®å‘ä»¶äººã€æ”¶ä»¶äººã€ä¸»é¢˜ã€æ­£æ–‡ç­‰æ ¸å¿ƒå­—æ®µ</span></span><br><span class="line"><span class="comment">     * 3. å°†å‘ä»¶äººåŒæ—¶æ·»åŠ åˆ°æŠ„é€åˆ—è¡¨ï¼ˆéœ€ç¡®è®¤æ˜¯å¦ç¬¦åˆä¸šåŠ¡éœ€æ±‚ï¼‰</span></span><br><span class="line"><span class="comment">     * 4. é€šè¿‡JavaMailSenderæ‰§è¡Œé‚®ä»¶å‘é€</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> MailException å½“é‚®ä»¶å‘é€å¤±è´¥æ—¶æŠ›å‡ºç›¸å…³å¼‚å¸¸</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMail</span><span class="params">(MailVO mail)</span> <span class="keyword">throws</span> MailException &#123;</span><br><span class="line">        <span class="comment">// æ„å»ºåŸºç¡€é‚®ä»¶æ¶ˆæ¯å¯¹è±¡</span></span><br><span class="line">        <span class="type">SimpleMailMessage</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleMailMessage</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®é‚®ä»¶åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line">        message.setFrom(mail.getFrom());</span><br><span class="line">        message.setTo(mail.getTo());</span><br><span class="line">        message.setSubject(mail.getSubject());</span><br><span class="line">        message.setText(mail.getContent());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®å‘ä»¶äººåŒæ—¶ä½œä¸ºæŠ„é€ï¼ˆæ ¹æ®ä¸šåŠ¡éœ€æ±‚å¯èƒ½éœ€è¦è°ƒæ•´ï¼‰</span></span><br><span class="line">        message.setCc(mail.getFrom());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ‰§è¡Œé‚®ä»¶å‘é€æ“ä½œ</span></span><br><span class="line">        javaMailSender.send(message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>

<p>å¥½çš„ï¼Œåˆ°è¿™é‡Œå°±å¯ä»¥è¿›è¡Œé‚®ä»¶å‘é€æ“ä½œäº†ï¼Œä½†æ˜¯å¦‚ä½•è¿›è¡Œ<strong>å®šæ—¶å‘é€é‚®ä»¶</strong>å‘¢ï¼Ÿ</p>
<br>
</li>
<li><p>å®šæ—¶å‘é€é‚®ä»¶, è¿™é‡Œå°±ä»¥è´¢åŠ¡ç®¡ç†çš„æ—¥æŠ¥æ”¶å…¥éƒ¨åˆ†ä¸ºä¾‹å§ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SendMailUtil</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IFinanceService financeService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IMailService mailService;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spring.mail.username&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String from;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Scheduled(cron = &quot;*/10 * * * * ?&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMail</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">StringBuffer</span> <span class="variable">sbf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">        sbf.append(<span class="string">&quot;ä»Šæ—¥æ”¶å…¥ï¼š&quot;</span>)</span><br><span class="line">                .append(<span class="string">&quot;ï¼Œç§Ÿé‡‘æ”¶å…¥ï¼š&quot;</span>)</span><br><span class="line">                .append(financeService.sumRentPay().getCountActualPayable())</span><br><span class="line">                .append(<span class="string">&quot;ï¼ŒæŠ¼é‡‘æ”¶å…¥ï¼š&quot;</span>)</span><br><span class="line">                .append(financeService.sumDeposit());</span><br><span class="line">        <span class="type">MailVO</span> <span class="variable">mailVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MailVO</span>();</span><br><span class="line">        <span class="comment">// è®¾ç½®å››éƒ¨åˆ†ï¼šfrom, to, subject, content</span></span><br><span class="line">        mailVO.setFrom(from);</span><br><span class="line">        mailVO.setTo(<span class="string">&quot;a838211536@163.com&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">date</span> <span class="operator">=</span> LocalDate.now().format(DateTimeFormatter.ofPattern(<span class="string">&quot;yyyy-MM-dd&quot;</span>));</span><br><span class="line">        mailVO.setSubject(date + <span class="string">&quot;ä»Šæ—¥æ”¶å…¥&quot;</span>);</span><br><span class="line">        mailVO.setContent(sbf.toString());</span><br><span class="line">        mailService.sendMail(mailVO);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<p>å¥½çš„ï¼Œè¿™æ ·çœ‹æ¥ï¼Œé‚®ä»¶å‘é€å°±ç®€å•äº†ï¼šï¼ˆ1ï¼‰<strong>javaMailSender</strong>çš„é…ç½®     ï¼ˆ2ï¼‰å¡«å†™å‘é€ä¿¡æ¯å¯¹è±¡</p>
</li>
</ol>
]]></content>
      <categories>
        <category>vue</category>
        <category>vue-element-admin</category>
        <category>javaé¡¹ç›®</category>
        <category>æ±½è½¦ç§Ÿèµç®¡ç†ç³»ç»Ÿ</category>
      </categories>
      <tags>
        <tag>echartsç»Ÿè®¡å›¾</tag>
        <tag>excelå¯¼å‡º</tag>
        <tag>å‘é‚®ä»¶</tag>
      </tags>
  </entry>
  <entry>
    <title>Spring Security</title>
    <url>/2025/04/24/spring-security/</url>
    <content><![CDATA[<p>ä»‹ç»ï¼š æ˜¯ä¸€å¥—åç«¯è®¿é—®å’Œæƒé™æ ¡éªŒçš„æ¡†æ¶ï¼Œç”±ä¸€ç³»åˆ—çš„è¿‡æ»¤é“¾ç»„æˆï¼Œæˆ‘ä»¬ä¸»è¦æ“ä½œçš„æ˜¯ä¸‰éƒ¨åˆ†ï¼š</p>
<ol>
<li><p>è®¤è¯æ ¸å¿ƒï¼ˆUsernamePasswordAuthenticationFilterï¼‰ </p>
</li>
<li><p>å¤„ç†è®¤è¯å’Œæˆæƒå¼‚å¸¸ï¼ˆExceptionTranslationFilterï¼‰</p>
</li>
<li><p>æˆæƒæ ¸å¿ƒï¼ˆFilterSecurityï¼‰</p>
</li>
</ol>
<p>æˆ‘ä»¬ä¸»è¦ä»<strong>è®¤è¯</strong>å’Œ<strong>æˆæƒ</strong>è¿™ä¸¤ä¸ªæ–¹é¢æ¥æ€»ç»“ã€‚</p>
<br>

<br>

<br>

<h3 id="ä¸€-è®¤è¯"><a href="#ä¸€-è®¤è¯" class="headerlink" title="ä¸€. è®¤è¯"></a>ä¸€. è®¤è¯</h3><br>

<p>è®¤è¯å°±æ˜¯è®¤è¯æ ¸å¿ƒ <strong>UsernamePasswordAuthenticationFilter</strong> è¿‡æ»¤å™¨æ¥è¿›è¡Œçš„ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æµç¨‹å›¾ï¼š</p>
<img src="\images\security\springSecurityè®¤è¯.png" alt="springSecurityè®¤è¯">

<br>

<br>

<ol>
<li><h5 id="ç”¨æˆ·åˆæ¬¡ç™»å½•"><a href="#ç”¨æˆ·åˆæ¬¡ç™»å½•" class="headerlink" title="ç”¨æˆ·åˆæ¬¡ç™»å½•"></a>ç”¨æˆ·åˆæ¬¡ç™»å½•</h5></li>
</ol>
<p>å…·ä½“æµç¨‹ï¼š </p>
<p>ï¼ˆ1ï¼‰æ¥å—ç”¨æˆ·å‘é€è¯·æ±‚æºå¸¦çš„usernameå’Œpasswordï¼Œå°è£…ä¸ºAuthenticationå¯¹è±¡ï¼Œè°ƒç”¨AuthenticaionManagerï¼ˆå«æœ‰UserDetailsServiceæ¥å£å®ç°ç±»å’ŒPasswordEncoderå¯†ç æ ¡éªŒï¼‰</p>
<br>

<p>ï¼ˆ2ï¼‰ UserDetailsServiceæ¥å£å®ç°ç±»æ ¹æ®usernameæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼ŒåŠå…¶æƒé™ä¿¡æ¯ï¼Œå°è£…åˆ°UserDetailså¯¹è±¡å®ç°ç±»é‡Œã€‚ç»è¿‡PasswordEncoderçš„æ¥å£å®ç°ç±»BCryptPasswordEncoderçš„æ ¡éªŒï¼Œé€šè¿‡æ ¡éªŒåˆ™å°†UserDetailsæ¥å£å®ç°ç±»å¯¹è±¡å°è£…åˆ°Authenticationå¯¹è±¡é‡Œ, ä¸é€šè¿‡åˆ™åˆ°ç™»å½•å¤±è´¥å¤„ç†å™¨è¿”å›ç™»å½•å¤±è´¥ä¿¡æ¯ã€‚</p>
<br>

<p>ï¼ˆ3ï¼‰æœ€åå°†å¯¹è±¡è¿”å›å¹¶ä¸”å­˜å…¥SecurityContextHolder.getContext()é‡Œã€‚</p>
<br>

<p>ï¼ˆ4ï¼‰å­˜å…¥å¹¶è¿”å›token: é€šè¿‡UsernamePasswordAuthenticationFilteråï¼Œåˆ°è¾¾ç™»å½•æˆåŠŸå¤„ç†å™¨LoginSucessHandlerï¼Œé¦–å…ˆæ ¹æ® Authenticationå¯¹è±¡ è·å– User å¯¹è±¡ï¼ˆå°è£…ç”¨æˆ·ä¿¡æ¯å’Œæƒé™ä¿¡æ¯ï¼‰ï¼Œå†æå– username å’Œ userId ç”Ÿæˆtoken, outputStreamæµè¿”å›tokenå¹¶å°†tokenï¼ŒåŠæœ‰æ•ˆæ—¶é—´é•¿åº¦å­˜å‚¨åˆ°redisä¸­ã€‚</p>
<br>

<br>

<p>é‚£ä¾¿æœ‰ä¸€ä¸ªé—®é¢˜äº†ï¼Œè¿™ä¸ªç™»å½•æˆåŠŸå¤„ç†å™¨ä¸åœ¨è¿™ä¸‰å¤§è¿‡æ»¤å™¨ä¹‹å†…å‘€ï¼Œå¦‚ä½•é…ç½®å‘¢ï¼Ÿå“ˆå“ˆï¼Œè¦ç»è¿‡SecurityConfigé…ç½®çš„ï¼Œäº‹å®ä¸Šï¼ŒSecurityConfigæ˜¯é…ç½®æ•´ä¸ªå®‰å…¨è¿‡æ»¤å™¨é“¾çš„ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableWebSecurity</span></span><br><span class="line"><span class="meta">@EnableMethodSecurity</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SecurityConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LoginSuccessHandler loginSuccessHandler;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LoginFailHandler loginFailHandler;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CustomerAccessDeniedHandler customerAccessDeniedHandler;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CustomerAnonymousEntryPoint customerAnonymousEntryPoint;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CustomerUserDetailsService customerUserDetailsService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span>  VerifyTokenFilter verifyTokenFilter;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é…ç½®å®‰å…¨è¿‡æ»¤å™¨é“¾</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> http</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> SecurityFilterChain <span class="title function_">securityFilterChain</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// ç™»å½•å‰è¿‡æ»¤é…ç½®</span></span><br><span class="line">        http.addFilterBefore(verifyTokenFilter, UsernamePasswordAuthenticationFilter.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        http.formLogin()</span><br><span class="line">                .loginProcessingUrl(<span class="string">&quot;/rental/user/login&quot;</span>) <span class="comment">// è®¾ç½®ç™»å½•å¤„ç†URL</span></span><br><span class="line">                .successHandler(loginSuccessHandler) <span class="comment">// è®¾ç½®ç™»å½•æˆåŠŸå¤„ç†å™¨</span></span><br><span class="line">                .failureHandler(loginFailHandler) <span class="comment">// è®¾ç½®ç™»å½•å¤±è´¥å¤„ç†å™¨</span></span><br><span class="line">                .and()</span><br><span class="line">                .sessionManagement()</span><br><span class="line">                .sessionCreationPolicy(SessionCreationPolicy.STATELESS) <span class="comment">// è®¾ç½®ä¼šè¯åˆ›å»ºç­–ç•¥ä¸ºæ— çŠ¶æ€</span></span><br><span class="line">                .and()</span><br><span class="line">                .authorizeHttpRequests() <span class="comment">// æˆæƒè¯·æ±‚é…ç½®</span></span><br><span class="line">                .requestMatchers(<span class="string">&quot;/rental/user/login&quot;</span>) <span class="comment">// åŒ¹é…ç™»å½•è¯·æ±‚</span></span><br><span class="line">                .permitAll() <span class="comment">// å…è®¸æ‰€æœ‰è¯·æ±‚è®¿é—®</span></span><br><span class="line">                .anyRequest().authenticated() <span class="comment">// ä»»ä½•å…¶ä»–è¯·æ±‚éœ€è¦è®¤è¯</span></span><br><span class="line">                .and()</span><br><span class="line">                .exceptionHandling() <span class="comment">// å¼‚å¸¸å¤„ç†é…ç½®</span></span><br><span class="line">                .authenticationEntryPoint(customerAnonymousEntryPoint) <span class="comment">// è®¾ç½®æœªè®¤è¯å…¥å£ç‚¹</span></span><br><span class="line">                .accessDeniedHandler(customerAccessDeniedHandler) <span class="comment">// è®¾ç½®è®¿é—®æ‹’ç»å¤„ç†å™¨</span></span><br><span class="line">                .and()</span><br><span class="line">                .cors() <span class="comment">// è·¨åŸŸé…ç½®</span></span><br><span class="line">                .and()</span><br><span class="line">                .csrf().disable() <span class="comment">// å…³é—­CSRFä¿æŠ¤  è·¨ç«™è¯·æ±‚ä¼ªé€  æ˜¯ä¸€ç§ç½‘ç»œæ”»å‡»</span></span><br><span class="line">                .userDetailsService(customerUserDetailsService); <span class="comment">// è®¾ç½®ç”¨æˆ·è¯¦æƒ…æœåŠ¡</span></span><br><span class="line">        <span class="keyword">return</span> http.build(); <span class="comment">// æ„å»ºå¹¶è¿”å›å®‰å…¨è¿‡æ»¤é“¾</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<br>

<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é…ç½®çš„å†…å®¹ä¸ºï¼š</p>
<p>ç™»å½•å‰ï¼šUsernamePasswordAuthenticationFilter</p>
<p>ç™»å½•å¤±è´¥ï¼Œç™»å½•æˆåŠŸ</p>
<p>è¯·æ±‚è®¿é—®ç­–ç•¥</p>
<p>å¼‚å¸¸å¤„ç†</p>
<p>è·¨åŸŸé…ç½®</p>
<p>userDetailsServiceæ¥å£å®ç°ç±»</p>
<br>

<br>

<ol start="2">
<li><h5 id="ç”¨æˆ·æºå¸¦tokenç™»å½•"><a href="#ç”¨æˆ·æºå¸¦tokenç™»å½•" class="headerlink" title="ç”¨æˆ·æºå¸¦tokenç™»å½•"></a>ç”¨æˆ·æºå¸¦tokenç™»å½•</h5><p>å…·ä½“æµç¨‹ï¼šç”¨æˆ·æºå¸¦tokenè®¿é—®éloginçš„urléœ€è¦ç»è¿‡verifyTokenFilteréªŒè¯ï¼Œtokenä¸ºç©ºï¼Œä¸åœ¨rediså†…ï¼Œä¸å¯è§£æåˆ™æŠ›å‡ºè®¤è¯å¼‚å¸¸è¢«ç™»å½•å¤±è´¥å¤„ç†å™¨æ•æ‰ï¼Œå¦åˆ™è§£æusernameï¼Œè°ƒç”¨UserDetailsServiceæ¥å£å®ç°ç±»è¿›è¡ŒæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯å’Œæƒé™ä¿¡æ¯ï¼Œå°è£…åˆ°Authenticationå¯¹è±¡å¹¶å­˜å‚¨åˆ°SecurityContextHolder.getContext()é‡Œã€‚</p>
<br>

<br>

<br></li>
</ol>
<h3 id="äºŒ-æˆæƒ"><a href="#äºŒ-æˆæƒ" class="headerlink" title="äºŒ. æˆæƒ"></a>äºŒ. æˆæƒ</h3><br>

<ol>
<li>å‰é¢æˆ‘ä»¬è°ƒç”¨UserDetailServiceå®ä¹ ç±»loadByUserNameæ–¹æ³•æŸ¥è¯¢æƒé™ä¿¡æ¯å¹¶ä¸”å­˜å‚¨åˆ°UserDetailçš„å®ç°ç±»ä¸­ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æƒé™ä¿¡æ¯çš„åˆ›å»ºè¿‡ç¨‹ï¼š</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æŸ¥è¯¢æƒé™ä¿¡æ¯</span></span><br><span class="line">List&lt;Permission&gt; permissionList = permissionService.selectPermissionListByUserId(user.getId());</span><br><span class="line">user.setPermissionList(permissionList);</span><br><span class="line"><span class="comment">// é€šè¿‡streamæµå¤„ç†ï¼Œå°†æƒé™å¯¹è±¡è½¬åŒ–ä¸ºæƒé™å­—ç¬¦ä¸²åˆ—è¡¨</span></span><br><span class="line">List&lt;String&gt; list = permissionList.stream().filter(Objects::nonNull)</span><br><span class="line">    .map(Permission::getPermissionCode)</span><br><span class="line">    .filter(Objects::nonNull)</span><br><span class="line">    .toList();</span><br><span class="line">String[] array = list.toArray(<span class="keyword">new</span> <span class="title class_">String</span>[list.size()]);</span><br><span class="line">List&lt;GrantedAuthority&gt; authorityList = AuthorityUtils.createAuthorityList(array);</span><br><span class="line">user.setAuthorities(authorityList);</span><br></pre></td></tr></table></figure>

<br>

<p>å¯ä»¥çœ‹åˆ°æƒé™ä¿¡æ¯æ˜¯æ ¹æ®permissionCodeå­—æ®µè¿›è¡Œåˆ›å»ºçš„ã€‚</p>
<br>

<ol start="2">
<li><p>ç°åœ¨å·²çŸ¥æƒé™ä¿¡æ¯çš„å…·ä½“æ ¼å¼ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹å…·ä½“çš„æˆæƒæ“ä½œï¼Œä»¥æ–°å¢è§’è‰²ä¸ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;hasAuthority(&#x27;sys:role:add&#x27;)&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">add</span><span class="params">(<span class="meta">@RequestBody</span> Role role)</span> &#123;</span><br><span class="line">    role.setDeleted(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">return</span> roleService.save(role) ?  Result.success() : Result.fail();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>éœ€è¦ PreAuthorize æ³¨è§£ å’Œ hasAuthority æ–¹æ³•å°±å¥½äº†ï¼Œæ–¹æ³•å‚æ•°å³ä¸ºä¸Šé¢æäº¤çš„permissionCodeğŸ˜</p>
<br>

<p>ç°åœ¨æˆæƒå¤§ä½“å·²ç»è®²å®Œäº†ï¼Œå¦å¤–è¿˜å¯ä»¥è‡ªå·±å®šä¹‰hasAuthorityæ–¹æ³•å‘¦ğŸƒï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹è¿‡ç¨‹å§ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component(&quot;ex&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyExpressionRoot</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasAuthority</span><span class="params">(String authority)</span>&#123;</span><br><span class="line">        <span class="comment">//è·å–èº«ä»½ä»¤ç‰Œ</span></span><br><span class="line">        <span class="type">Authentication</span> <span class="variable">authentication</span> <span class="operator">=</span> SecurityContextHolder.getContext().getAuthentication();</span><br><span class="line">        <span class="comment">//è·å–æƒé™</span></span><br><span class="line">        Collection&lt;? <span class="keyword">extends</span> <span class="title class_">GrantedAuthority</span>&gt; authorities = authentication.getAuthorities();</span><br><span class="line">        <span class="comment">//å¾ªç¯åˆ¤æ–­</span></span><br><span class="line">        <span class="keyword">for</span> (GrantedAuthority grantedAuthority : authorities) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">role</span> <span class="operator">=</span> grantedAuthority.getAuthority(); <span class="comment">// è·å–string</span></span><br><span class="line">            <span class="keyword">if</span> (role.equals(authority)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ï¼š</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;@ex.hasAuthority(&#x27;&#x27;)&quot;)</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h3><p>å¥½äº†ï¼Œç°åœ¨spring securityå·²ç»æ€»ç»“å®Œäº†ï¼Œæ…¢æ…¢å­¦ä¹ ï¼Œæ€è€ƒå’Œæ€»ç»“ï¼Œç†Ÿç»ƒäº†å°±ç®€å•äº†ğŸ˜</p>
]]></content>
      <categories>
        <category>javaé¡¹ç›®</category>
        <category>æ±½è½¦ç§Ÿèµç®¡ç†ç³»ç»Ÿ</category>
        <category>javaæ¡†æ¶</category>
        <category>SpringSecurity</category>
      </categories>
      <tags>
        <tag>SpringSecurity</tag>
      </tags>
  </entry>
  <entry>
    <title>æ ¸å¿ƒä¸šåŠ¡é€»è¾‘</title>
    <url>/2025/04/25/%E6%A0%B8%E5%BF%83%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91/</url>
    <content><![CDATA[<p>ä»‹ç»ï¼šæ€»ç»“ä¸€ä¸‹æ±½è½¦ç§Ÿèµç®¡ç†ç³»ç»Ÿçš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œæœ‰å››å¤§æ¿å—ï¼š</p>
<p>ï¼ˆ1ï¼‰æƒé™ç®¡ç†</p>
<p>ï¼ˆ2ï¼‰æ•°æ®åˆå§‹</p>
<p>ï¼ˆ3ï¼‰æ—¥å¸¸ä¸šåŠ¡</p>
<p>ï¼ˆ4ï¼‰è´¢åŠ¡ç®¡ç†</p>
<p>è¿™æ ·æ˜¯æŒ‰ç…§å¼€å‘é¡ºåºæ¥æ’çš„ï¼šæˆ‘ä»¬çš„é¡¹ç›®é¦–å…ˆç™»å½•è¿›å»ï¼Œæ ¹æ®ç™»å½•ç”¨æˆ·çš„æƒé™ä¿¡æ¯æ˜¾ç¤ºå·¦ä¾§èœå•æ ï¼Œè½¦è¾†ä¿¡æ¯è¦è¿›è¡Œè®¾ç½®ï¼Œç„¶åå¯ä»¥æ“ä½œæ—¥å¸¸ä¸šåŠ¡æ¿å—äº†ï¼Œæœ€åå¯ä»¥è¿›è¡Œè´¢åŠ¡ç®¡ç†ã€‚</p>
<br>

<br>

<h4 id="ä¸€-æƒé™ç®¡ç†"><a href="#ä¸€-æƒé™ç®¡ç†" class="headerlink" title="ä¸€. æƒé™ç®¡ç†"></a>ä¸€. æƒé™ç®¡ç†</h4><br>

<p>è¿™ä¸€æ¨¡å—æ˜¯æˆ‘ä»¬æ•´ä¸ªé¡¹ç›®çš„åŸºç¡€ï¼Œç”¨æˆ·â€”è§’è‰²â€”æƒé™èµ„æº è¿™ä¸‰å¤§éƒ¨åˆ†ç›¸å…³è”ï¼Œå½“ç„¶è¿˜æœ‰éƒ¨é—¨â€”ç”¨æˆ·ï¼Œè¿™é‡Œä¸»è¦ä»‹ç»é‡ç‚¹ï¼š æƒé™èµ„æº <strong>permission</strong> è¡¨ï¼Œè¡¨ä¸­åŒ…å«äº†å››å¤§æ¿å—æ‰€æœ‰çš„æƒé™åŠå…¶å­æƒé™ã€‚</p>
<br>

<p>å››å¤§æ¿å—çš„æƒé™åˆ†çº§ï¼šé¡¶çº§ç›®å½•(0), èœå•(1), æ“ä½œ(2) </p>
<br>

<p>é‚£ä¹ˆå°±æœ‰ä¸€ä¸ªé—®é¢˜äº†ï¼Œæˆ‘ä»¬ç™»å½•ç”¨æˆ·çš„æƒé™å’Œè¿™å››å¤§æ¿å—çš„æƒé™æœ‰å•¥å…³ç³»å‘€ï¼Ÿå…¶å®å¯ä»¥ä»è®¿é—®å’Œæ“ä½œè¿™ä¸¤éƒ¨åˆ†å‡ºå‘ï¼š</p>
<p>ï¼ˆ1ï¼‰è®¿é—®ï¼š é¡¶çº§ç›®å½•å’Œèœå•éƒ¨åˆ†</p>
<img src="\images\æƒé™ä¹‹è®¿é—®.png" alt="æƒé™ç®¡ç†"/>

<p>ï¼ˆ2ï¼‰æ“ä½œï¼šå¢åˆ æ”¹æŸ¥</p>
<br>

<p>ç®€å•ç‚¹è¯´ï¼Œå°±æ˜¯ï¼Œä½ ç”¨æˆ·çš„æƒé™åŒ…å«é¡¶çº§ç›®å½•å’Œèœå•ï¼Œå°±å¯ä»¥åœ¨èœå•ä¾§è¾¹æ æ˜¾ç¤ºï¼Œå†åŒ…å«ç›¸å…³æ“ä½œæƒé™ï¼Œå°±å¯ä»¥å¯¹ç›¸å…³é¡µé¢è¿›è¡Œç›¸å…³æ“ä½œã€‚å¦‚æœç”¨æˆ·æƒé™åŒ…æ‹¬æƒé™ç®¡ç†åŠå…¶æ‰€æœ‰å­æƒé™ï¼Œå°±å¯ä»¥åœ¨è¯¥æ¿å—ç¼–è¾‘è‡ªå·±æˆ–å…¶ä»–ç”¨æˆ·çš„æƒé™èµ„æºåˆ†é…ã€‚</p>
<br>

<p>äº†è§£äº†å…·ä½“åŸç†åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹è¿™å››ä¸ªéƒ¨åˆ†çš„åŠŸèƒ½</p>
<ol>
<li><p>éƒ¨é—¨ç®¡ç†ï¼šå¢åˆ æ”¹æŸ¥</p>
</li>
<li><p>ç”¨æˆ·ç®¡ç†ï¼šå¢ï¼ˆé€‰æ‹©éƒ¨é—¨ï¼Œå…ˆåˆ å…³è”å†æ·»å…³è”ï¼‰ï¼Œåˆ ï¼ˆåˆ é™¤ä¸è§’è‰²çš„å…³è”ï¼‰ï¼Œæ”¹ï¼ŒæŸ¥ï¼Œç»‘å®šè§’è‰²</p>
</li>
<li><p>è§’è‰²ç®¡ç†ï¼šå¢ï¼Œåˆ ï¼ˆåˆ é™¤ä¸ç”¨æˆ·å…³è”ï¼Œåˆ é™¤ä¸æƒé™å…³è”ï¼‰ï¼Œæ”¹ï¼ŒæŸ¥ï¼Œè®¾ç½®æƒé™</p>
</li>
<li><p>èœå•ç®¡ç†ï¼šå¢åˆ æ”¹æŸ¥</p>
<br>

<br></li>
</ol>
<h4 id="äºŒ-æ•°æ®åˆå§‹"><a href="#äºŒ-æ•°æ®åˆå§‹" class="headerlink" title="äºŒ. æ•°æ®åˆå§‹"></a>äºŒ. æ•°æ®åˆå§‹</h4><br>

<p>è¿™ä¸€éƒ¨åˆ†å°±æ˜¯è®¾ç½®è½¦è¾†ä¿¡æ¯çš„ï¼Œæ•ˆæœå›¾å¦‚ä¸‹ï¼š</p>
<img src="\images\æ•°æ®åˆå§‹.png" alt="æ•°æ®åˆå§‹"/>

<p>æˆ‘ä»¬ç›´æ¥æ¥çœ‹æ“ä½œï¼š</p>
<ol>
<li><p>è½¦è¾†å‚å•†ï¼šå¢åˆ æ”¹æŸ¥</p>
</li>
<li><p>è½¦è¾†å“ç‰Œï¼šå¢ï¼ˆé€‰æ‹©è½¦è¾†å‚å•†ï¼‰ï¼Œåˆ ï¼Œæ”¹ï¼ŒæŸ¥ï¼ˆæ˜¾ç¤ºå‚å•†åç§°ï¼‰</p>
</li>
<li><p>å‡ºç§Ÿç±»å‹ï¼šå¢åˆ æ”¹æŸ¥</p>
</li>
<li><p>è½¦è¾†ä¿¡æ¯ï¼šå¢ï¼ˆæ‰€å±å‚å•†ï¼Œæ‰€å±å“ç‰Œï¼‰ï¼Œåˆ ï¼Œæ”¹ï¼ŒæŸ¥</p>
<br>

<br></li>
</ol>
<h4 id="ä¸‰-æ—¥å¸¸ä¸šåŠ¡"><a href="#ä¸‰-æ—¥å¸¸ä¸šåŠ¡" class="headerlink" title="ä¸‰. æ—¥å¸¸ä¸šåŠ¡"></a>ä¸‰. æ—¥å¸¸ä¸šåŠ¡</h4><br>

<p>è¿™ä¸€éƒ¨åˆ†å°±æ˜¯é‡ä¸­ä¹‹é‡äº†ï¼Œæ•ˆæœå›¾å¦‚ä¸‹ï¼š</p>
<img src="\images\æ—¥å¸¸ä¸šåŠ¡.png" alt="æ—¥å¸¸ä¸šåŠ¡"/>

<p>ï¼ˆ1ï¼‰å®¢æˆ·ç®¡ç†ï¼šå¢åˆ æ”¹æŸ¥</p>
<p>ï¼ˆ2ï¼‰æ±½è½¦å‡ºç§Ÿï¼šç®¡ç†ä¸ºå‡ºç§Ÿçš„æ±½è½¦ï¼ŒæŸ¥ï¼ˆæ±½è½¦status&#x3D;0ï¼‰ï¼Œå‡ºç§Ÿï¼ˆå¡«å†™å‡ºç§Ÿç±»å‹å’Œç”¨æˆ·ä¿¡æ¯â€“&gt; æ–°å¢è®¢å•, ä¿®æ”¹æ±½è½¦çŠ¶æ€status&#x3D;1ï¼‰</p>
<p>ï¼ˆ3ï¼‰è®¢å•è¯¦æƒ…ï¼šæŸ¥è¯¢ï¼Œè®¢å•è¯¦æƒ…ï¼ŒæŠ¼é‡‘è¿”è¿˜</p>
<p>ï¼ˆ4ï¼‰è¿ç« å¤„ç†ï¼šå¢ï¼ˆè½¦ç‰Œå·ï¼Œè¿ç« ä¿¡æ¯ï¼‰ï¼Œåˆ ï¼Œæ”¹ï¼ŒæŸ¥</p>
<p>ï¼ˆ5ï¼‰è½¦è¾†ä¿å…»ï¼šå¢ï¼ˆæŸ¥è¯¢éœ€è¦ä¿å…»çš„è½¦ç‰Œå·ï¼‰ï¼Œåˆ ï¼Œæ”¹ï¼ŒæŸ¥</p>
<p>ï¼ˆ6ï¼‰è½¦è¾†å½’è¿˜ï¼šç®¡ç†æœªå½’è¿˜çš„è½¦è¾†ï¼Œæ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯ï¼Œè½¦è¾†ä¿¡æ¯ï¼Œè®¢å•ä¿¡æ¯ï¼Œå‡ºç§Ÿç±»å‹çš„è”åˆæŸ¥è¯¢ã€‚æŸ¥è¯¢ï¼Œå½’è¿˜</p>
<br>

<br>

<h4 id="å››-è´¢åŠ¡ç®¡ç†"><a href="#å››-è´¢åŠ¡ç®¡ç†" class="headerlink" title="å››. è´¢åŠ¡ç®¡ç†"></a>å››. è´¢åŠ¡ç®¡ç†</h4><br>

<p>ä¸»è¦æ˜¯ echarts ç»Ÿè®¡å›¾ï¼Œexcelè¡¨å¯¼å‡ºï¼Œå®šæœŸå‘é‚®ä»¶è¿™ä¸‰éƒ¨åˆ†ï¼Œä¹‹å‰å·²ç»æ€»ç»“äº†ï¼Œè¯·å‚è€ƒï¼š</p>
<p><a href="https://jixu0610.github.io/2025/04/24/%E7%BB%9F%E8%AE%A1%E5%9B%BE_excel%E5%AF%BC%E5%87%BA_%E5%8F%91%E9%82%AE%E4%BB%B6/"><strong>vue-element-admin</strong></a></p>
]]></content>
      <categories>
        <category>javaé¡¹ç›®</category>
        <category>æ±½è½¦ç§Ÿèµç®¡ç†ç³»ç»Ÿ</category>
      </categories>
  </entry>
  <entry>
    <title>ç®—æ³•åˆ·é¢˜ä¹‹å‰è¨€</title>
    <url>/2025/04/25/%E7%AE%97%E6%B3%95%E5%88%B7%E9%A2%98%E4%B9%8B%E5%89%8D%E8%A8%80/</url>
    <content><![CDATA[<p>ä»‹ç»ï¼šå›æƒ³è‡ªå·±å­¦ä¹ ç®—æ³•çš„è¿‡ç¨‹ï¼Œå…ˆæ˜¯å¤§è‡´çœ‹å®Œäº†Kç¥çš„ã€ŠHelloç®—æ³•ã€‹javaç‰ˆï¼Œåˆåœ¨leetcodeä¸­åˆ·äº†å¤§æ¦‚30é¢˜ï¼ŒÎµ&#x3D;(Â´Î¿ï½€*)))å”‰ï¼Œå› ä¸ºæœ€è¿‘åšé¡¹ç›®æŠŠæ¡ä¸å‡†æ—¶é—´ï¼Œæ¯å¤©æœ€åæ€»æ˜¯æ²¡æ—¶é—´åˆ·é¢˜ï¼Œå†™ä¸‹æ¥åæ€åæ€ï¼Œæ¯å¤©åˆ·ä¸¤é¢˜ï¼Œæ¯å¤©è®°å½•è®°å½•è‡ªå·±çš„åˆ·é¢˜æ„Ÿå—ï¼Œåå¤©ä¸ºå•ä½å‘ä¸€ç¯‡æ–‡ç« ï¼Œç›‘ç£è‡ªå·±çš„è¿›åº¦é¡ºä¾¿æ€»ç»“ä¸€ä¸‹Kç¥çš„Helloç®—æ³•éƒ¨åˆ†ï¼ŒåŠ æ²¹ï¼</p>
]]></content>
      <categories>
        <category>ç®—æ³•åˆ·é¢˜</category>
      </categories>
      <tags>
        <tag>ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title>ç™¾æ—¥ç­‘åŸºä¹‹å‰è¨€</title>
    <url>/2025/04/25/%E7%99%BE%E6%97%A5%E7%AD%91%E5%9F%BA%E4%B9%8B%E5%89%8D%E8%A8%80/</url>
    <content><![CDATA[<p>ä»Šå¤©æˆ‘å®šä¸€ä¸ªç™¾æ—¥ç­‘åŸºçš„è®¡åˆ’ï¼Œå†…å®¹ä¸ºæˆ’è‰²å’Œé”»ç‚¼ï¼Œä¹‹å‰ä¹Ÿå°è¯•è¿‡ï¼Œä½†éƒ½ä»¥å¤±è´¥å‘Šç»ˆï¼Œå›æƒ³åšæŒæœ€é•¿çš„ä¸€æ®µæ—¶é—´ï¼Œæ˜¯åœ¨æˆ’è‰²æ–‡ç« å’Œæˆ’è‰²å£å·çš„ç†é™¶ä¸‹ï¼ŒåŸæœ¬æˆ‘ä»¥ä¸ºå½¢å¼åŒ–çš„æ„ä¹‰ä¸å¤§ï¼Œä½†äº‹å®è¯æ˜ç¯å¢ƒå¯¹ä¸€ä¸ªäººçš„å½±å“æå¤§ï¼Œèªæ˜çš„äººæ€»èƒ½æŠŠè‡ªå·±ç½®äºåˆé€‚çš„ç¯å¢ƒï¼Œèµ‹äºˆè‡ªå·±é©±åŠ¨åŠ›å’Œæ‰§è¡ŒåŠ›ï¼Œå½“ç„¶ï¼Œè¿™ä¸€åˆ‡çš„å‰ææ˜¯å¿ƒä¸­å®å¤§çš„å¿—å‘ã€‚æ‰€ä»¥ï¼Œä»Šå¤©æˆ‘å‘èµ·ç™¾æ—¥ç­‘åŸºè®¡åˆ’ï¼Œæ¯å¤©è®°å½•è‡ªå·±å­¦ä¹ æˆ’è‰²çš„çŸ¥è¯†å’Œé”»ç‚¼çš„æ„Ÿå—ï¼Œåå¤©ä¸ºä¸€ç¯‡æ–‡ç« ï¼Œåˆ†äº«è‡ªå·±çš„å¿ƒå¾—æ„Ÿæ‚Ÿã€‚</p>
]]></content>
      <categories>
        <category>ç™¾æ—¥ç­‘åŸº</category>
      </categories>
  </entry>
  <entry>
    <title>Linuxéƒ¨ç½²javaç¯å¢ƒ</title>
    <url>/2025/04/26/Linux%E9%83%A8%E7%BD%B2java%E7%8E%AF%E5%A2%83/</url>
    <content><![CDATA[<p>è¿œç¨‹è¿æ¥å·¥å…·<strong>FinalShell</strong>, åŠŸèƒ½ï¼šssh, ftp<br><br></p>
<br>

<h5 id="ä¸€-å®‰è£…é…ç½®JDK"><a href="#ä¸€-å®‰è£…é…ç½®JDK" class="headerlink" title="ä¸€. å®‰è£…é…ç½®JDK"></a>ä¸€. å®‰è£…é…ç½®JDK</h5><br>

<ol>
<li><p>åˆ©ç”¨FinalShellä¸Šä¼ æ–‡ä»¶åŠŸèƒ½ä¸Šä¼  jdk å®‰è£…åŒ…</p>
<br>
</li>
<li><p>è§£å‹ï¼š tar -zxvf å®‰è£…åŒ…å -C è§£å‹ç›®å½•, è¿™é‡Œæˆ‘çš„è§£å‹ç›®å½•æ˜¯ &#x2F;usr&#x2F;local</p>
<br>
</li>
<li><p>é…ç½®ç¯å¢ƒå˜é‡ï¼šæ“ä½œæ–‡ä»¶ &#x2F;etc&#x2F;profileï¼Œåœ¨æ–‡ä»¶æœ«å°¾åŠ ä¸Šï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">JAVA_HOME=/usr/local/jdk1.8.0_171</span><br><span class="line">PATH=$JAVA_HOME/bin:$PATH</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>é‡æ–°åŠ è½½æ–‡ä»¶ï¼Œæ£€æŸ¥æ˜¯å¦é…ç½®æˆåŠŸï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">source /etc/profile</span><br><span class="line">java -version</span><br></pre></td></tr></table></figure></li>
</ol>
<br>

<br>

<h5 id="äºŒ-å®‰è£…é…ç½®Tomcat"><a href="#äºŒ-å®‰è£…é…ç½®Tomcat" class="headerlink" title="äºŒ. å®‰è£…é…ç½®Tomcat"></a>äºŒ. å®‰è£…é…ç½®Tomcat</h5><br>

<ol>
<li><p>åˆ©ç”¨FinalShellä¸Šä¼ å®‰è£…åŒ…å¹¶è§£å‹åˆ° &#x2F;usr&#x2F;local&#x2F;</p>
<br>
</li>
<li><p>å¯åŠ¨tomcat</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /usr/local/tomcatæ–‡ä»¶çˆ¶ç›®å½•/bin</span><br><span class="line">sh startup.sh</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>æŸ¥çœ‹tomcatè¿è¡Œè¿›ç¨‹ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<p>ï¼ˆ1ï¼‰tomcat å¯åŠ¨æ—¥å¿— catalina.out</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">// æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶å°¾éƒ¨çš„50è¡Œè®°å½•</span><br><span class="line">tail -50 /usr/local/apache-tomcat-7.0.57/logs/catalina.out</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰æŸ¥çœ‹å¹¶ç­›é€‰ç³»ç»Ÿè¿›ç¨‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ps -ef|grep tomcat</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>é‚£ä¹ˆç°åœ¨è¿›è¡Œå¯åŠ¨äº†ï¼Œå°±è¯¥çœ‹çœ‹é˜²ç«å¢™äº†ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">// å…ˆå¼€å¯ç³»ç»Ÿé˜²ç«å¢™</span><br><span class="line">systemctl start firewalld</span><br><span class="line">// å†å¼€æ”¾8080ç«¯å£å·</span><br><span class="line">firewall-cmd --zone=public --add-port=8080/tcp --permanent</span><br><span class="line">// é‡æ–°åŠ è½½é˜²ç«å¢™</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>åœæ­¢Tomcatï¼Œä¸¤ç§æ–¹å¼:</p>
<p>ï¼ˆ1ï¼‰tomcatè„šæœ¬</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">// tomcatä¸­çš„binç›®å½•ä¸‹ï¼š</span><br><span class="line">sh shutdown.sh</span><br></pre></td></tr></table></figure>

<br>

<p>ï¼ˆ2ï¼‰ç»“æŸtomcatè¿›ç¨‹</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ps -ef|grep tomcat</span><br><span class="line">kill -9 tomcatè¿›ç¨‹å·</span><br></pre></td></tr></table></figure>

<br>

<br></li>
</ol>
<h5 id="ä¸‰-å®‰è£…é…ç½®MySQL"><a href="#ä¸‰-å®‰è£…é…ç½®MySQL" class="headerlink" title="ä¸‰. å®‰è£…é…ç½®MySQL"></a>ä¸‰. å®‰è£…é…ç½®MySQL</h5><br>

<ol>
<li><p>centosæˆ–è€…RHELç³»ç»Ÿè‡ªå¸¦mariadbæ•°æ®åº“ï¼Œè¿™ä¸ªæ•°æ®åº“å’ŒMySQLæ•°æ®åº“æ˜¯å†²çªçš„ï¼Œæ‰€ä»¥è¦æƒ³ä¿è¯MySQLæˆåŠŸå®‰è£…ï¼Œéœ€è¦å¸è½½mariadbæ•°æ®åº“ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">// æŸ¥çœ‹æŒ‡å®šè½¯ä»¶æ˜¯å¦å­˜åœ¨</span><br><span class="line">rpm -qa | grep mariadb</span><br><span class="line">æŸ¥è¯¢å½“å‰ç³»ç»Ÿä¸­å®‰è£…çš„åç§°å¸¦mariadbçš„è½¯ä»¶</span><br><span class="line">rpm -qa | grep mysql</span><br><span class="line">æŸ¥è¯¢å½“å‰ç³»ç»Ÿä¸­å®‰è£…çš„åç§°å¸¦mysqlçš„è½¯ä»¶</span><br><span class="line"></span><br><span class="line">// å¸è½½è½¯ä»¶</span><br><span class="line">// è¯­æ³•: rpm -e --nodeps è½¯ä»¶åç§°</span><br><span class="line">rpm -e --nodeps mariadb-libs-5.5.60-1.el7_5.x86_64</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>ä¸Šä¼ å¹¶è§£å‹, éœ€è¦è‡ªå·±åˆ›å»ºmysqlçˆ¶ç›®å½•</p>
<br>
</li>
<li><p>æŒ‰ç…§é¡ºåºå®‰è£…rpmå®‰è£…åŒ…</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">rpm -ivh mysql-community-common-5.7.25-1.el7.x86_64.rpm</span><br><span class="line">rpm -ivh mysql-community-libs-5.7.25-1.el7.x86_64.rpm</span><br><span class="line">rpm -ivh mysql-community-devel-5.7.25-1.el7.x86_64.rpm</span><br><span class="line">rpm -ivh mysql-community-libs-compat-5.7.25-1.el7.x86_64.rpm</span><br><span class="line">rpm -ivh mysql-community-client-5.7.25-1.el7.x86_64.rpm</span><br><span class="line">yum install net-tools</span><br><span class="line">rpm -ivh mysql-community-server-5.7.25-1.el7.x86_64.rpm</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>å¯åŠ¨mysql</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">systemctl status mysqld // æŸ¥çœ‹mysqlæœåŠ¡çŠ¶æ€</span><br><span class="line">systemctl start mysqld // å¯åŠ¨mysqlæœåŠ¡</span><br><span class="line">systemctl stop mysqld // åœæ­¢mysqlæœåŠ¡</span><br><span class="line"></span><br><span class="line">systemctl enable mysqld // å¼€æœºè‡ªå¯</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>æŸ¥çœ‹</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">netstat -tunlp | grep mysql // æŸ¥çœ‹mysqlçš„æœåŠ¡ä¿¡æ¯</span><br><span class="line">ps â€“ef | grep mysql // æŸ¥çœ‹mysqlè¿›ç¨‹</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>ç™»å½•</p>
<p>åˆæ¬¡ç™»å½•æŸ¥çœ‹é»˜è®¤ç”Ÿæˆçš„å¯†ç ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cat /var/log/mysqld.log | grep password</span><br></pre></td></tr></table></figure>

<p>ç™»å½•å¹¶ä¿®æ”¹å¯†ç ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mysql -uroot -p</span><br><span class="line"></span><br><span class="line">set global validate_password_length=4; //è®¾ç½®å¯†ç é•¿åº¦æœ€ä½ä½æ•°</span><br><span class="line">set global validate_password_policy=LOW; //è®¾ç½®å¯†ç å®‰å…¨ç­‰çº§ä½ï¼Œä¾¿äºå¯†ç å¯ä»¥ä¿®æ”¹æˆroot</span><br><span class="line">set password = password(&#x27;root&#x27;); // è®¾ç½®å¯†ç ä¸ºroot</span><br><span class="line"></span><br><span class="line">// å¼€å¯è®¿é—®æƒé™</span><br><span class="line">grant all on *.* to &#x27;root&#x27;@&#x27;%&#x27; identified by &#x27;root&#x27;;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure>

<br>

<p>è¿œç¨‹ç™»å½•: å·¥å…·ï¼šNavicat</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">// é˜²ç«å¢™å¼€å¯3306ç«¯å£</span><br><span class="line">firewall-cmd --zone=public --add-port=3306/tcp --permanent</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure>

<br>

<br></li>
</ol>
<h5 id="å››-å®‰è£…é…ç½®Redis"><a href="#å››-å®‰è£…é…ç½®Redis" class="headerlink" title="å››. å®‰è£…é…ç½®Redis"></a>å››. å®‰è£…é…ç½®Redis</h5><br>

<ol>
<li><p>å®‰è£…redisï¼š</p>
<br>

<p>ä¸‹è½½åœ°å€ï¼š<a href="https://download.redis.io/releases/redis-6.2.6.tar.gz">https://download.redis.io/releases/redis-6.2.6.tar.gz</a> ç¨³å®šç‰ˆï¼Œ ä¸Šä¼ å®‰è£…æ–‡ä»¶</p>
<br>

<p>è§£å‹ï¼Œç”¨gccç¼–è¯‘</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">è§£å‹ï¼š</span><br><span class="line">tar -zxvf redis-6.2.6.tar.gz -C /opt/</span><br><span class="line">ç¼–è¯‘ï¼š</span><br><span class="line">cd /opt/redis-6.2.6/</span><br><span class="line">make install   // è‡ªåŠ¨å®‰è£…åˆ° /usr/local/binä¸‹</span><br><span class="line"></span><br><span class="line">å®‰è£…çš„æ–‡ä»¶æè¿°ï¼š</span><br><span class="line">redis-benchmarkï¼šæ€§èƒ½æµ‹è¯•å·¥å…·</span><br><span class="line">redis-check-aofï¼šä¿®å¤aofæŒä¹…åŒ–æ–‡ä»¶</span><br><span class="line">redis-check-rdbï¼šä¿®å¤rdbæŒä¹…åŒ–æ–‡ä»¶</span><br><span class="line">redis-cliï¼šrediså‘½ä»¤è¡Œå·¥å…·</span><br><span class="line">redis-sentinelï¼šredisé›†ç¾¤å“¨å…µä½¿ç”¨</span><br><span class="line">redis-serverï¼šå¯åŠ¨redis</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>åå°å¯åŠ¨ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /opt/redis-6.2.6</span><br><span class="line">cp redis.conf  redis_1.conf</span><br><span class="line"></span><br><span class="line">vim redis_1.conf</span><br><span class="line">å°†daemonizeçš„noæ”¹æˆyesï¼ˆæŸ¥æ‰¾å†…å®¹ï¼š/+å†…å®¹ enter nï¼‰</span><br><span class="line"></span><br><span class="line">redis-server redis_1.conf</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>å¯åŠ¨å‘½ä»¤è¡Œå’Œé€€å‡ºredis</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">å‘½ä»¤è¡Œå¯åŠ¨ï¼š</span><br><span class="line">redis-cli</span><br><span class="line"></span><br><span class="line">é€€å‡ºredis:</span><br><span class="line">(1) å…ˆshutdown,å†æ‰§è¡Œexit</span><br><span class="line">(2) å…ˆexit,å†æ€æ­»redisè¿›ç¨‹id</span><br></pre></td></tr></table></figure>

<br>

<br></li>
</ol>
<h5 id="äº”-å®‰è£…lrzsz"><a href="#äº”-å®‰è£…lrzsz" class="headerlink" title="äº”. å®‰è£…lrzsz"></a>äº”. å®‰è£…lrzsz</h5><br>

<p>å¾ˆå¤šçš„è¿œç¨‹è¿æ¥å·¥å…·å¹¶æ²¡æœ‰ä¸Šä¼ ä¸‹è½½çš„åŠŸèƒ½ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ä¾èµ–äºlrzszè¿™ä¸ªè½¯ä»¶äº†ã€‚</p>
<br>

<ol>
<li><p>æ‰€æœ‰lrzszå®‰è£…åŒ…</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum list lrzsz</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>åœ¨çº¿å®‰è£…lrzszï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yum install lrzsz.x86_64</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>è¾“å…¥rzï¼Œå¼¹å‡ºä¸Šä¼ çš„çª—å£ï¼Œé€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶</p>
 <br>

<br></li>
</ol>
<h5 id="å…­-é¡¹ç›®éƒ¨ç½²"><a href="#å…­-é¡¹ç›®éƒ¨ç½²" class="headerlink" title="å…­. é¡¹ç›®éƒ¨ç½²"></a>å…­. é¡¹ç›®éƒ¨ç½²</h5><br>

<p>ï¼ˆ1ï¼‰æ‰‹åŠ¨éƒ¨ç½²é¡¹ç›®ï¼š</p>
<br>

<ol>
<li><p>æ‰“åŒ…ï¼Œåˆ©ç”¨lrzszçš„rzå‘½ä»¤ä¸Šä¼ ï¼Œè¿è¡Œå‘½ä»¤ï¼š java -jar åŒ…å </p>
<br>
</li>
<li><p>é‚£æˆ‘ä»¬å…³é—­å‘½ä»¤è¡Œï¼Œè¿™ä¸ªæ—¶å€™ä¸ç‚¸äº†å—ï¼ŸğŸƒï¼Œæˆ‘ä»¬å¯ä»¥åå°è¿è¡Œé¡¹ç›®ï¼Œå°†æ—¥å¿—è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nohup java -jar helloworld-1.0-SNAPSHOT.jar &amp;&gt; hello.log &amp;</span><br><span class="line">// nohup: ä¸æŒ‚èµ·</span><br><span class="line">// &amp;: è®©å‘½ä»¤åœ¨åå°è¿è¡Œ</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>åœæ­¢é¡¹ç›®ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ps -ef|grep java</span><br><span class="line">kill -9 è¿›ç¨‹å·</span><br></pre></td></tr></table></figure>

<br>

<br>

<br></li>
</ol>
<p>ï¼ˆ2ï¼‰åŸºäºshellè„šæœ¬è‡ªåŠ¨éƒ¨ç½²</p>
<br>

<ol>
<li><p>å°†ideaä¸­çš„é¡¹ç›®ä»£ç æ¨é€åˆ°è¿œç¨‹</p>
<br>
</li>
<li><p>ä¸‹è½½git, å…‹éš†è¿œç¨‹ä»£ç ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum list git // åˆ—å‡ºgitå®‰è£…åŒ…</span><br><span class="line">yum install git // åœ¨çº¿å®‰è£…git</span><br><span class="line">git --version  // gitå®‰è£…éªŒè¯</span><br><span class="line"></span><br><span class="line">git clone https://gitee.com/youre-not-as-handsome-as-me/demo.git</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>ä¸Šä¼ è§£å‹mavenå®‰è£…åŒ…åˆ° &#x2F;usr&#x2F;local&#x2F;, åœ¨&#x2F;etc&#x2F;profileæ–‡ä»¶ä¸­é…ç½®ç¯å¢ƒå˜é‡ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim /etc/profile</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œè¿›å…¥åˆ°å‘½ä»¤æ¨¡å¼ï¼ŒæŒ‰Gåˆ‡æ¢åˆ°æœ€åä¸€è¡Œï¼ŒæŒ‰a/i/oè¿›å…¥æ’å…¥æ¨¡å¼ï¼Œç„¶ååœ¨æœ€ååŠ å…¥å¦‚ä¸‹å†…å®¹ :</span><br><span class="line">export MAVEN_HOME=/usr/local/apache-maven-3.5.4</span><br><span class="line">export PATH=$JAVA_HOME/bin:$MAVEN_HOME/bin:$PATH</span><br><span class="line"></span><br><span class="line">é‡æ–°åŠ è½½å¹¶éªŒè¯</span><br><span class="line">source /etc/profile</span><br><span class="line">mvn -v</span><br></pre></td></tr></table></figure>

<br>

<p>åœ¨settings.xmlé…ç½®æ–‡ä»¶è®¾ç½®æœ¬åœ°ä»“åº“å’Œç§æœï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim /usr/local/apache-maven-3.5.4/conf/settings.xml</span><br><span class="line"></span><br><span class="line">&lt;localRepository&gt;/usr/local/repo&lt;/localRepository&gt;</span><br><span class="line"></span><br><span class="line">é˜¿é‡Œç§æœï¼š</span><br><span class="line">&lt;mirror&gt;</span><br><span class="line">	&lt;id&gt;alimaven&lt;/id&gt;</span><br><span class="line">    &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;</span><br><span class="line">    &lt;name&gt;aliyun maven&lt;/name&gt;</span><br><span class="line">    &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt;</span><br><span class="line">&lt;/mirror&gt;</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>ç¼–å†™shellè„šæœ¬bootStart.shæ‰§è¡Œéƒ¨ç½²æµç¨‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line">echo =================================</span><br><span class="line">echo  è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬å¯åŠ¨</span><br><span class="line">echo =================================</span><br><span class="line"></span><br><span class="line">echo åœæ­¢åŸæ¥è¿è¡Œä¸­çš„å·¥ç¨‹</span><br><span class="line">APP_NAME=demo</span><br><span class="line"></span><br><span class="line">tpid=`ps -ef|grep $APP_NAME|grep -v grep|grep -v kill|awk &#x27;&#123;print $2&#125;&#x27;`</span><br><span class="line">if [ $&#123;tpid&#125; ]; then</span><br><span class="line">    echo &#x27;Stop Process...&#x27;</span><br><span class="line">    kill -15 $tpid</span><br><span class="line">fi</span><br><span class="line">sleep 2</span><br><span class="line">tpid=`ps -ef|grep $APP_NAME|grep -v grep|grep -v kill|awk &#x27;&#123;print $2&#125;&#x27;`</span><br><span class="line">if [ $&#123;tpid&#125; ]; then</span><br><span class="line">    echo &#x27;Kill Process!&#x27;</span><br><span class="line">    kill -9 $tpid</span><br><span class="line">else</span><br><span class="line">    echo &#x27;Stop Success!&#x27;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">echo å‡†å¤‡ä»Gitä»“åº“æ‹‰å–æœ€æ–°ä»£ç </span><br><span class="line">cd /usr/local/demo</span><br><span class="line"></span><br><span class="line">echo å¼€å§‹ä»Gitä»“åº“æ‹‰å–æœ€æ–°ä»£ç </span><br><span class="line">git pull</span><br><span class="line">echo ä»£ç æ‹‰å–å®Œæˆ</span><br><span class="line"></span><br><span class="line">echo å¼€å§‹æ‰“åŒ…</span><br><span class="line">output=`mvn clean package -Dmaven.test.skip=true`</span><br><span class="line"></span><br><span class="line">cd target</span><br><span class="line"></span><br><span class="line">echo å¯åŠ¨é¡¹ç›®</span><br><span class="line">nohup java -jar demo-0.0.1-SNAPSHOT.jar &amp;&gt; demo.log &amp;</span><br><span class="line">echo é¡¹ç›®å¯åŠ¨å®Œæˆ</span><br></pre></td></tr></table></figure>

<br>

<p>èµ‹äºˆbootStart.shæƒé™, æ‰§è¡Œè„šæœ¬</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">chmod 777 bootStart.sh</span><br><span class="line">sh bootStart.sh</span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>é¢è¯•ç³»åˆ—ä¹‹redis</title>
    <url>/2025/04/28/%E9%9D%A2%E8%AF%95%E7%B3%BB%E5%88%97%E4%B9%8Bredis/</url>
    <content><![CDATA[<p>ä»‹ç»ï¼šredisæ˜¯ä¸€ç§æ— å…³ç³»å‹æ•°æ®åº“ï¼Œåœ¨é¡¹ç›®å’Œé¢è¯•ä¸­ç»å¸¸æåŠï¼Œæ­£å¥½å¼€å§‹ç³»ç»Ÿåœ°å­¦redisäº†ï¼Œä»Šå¤©æˆ‘ä»¬å°±ä»¥æ€»ç»“çš„æ–¹å¼å¼€å§‹javaé¢è¯•ä¹‹redisç¯‡ã€‚</p>
<br>

<br>

<h4 id="ä¸€-æŒä¹…åŒ–"><a href="#ä¸€-æŒä¹…åŒ–" class="headerlink" title="ä¸€. æŒä¹…åŒ–"></a>ä¸€. æŒä¹…åŒ–</h4><br>

<h5 id="ï¼ˆ1ï¼‰Redis-AOF"><a href="#ï¼ˆ1ï¼‰Redis-AOF" class="headerlink" title="ï¼ˆ1ï¼‰Redis AOF"></a>ï¼ˆ1ï¼‰Redis AOF</h5><p>ä»‹ç»ï¼š AOF(append only file) æ˜¯ä¸€ç§åªè®°å½•å†™æ“ä½œçš„æ—¥å¿—ï¼Œrediså…ˆæ‰§è¡Œå‘½ä»¤å†è®°å½•æ—¥å¿—ï¼Œredisä¸ä¼šæ£€æŸ¥æ—¥å¿—ï¼Œå¦‚æœ.aofæ—¥å¿—å‡ºç°é—®é¢˜çš„è¯ï¼Œé€šå¸¸å¯ä»¥ç”¨redis-check-aof å‘½ä»¤è¿›è¡Œä¿®å¤ã€‚</p>
<br>

<ol>
<li><p>AOFä¸‰ç§å†™å›ç­–ç•¥</p>
<p>åœ¨redisæ‰§è¡Œä¸€ä¸ªå†™å‘½ä»¤å®Œæˆåï¼Œå°±è®°å½•å†™æ—¥å¿—ï¼Œè¿™æ ·å¯¹redisçš„æ€§èƒ½ä¼šæœ‰è¾ƒå¤§çš„å½±å“ï¼Œå¦å¤–å¦‚æœè¿˜æ²¡æ¥å¾—åŠè®°å½•è®°æ—¥å¿—ï¼Œç³»ç»Ÿå°±å®•æœºäº†ï¼Œä¼šå¯¼è‡´æ•°æ®æ°¸ä¹…æ€§ä¸¢å¤±çš„é—®é¢˜ã€‚ä¸ºäº†è§£å†³ä»¥ä¸Šä¸¤ç§é—®é¢˜ï¼Œå¼•å…¥äº†AOFä¸‰ç§å†™å›ç­–ç•¥ï¼š</p>
<br>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">always: åŒæ­¥å†™å›</span><br><span class="line"></span><br><span class="line">everysec: å°†æ—¥å¿—å†™å…¥aofæ—¥å¿—ç¼“å†²åŒºï¼Œæ¯éš”ä¸€ç§’å†™å…¥ç£ç›˜æ–‡ä»¶ä¸­</span><br><span class="line"></span><br><span class="line">no: å°†æ—¥å¿—å†™å…¥aofæ—¥å¿—ç¼“å†²åŒºï¼Œç”±æ“ä½œç³»ç»Ÿå†³å®šä»€ä¹ˆæ—¶å€™å†™å…¥ç£ç›˜æ–‡ä»¶ä¸­</span><br></pre></td></tr></table></figure>

<br>

<p>ä»¥ä¸Šä¸‰ç§ç­–ç•¥ noçš„æ€§èƒ½æœ€å¥½ï¼Œä½†æ˜¯å¯èƒ½å¤§é‡ä¸¢å¤±æ•°æ®ã€‚ alwayså¤§æ¦‚ç‡ä¸ä¼šä¸¢å¤±æ•°æ®ï¼Œä½†æ€§èƒ½è¾ƒå·®ï¼Œæ‰€ä»¥é€šå¸¸ä¼šè¿™ç§é‡‡å–everysecç­–ç•¥ã€‚</p>
<br>
</li>
<li><p>AOFé‡å†™æœºåˆ¶</p>
<p>éšç€å†™æ“ä½œçš„æ•°é‡å¢å¤šï¼Œå ç”¨ç£ç›˜ç©ºé—´å¢å¤§ï¼Œä¸ºèŠ‚çœç£ç›˜ç©ºé—´ï¼Œå¯ä»¥é‡‡ç”¨AOFé‡å†™ï¼Œå³è¯»å–redisç°æœ‰çš„æ•°æ®ï¼Œæ ¹æ®æ•°æ®åˆ›å»ºå†™æ“ä½œçš„æ—¥å¿—ã€‚å¯ä»¥ä½¿ç”¨å‘½ä»¤ bgrewriteaof, å¯ä»¥åœ¨redis.confä¸­é…ç½®é‡å†™çš„ä¸´ç•Œæ¡ä»¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">auto-aof-rewrite-percentage 100</span><br><span class="line">auto-aof-rewrite-min-size 64mb</span><br></pre></td></tr></table></figure>

<br>

<p>äº†è§£äº†é‡å†™çš„ç›®çš„ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹é‡å†™çš„æµç¨‹ï¼š</p>
<p>bgrewriteaof å‘½ä»¤è¿›è¡Œé‡å†™ï¼Œå¦‚æœå½“å‰æœ‰é‡å†™æ­£åœ¨è¿›è¡Œå°±ç­‰å¾…ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œè¿™æ ·å°±ä¸ä¼šå¯¹ä¸»è¿›ç¨‹é€ æˆé˜»å¡ï¼Œå­è¿›ç¨‹å¾ªç¯éå†rediså†…å­˜æ•°æ®åˆ°ä¸´æ—¶æ–‡ä»¶ï¼Œåœ¨æ­¤æœŸé—´ï¼Œå®¢æˆ·ç«¯çš„å†™è¯·æ±‚ä¼šè®°å½•åˆ°aofç¼“å†²åŒºå’Œaofé‡å†™åŒºï¼Œç¡®ä¿åŸaofæ–‡ä»¶çš„å®Œæ•´å’Œæ–°çš„aofæ–‡ä»¶ç”ŸæˆæœŸé—´ä¸ä¼šæ¼æ‰å¢æ·»ä¿®æ”¹æ“ä½œï¼Œå­è¿›ç¨‹å†™å®Œæ–°çš„aofæ–‡ä»¶åå‘ä¸»è¿›ç¨‹å‘é€è¯·æ±‚ï¼Œä¸»è¿›ç¨‹æ¥æ”¶è¯·æ±‚åaofé‡å†™ç¼“å†²åŒºçš„æ•°æ®å†™å…¥æ–°çš„aofæ–‡ä»¶å¹¶ä¸”è¦†ç›–æ‰æ—§çš„aofæ–‡ä»¶ã€‚</p>
<br></li>
</ol>
<h5 id="ï¼ˆ2ï¼‰Redis-RDB"><a href="#ï¼ˆ2ï¼‰Redis-RDB" class="headerlink" title="ï¼ˆ2ï¼‰Redis RDB"></a>ï¼ˆ2ï¼‰Redis RDB</h5><p>RDB(Redis Database)æ˜¯ä¸€ç§å†…å­˜å¿«ç…§ï¼Œè®°å½•å†…å­˜æŸä¸€æ—¶åˆ»çš„æ•°æ®çŠ¶æ€ã€‚ä½¿ç”¨å‘½ä»¤bgsaveï¼Œå³åœ¨ä¸»è¿›ç¨‹å¤–åˆåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œç”±è¿™ä¸ªå­è¿›ç¨‹æ¥å®ŒæˆRDBå¿«ç…§ï¼Œå‡å¦‚å†…å­˜å¿«ç…§æœ‰6GBçš„å†…å­˜æ•°æ®é‡ï¼Œéœ€è¦5sçš„æ—¶é—´æ¥å®ŒæˆRDBæ–‡ä»¶çš„å†™å…¥ï¼Œé‚£ä¹ˆåœ¨è¿™5så†…ï¼Œä»æ—§éœ€è¦å°†è¿™ä¸ªæ—¶é—´æ®µå†…çš„æ·»åŠ å’Œä¿®æ”¹æ•°æ®çš„æ“ä½œå†™å…¥åˆ°RDBæ–‡ä»¶ä¸­ï¼Œè¿™ä¸ªæ—¶å€™å°±ç”¨åˆ°å†™æ—¶å¤åˆ¶æŠ€æœ¯ï¼Œå¯¹äºå¢æ·»ä¿®æ”¹æ“ä½œæ˜¯é€šè¿‡å¤åˆ¶ä¸€ä¸ªå‰¯æœ¬ï¼Œå­è¿›ç¨‹å†æ‰§è¡Œï¼Œæ‰€ä»¥å­è¿›ç¨‹æ˜¯ä¸€è¾¹å†™å¿«ç…§ï¼Œä¸€éæ‰§è¡Œä¸»è¿›ç¨‹çš„æ“ä½œï¼Œä»è€Œé˜²æ­¢å¿«ç…§å¯¼å…¥RDBæ–‡ä»¶æ—¶æ•°æ®çš„ä¸¢å¤±ã€‚</p>
<br>

<h5 id="ï¼ˆ3ï¼‰æ··åˆAOFå’ŒRDB"><a href="#ï¼ˆ3ï¼‰æ··åˆAOFå’ŒRDB" class="headerlink" title="ï¼ˆ3ï¼‰æ··åˆAOFå’ŒRDB"></a>ï¼ˆ3ï¼‰æ··åˆAOFå’ŒRDB</h5><p>redis.confä¸­æ‰“å¼€aofï¼Œæ‰“å¼€æ··åˆé…ç½®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set k1 v1</span><br><span class="line">set k2 v2</span><br><span class="line">set k3 v3</span><br><span class="line">bgrewriteaof</span><br><span class="line">set k4 v4</span><br><span class="line">set k5 v5</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šçš„æ‰§è¡Œç»“æœæ˜¯å‰ä¸‰æ¬¡æ“ä½œåçš„RDBå¿«ç…§æ˜¯aofæ–‡ä»¶çš„å‰ä¸€éƒ¨åˆ†ï¼Œåä¸¤ä¸ªæ“ä½œæ˜¯aofæ–‡ä»¶çš„åä¸€éƒ¨åˆ†ã€‚</p>
<p>å¦‚æœæ•°æ®ä¸èƒ½ä¸¢å¤±ï¼Œä½¿ç”¨AOFå’ŒRDBæ··åˆæ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ã€‚</p>
<br>

<h4 id="äºŒ-ä¸»ä»å¤åˆ¶"><a href="#äºŒ-ä¸»ä»å¤åˆ¶" class="headerlink" title="äºŒ. ä¸»ä»å¤åˆ¶"></a>äºŒ. ä¸»ä»å¤åˆ¶</h4><br>

<p>ç®€å•ç‚¹è¯´ï¼Œå°±æ˜¯ä¸»ä»åº“é‡‡ç”¨è¯»å†™åˆ†ç¦»çš„æ–¹å¼ï¼Œä¸»åº“è¿›è¡Œå†™æ“ä½œå¹¶å°†æ•°æ®åŒæ­¥ç»™ä»åº“ï¼Œä»åº“åªèƒ½è¿›è¡Œè¯»æ“ä½œã€‚</p>
<p>è¿™æ ·æ¥æå‡è¯»å–çš„æ€§èƒ½ã€‚</p>
<br>

<h6 id="ä¸»ä»åŒæ­¥åŸç†ï¼š"><a href="#ä¸»ä»åŒæ­¥åŸç†ï¼š" class="headerlink" title="ä¸»ä»åŒæ­¥åŸç†ï¼š"></a>ä¸»ä»åŒæ­¥åŸç†ï¼š</h6><ol>
<li>ç¬¬ä¸€é˜¶æ®µï¼š ä»åº“æ‰§è¡Œ replicaof å‘½ä»¤ï¼Œä¸»ä»åº“å»ºç«‹è¿æ¥ï¼Œä»åº“å‘ä¸»åº“å‘é€psyncæŒ‡ä»¤ï¼Œä¸»åº“è¿”å›ç»™ä»åº“å”¯ä¸€æ ‡è¯†runIDå’Œå¤åˆ¶è¿›åº¦offsetã€‚</li>
<li>ç¬¬äºŒé˜¶æ®µï¼šä¸»åº“å‘ä»åº“å‘é€rdbæ–‡ä»¶ï¼Œä»åº“æ¥æ”¶å¹¶åŠ è½½rdbæ–‡ä»¶</li>
<li>ç¬¬ä¸‰é˜¶æ®µï¼š å°†replication bufferå†…çš„æ•°æ®ï¼ˆå³rdbæ–‡ä»¶ç”Ÿæˆä¹‹åæ‰§è¡Œçš„å†™æ“ä½œï¼‰å‘é€ç»™ä»åº“ï¼Œä»åº“æ¥æ”¶å¹¶åŠ è½½ã€‚</li>
</ol>
<br>

<p>ä¸Šé¢ä»‹ç»äº†ä¸»ä»åŒæ­¥éƒ¨åˆ†ï¼Œé‚£å¦‚æœåªæœ‰ä¸€ä¸ªä¸»åº“çš„è¯ï¼Œä»åº“å¤šäº†ï¼Œä¸»åº“åŒæ­¥ç»™ä»åº“çš„å‹åŠ›å°±ä¼šå¢å¤§ã€‚è¿™ä¸ªæ—¶å€™å°±ç”¨åˆ°<strong>ä¸»ä»ä»æ¨¡å¼</strong>äº†ï¼Œå³åœ¨ä¸»ä»æ¨¡å¼çš„åŸºç¡€ä¸Šï¼Œä»åº“ä¸åœ¨replicaofåˆ°ä¸»åº“ï¼Œè€Œæ˜¯replicaofåˆ°å…¶ä»–ä»åº“ï¼Œä»è€Œè®©ä»åº“åˆ†æ‹…æ•°æ®åŒæ­¥çš„å‹åŠ›ã€‚</p>
<br>

<p>è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœåŒæ­¥è¿‡ç¨‹ä¸­ç½‘ç»œå¼‚å¸¸ï¼Œå†æ¬¡è¿æ¥å¯¼è‡´æ•°æ®ä¸¢å¤±æ€ä¹ˆåŠï¼Ÿredisé‡‡ç”¨<strong>repl_backlog_bufferç¼“å†²åŒº</strong>è®°å½•ä¸»åº“å†™åˆ°çš„ä½ç½®å’Œä»åº“è¯»åˆ°çš„ä½ç½®ã€‚è¿™æ ·å†æ¬¡è¿æ¥æ—¶ï¼Œå¦‚æœä»åº“è¯»åˆ°çš„ä½ç½®è½åäºä¸»åº“å†™åˆ°çš„ä½ç½®ï¼Œå°±ä¼šä»åº“ç»§ç»­è¯»å–ç›´è‡³ä¸åè€…ç›¸åŒã€‚</p>
<p>ç¼“å†²ç©ºé—´å¤§å°&#x3D;ä¸»åº“å†™å…¥é€Ÿåº¦ * æ“ä½œå¤§å°-ä¸»ä»åº“ç½‘ç»œä¼ è¾“é€Ÿåº¦ * æ“ä½œå¤§å°</p>
<p>repl_backlog_size&#x3D;ç¼“å†²ç©ºé—´å¤§å°*2</p>
<br>

<br>

<h4 id="ä¸‰-å“¨å…µæ¨¡å¼"><a href="#ä¸‰-å“¨å…µæ¨¡å¼" class="headerlink" title="ä¸‰. å“¨å…µæ¨¡å¼"></a>ä¸‰. å“¨å…µæ¨¡å¼</h4><br>

<p>ä¸‹é¢æ˜¯æ¯”è¾ƒç®€å•çš„å“¨å…µé›†ç¾¤çš„æ•ˆæœå›¾ï¼š</p>
<img src="\images\redis\å“¨å…µæ¨¡å¼.png" alt="å“¨å…µæ¨¡å¼" style="zoom:67%;" />

<br>

<p>æˆ‘ä»¬åœ¨è™šæ‹Ÿæœºçš„centosè¿™ä¸€ä¸ªæ“ä½œç³»ç»Ÿæ¨¡æ‹Ÿå“¨å…µé›†ç¾¤ï¼š ç”¨redis-serveræ¥å¯åŠ¨ä¸åŒæ¥å£çš„redisæœåŠ¡ï¼Œè®¾ç½®ä¸€ä¸»äºŒä»çš„å…³ç³»ï¼Œåœ¨ä»¥redis-sentinelå¯åŠ¨ä¸‰ä¸ªå“¨å…µï¼Œå“¨å…µçš„é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// ç«¯å£</span><br><span class="line">port 26379</span><br><span class="line">// ç›‘è§†  æ ¼å¼ï¼šsentinel monitor &lt;è‡ªå®šä¹‰çš„reidsä¸»èŠ‚ç‚¹åç§°&gt; &lt;IP&gt; &lt;port&gt; &lt;æ•°é‡&gt;</span><br><span class="line">sentinel monitor mymaster 127.0.0.1 6379 1</span><br><span class="line">// ä¸»èŠ‚ç‚¹å¤šå°‘æ¯«ç§’æœªåº”ç­”ï¼Œåˆ™ä¸‹çº¿</span><br><span class="line">sentinel down-after-milliseconds mymaster 30000</span><br></pre></td></tr></table></figure>

<br>

<h6 id="ï¼ˆ1ï¼‰-è”ç³»"><a href="#ï¼ˆ1ï¼‰-è”ç³»" class="headerlink" title="ï¼ˆ1ï¼‰ è”ç³»"></a>ï¼ˆ1ï¼‰ è”ç³»</h6><p>å¥½ï¼Œç°åœ¨åŸºæœ¬çš„æœåŠ¡éƒ½å¯åŠ¨äº†ï¼Œé‚£ä¹ˆæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ¯ä¸ªå“¨å…µéƒ½ç›‘è§†ä¸»åº“ï¼Œé‚£å“¨å…µæ˜¯å¦‚ä½•çŸ¥é“å½¼æ­¤çš„ï¼Ÿå“¨å…µåˆæ˜¯å¦‚ä½•ç›‘è§†ä»åº“çš„ï¼Ÿ</p>
<ol>
<li><p>æ˜¯é€šè¿‡redisçš„pub&#x2F;subå‘å¸ƒè®¢é˜…æœºåˆ¶å®ç°å“¨å…µçš„è”ç³»ï¼Œä¸»åº“masteræœ‰ä¸€æ¡_sentinel__:helloçš„ä¸“ç”¨é€šé“ï¼Œç”¨äºå“¨å…µä¹‹é—´è®¢é˜…å‘é€æ¶ˆæ¯ã€‚å°±å¥½åƒæ˜¯masterå»ºäº†ä¸€ä¸ªå¾®ä¿¡ç¾¤ï¼Œå“¨å…µå¯ä»¥å‘é€æ¶ˆæ¯ï¼Œå¯ä»¥çœ‹åˆ°å…¶ä»–å“¨å…µçš„æ¶ˆæ¯ã€‚</p>
</li>
<li><p>å“¨å…µå‘ä¸»åº“masterå‘é€infoå‘½ä»¤ï¼Œä¸»åº“å°†ä»åº“åˆ—è¡¨è¿”å›ç»™å“¨å…µï¼Œå“¨å…µå’Œä»åº“å»ºç«‹å’Œä»åº“å»ºç«‹è¿æ¥ï¼Œç›‘è§†ä»åº“ã€‚</p>
<br></li>
</ol>
<h6 id="ï¼ˆ2ï¼‰è¿è¡Œ"><a href="#ï¼ˆ2ï¼‰è¿è¡Œ" class="headerlink" title="ï¼ˆ2ï¼‰è¿è¡Œ"></a>ï¼ˆ2ï¼‰è¿è¡Œ</h6><p>ä»‹ç»å®Œè”ç³»ä¹‹åçœ‹çœ‹å¦‚æœä¸»åº“å®•æœºï¼Œå“¨å…µé›†ç¾¤å¦‚ä½•åˆ¤æ–­ä¸»åº“å®•æœºçš„ï¼Ÿæ˜¯å¦‚ä½•é€‰å–æ–°çš„ä¸»åº“çš„ï¼Ÿ</p>
<p>åˆ¤æ–­ä¸»åº“å®•æœºå’Œé€‰å–æ–°çš„ä¸»åº“çš„è¿‡ç¨‹éƒ½è®¾è®¡åˆ°å“¨å…µå°‘æ•°æœä»å¤šæ•°çš„åŸåˆ™ï¼Œæ‰€ä»¥å“¨å…µçš„æ•°é‡åº”è¯¥æ˜¯å¥‡æ•°æ›´åˆé€‚ï¼Œä¸»åº“è¢«å“¨å…µé›†ç¾¤ç›‘æ§ï¼Œå¤šæ•°å“¨å…µåˆ¤æ–­ä¸»åº“ä¸‹çº¿äº†ï¼Œé‚£è®¤ä¸ºä¸»åº“å®•æœºäº†ï¼Œè¿™ä¸ªæ—¶å€™è¦é€‰å–æ–°çš„ä¸»åº“ï¼Œé‚£ç”±é‚£ä¸ªå“¨å…µæ¥è¿›è¡Œå‘¢ï¼Œè¿™ä¸ªæ—¶å€™ä¾æ—§æ˜¯å°‘æ•°æœä»å¤šæ•°ï¼Œå¾—åˆ°å¤šæ•°æŠ•ç¥¨çš„é‚£ä¸ªå“¨å…µæ¥é€‰å–æ–°çš„ä¸»åº“ï¼Œé€‰å–æ–°çš„ä¸»åº“æœ‰ä¸‰ä¸ªç­›é€‰æ¡ä»¶ï¼Œä¸€æ˜¯é€‰å–æ¯ä¸ªä»åº“é…ç½®ä¸­ä¼˜å…ˆçº§æœ€å¤§çš„é‚£ä¸ªï¼Œè¿™é€šå¸¸æ„å‘³ç€è¿™ä¸ªä»åº“çš„é…ç½®æ›´é«˜ï¼Œå†…å­˜æ›´å¤§ã€‚äºŒæ˜¯é€‰å–repl_backlog_bufferç¼“å†²åŒºä¸­å’Œä¸»åº“å†™æ“ä½œçš„ä½ç½®æœ€æ¥è¿‘çš„é‚£ä¸ªä»åº“ã€‚ä¸‰æ˜¯æ¯ä¸ªrediså®ä¾‹éƒ½æœ‰ä¸€ä¸ªid,é€‰æ‹©idæœ€å°çš„ã€‚</p>
<br>

<br>

<br>

<h4 id="å››-åˆ†ç‰‡é›†ç¾¤"><a href="#å››-åˆ†ç‰‡é›†ç¾¤" class="headerlink" title="å››. åˆ†ç‰‡é›†ç¾¤"></a>å››. åˆ†ç‰‡é›†ç¾¤</h4><br>

<h6 id="ï¼ˆ1ï¼‰é…ç½®"><a href="#ï¼ˆ1ï¼‰é…ç½®" class="headerlink" title="ï¼ˆ1ï¼‰é…ç½®"></a>ï¼ˆ1ï¼‰é…ç½®</h6><p>æˆ‘ä»¬ä¾æ—§åœ¨åŒä¸€ä¸ªè™šæ‹Ÿä¸»æœºå®Œæˆï¼Œredis-serverå¯åŠ¨å…­ä¸ªæ¥å£çš„redisæœåŠ¡, é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">include redis.conf</span><br><span class="line">pidfile &quot;/var/run/redis_6379.pid&quot;</span><br><span class="line">port 6379</span><br><span class="line">dbfilename &quot;dump6379.rdb&quot;</span><br><span class="line"></span><br><span class="line"># æ‰“å¼€é›†ç¾¤æ¨¡å¼</span><br><span class="line">cluster-enabled yes</span><br><span class="line"># è®¾å®šèŠ‚ç‚¹é…ç½®æ–‡ä»¶</span><br><span class="line">cluster-config-file nodes-6379.conf</span><br><span class="line"># è®¾ç½®èŠ‚ç‚¹å¤±è”æ—¶é—´ï¼Œè¶…è¿‡ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œä¸»ä»åˆ‡æ¢</span><br><span class="line">cluster-node-timeout 15000</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹redis.confæ–‡ä»¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bind 127.0.0.1 192.168.230.30(è™šæ‹Ÿä¸»æœºip)</span><br></pre></td></tr></table></figure>

<p>å…­ä¸ªæœåŠ¡å¯åŠ¨</p>
<p>å…­ä¸ªæœåŠ¡åˆæˆä¸€ä¸ªé›†ç¾¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">redis-cli --cluster create --cluster-replicas 1 192.168.230.30:6379</span><br><span class="line">192.168.230.30:6380 192.168.230.30:6381 192.168.230.30:6579 192.168.230.30:6580</span><br><span class="line">192.168.230.30:6581</span><br><span class="line">// --cluster create: hash slotå¹³å‡åˆ†é…åˆ°å®ä¾‹ä¸­</span><br><span class="line">// --cluster-replicas 1: ä¸»ä»æ¯”ä¾‹1:1</span><br></pre></td></tr></table></figure>

<br>

<h6 id="ï¼ˆ2ï¼‰åŸç†ä»¥åŠå¸¸ç”¨å‘½ä»¤"><a href="#ï¼ˆ2ï¼‰åŸç†ä»¥åŠå¸¸ç”¨å‘½ä»¤" class="headerlink" title="ï¼ˆ2ï¼‰åŸç†ä»¥åŠå¸¸ç”¨å‘½ä»¤"></a>ï¼ˆ2ï¼‰åŸç†ä»¥åŠå¸¸ç”¨å‘½ä»¤</h6><p>ä¸€ä¸ªåˆ†ç‰‡é›†ç¾¤æœ‰16384ä¸ªæ§½ï¼Œæˆ‘ä»¬å‘é›†ç¾¤ä¸­å­˜å‚¨é”®å€¼å¯¹çš„æ—¶å€™ï¼Œæ ¹æ®é”®å€¼å¯¹çš„key, æŒ‰ç…§CRC16ç®—æ³•è®¡ç®—å‡ºä¸€ä¸ª16bitçš„å€¼ï¼Œç”¨è¿™ä¸ªå€¼å¯¹16384å–æ¨¡è¿ç®—ï¼Œå¾—åˆ°çš„æ•°ä»£è¡¨å¯¹åº”çš„ç¼–å·çš„å“ˆå¸Œæ§½hash slotã€‚</p>
<br>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">redis-cli -c -p 6379</span><br><span class="line">// å››å¤§æ•°æ®ç±»å‹ï¼Œbitmap,HyperLogLog æ“ä½œ</span><br><span class="line">cluster nodes // æ˜¾ç¤ºé›†ç¾¤å„ä¸ªèŠ‚ç‚¹ä¿¡æ¯</span><br><span class="line">cluster keyslot &lt;key&gt;</span><br><span class="line">cluster countkeyinslot &lt;slot&gt;</span><br><span class="line">cluster getkeysinslot &lt;slot&gt; &lt;count&gt;</span><br></pre></td></tr></table></figure>

<br>

<p>å› ä¸ºä¸»ä»æ¯”ä¾‹ä¸º1:1ï¼Œæ‰€ä»¥å¦‚æœå…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹çš„ä¸»åº“å®•æœºï¼Œä»åº“å°±ä¼šæ¥æ‰‹ï¼Œå½“å¦‚æœè¯¥èŠ‚ç‚¹ä¸»ä»åº“å…¨éƒ¨å®•æœºçš„è¯ï¼Œé»˜è®¤æ•´ä¸ªé›†ç¾¤éƒ½æŒ‚æ‰ã€‚é»˜è®¤é…ç½®ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cluster-require-full-coverage yes</span><br></pre></td></tr></table></figure>

<p>å¦‚æœé…ç½®ä¸ºnoçš„è¯ï¼Œåªæœ‰è¯¥èŠ‚ç‚¹ä¸å¯å­˜å–æ•°æ®ï¼Œæ•´ä¸ªé›†ç¾¤ä¸ä¼šæŒ‚æ‰ã€‚</p>
<br>

<br>

<h4 id="äº”-Geospatial"><a href="#äº”-Geospatial" class="headerlink" title="äº”. Geospatial"></a>äº”. Geospatial</h4><br>

<p>é€šå¸¸ç”¨äºè¡¨ç¤ºåæ ‡ç›¸å…³æ•°æ®ï¼Œå¯ä»¥è®¡ç®—åæ ‡è·ç¦»å‘€ï¼Œä¸€ä¸ªåæ ‡èŒƒå›´å†…çš„å…¶ä»–åæ ‡å‘€ï¼Œå¯ä»¥çœ‹åšæ˜¯redisç¬¬å…­ç§æ•°æ®ç»“æ„äº†ï¼ŒåŸºäºzsetæœ‰åºé›†åˆï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯å®ƒçš„åˆ†æ•°æ˜¯ç”±åæ ‡è®¡ç®—è€Œæ¥ã€‚</p>
<br>

<h6 id="ï¼ˆ1ï¼‰geoåŸç†"><a href="#ï¼ˆ1ï¼‰geoåŸç†" class="headerlink" title="ï¼ˆ1ï¼‰geoåŸç†"></a>ï¼ˆ1ï¼‰geoåŸç†</h6><p>geoæ˜¯å¦‚ä½•æ ¹æ®åæ ‡è®¡ç®—åˆ†æ•°çš„ï¼Ÿç­”æ¡ˆä¾¿æ˜¯GEOHashç¼–ç ï¼Œå°†ç»çº¬åº¦åˆ†åˆ«è¿›è¡Œç¼–ç ï¼Œå†äº¤å‰åˆå¹¶ï¼Œåˆå¹¶çš„å€¼ä½œä¸ºgeoå…ƒç´ çš„æƒé‡ã€‚  </p>
<br>

<ol>
<li><p>ç»çº¬åº¦ç¼–ç ï¼šåšNæ¬¡äºŒåˆ†åŒºï¼Œæ¯”å¦‚ç»åº¦ä¸º135ï¼Œåšç¬¬ä¸€æ¬¡äºŒåˆ†åŒºï¼Œåˆ¤æ–­æ˜¯ä½äº[-180, 0)è¿˜æ˜¯[0, 180], å·¦åˆ†åŒºç”¨0è¡¨ç¤ºï¼Œå³åˆ†åŒºç”¨1è¡¨ç¤ºï¼Œ135ä½äºå³åˆ†åŒºï¼Œç”¨1è¡¨ç¤ºï¼Œæ‰€ä»¥æœ€åè·å¾—äº†Nä½0æˆ–1ç»„æˆçš„ç¼–ç ã€‚</p>
</li>
<li><p>äº¤å‰åˆå¹¶: åˆå¹¶çš„ç»“æœç¬¬ä¸€ä½æ˜¯ç»åº¦ç¼–ç çš„ç¬¬ä¸€ä½ï¼Œç»“æœçš„ç¬¬äºŒä½æ˜¯çº¬åº¦ç¼–ç çš„ç¬¬ä¸€ä½ï¼Œå°±è¿™æ ·ç»çº¬åº¦äº¤å‰è¿›è¡Œã€‚</p>
<br></li>
</ol>
<h6 id="ï¼ˆ2ï¼‰geoåº”ç”¨"><a href="#ï¼ˆ2ï¼‰geoåº”ç”¨" class="headerlink" title="ï¼ˆ2ï¼‰geoåº”ç”¨"></a>ï¼ˆ2ï¼‰geoåº”ç”¨</h6><ol>
<li><p>è®¡ç®—ä¸¤ä¸ªä½ç½®çš„è·ç¦»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">geodist key member1 member2</span><br></pre></td></tr></table></figure>

<br>
</li>
<li><p>è·å–é™„è¿‘çš„geoå…ƒç´ </p>
<p>å¦‚è·å–è·ç¦»è‡ªå·±500mä»¥å†…çš„å¥³ç¥å§“åï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">georadius key è‡ªå·±ä½ç½®ä¿¡æ¯ 500 m [ASC|DESC] [count number]</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ç†è§£ä¸ºå°†äºŒç»´ä½ç½®æ˜ å°„åˆ°ä¸€ç»´çš„çº¿ä¸Šï¼Œè·ç¦»è¾ƒè¿‘çš„ä¸¤ä¸ªç‚¹ï¼Œå®é™…è·ç¦»ä¹Ÿæ˜¯æ¯”è¾ƒè¿‘çš„ã€‚</p>
<br>

<br></li>
</ol>
<h4 id="å…­-äº‹åŠ¡"><a href="#å…­-äº‹åŠ¡" class="headerlink" title="å…­. äº‹åŠ¡"></a>å…­. äº‹åŠ¡</h4><br>

<p>redisäº‹åŠ¡åˆ†ä¸ºåŸå­æ€§ï¼Œä¸€è‡´æ€§ï¼Œéš”ç¦»æ€§å’ŒæŒä¹…æ€§ã€‚</p>
<br>

<ol>
<li><p>åŸå­æ€§ï¼šäº‹åŠ¡ä¸­æ‰€æœ‰çš„æŒ‡ä»¤è¦ä¹ˆéƒ½æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œã€‚</p>
<p>å¯ä»¥æ ¹æ®é”™è¯¯çš„å‘ç”Ÿæ—¶æœºåˆ†ä¸ºEXECå‘½ä»¤æ‰§è¡Œå‰æŠ¥é”™ï¼Œæ‰§è¡Œæ—¶å‘ç”Ÿæ•…éšœï¼Œæ‰§è¡ŒåæŠ¥é”™è¿™ä¸‰ç§æƒ…å†µæ¥è®¨è®ºï¼Œåœ¨é”™è¯¯å‘½ä»¤å…¥é˜Ÿæ—¶ï¼Œrediså°±ä¼šæŠ¥é”™å¹¶è®°å½•è¿™ä¸ªé”™è¯¯ï¼Œå…¶ä»–å‘½ä»¤è¿˜èƒ½æ¥ç€å…¥é˜Ÿï¼Œåˆ°æ‰§è¡ŒEXECå‘½ä»¤æ—¶ï¼Œå°±ä¼šæŠ¥é”™ï¼Œæ•´ä¸ªäº‹åŠ¡å°±ä¸èƒ½æ‰§è¡Œã€‚å¦‚æœEXECå‘½ä»¤æ‰§è¡Œå‰æ²¡æŠ¥é”™ï¼Œæ‰§è¡Œæ—¶å‘ç”Ÿæ•…éšœï¼Œåªæœ‰éƒ¨åˆ†äº‹åŠ¡è®°å½•åˆ°AOFæ—¥å¿—æ–‡ä»¶ä¸­ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨redis-check-aofå·¥å…·å°†æœªå®Œæˆçš„äº‹åŠ¡ä»æ—¥å¿—ä¸­åˆ é™¤ï¼Œä»è€Œä¿è¯åŸå­æ€§ã€‚å¦‚æœå‰ä¸¤è€…éƒ½æ²¡é—®é¢˜ï¼Œåˆ°äº†æ‰§è¡ŒåæŠ¥é”™ï¼Œé‚£è¿™ä¸ªæ—¶å€™å¤§å¤šæ•°éƒ½æ˜¯äº‹åŠ¡ä¸­æ‰§è¡Œçš„æŒ‡ä»¤ä¸€èˆ¬éƒ½å’Œæ“ä½œç±»å‹ä¸åŒ¹é…æ‰å¯¼è‡´æŠ¥é”™ï¼Œæ­£ç¡®çš„æŒ‡ä»¤èƒ½æ‰§è¡Œï¼Œé”™è¯¯çš„æŒ‡ä»¤æ— æ³•æ‰§è¡Œï¼Œå› ä¸ºredisä¸æ”¯æŒå›æ»šï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™å°±æ— æ³•ä¿è¯åŸå­æ€§äº†ã€‚</p>
<br>
</li>
<li><p>ä¸€è‡´æ€§ï¼šäº‹åŠ¡æ‰§è¡Œå‰åï¼Œæ•°æ®åº“çŠ¶æ€ä¿æŒä¸€è‡´ï¼Œç¬¦åˆé¢„æœŸçš„è§„åˆ™å’Œçº¦æŸï¼Œæ¯”å¦‚è¯´ä¸»å¤–é”®å…³è”ï¼Œå®Œæ•´æ€§çº¦æŸç­‰ä¸€äº›æ•°æ®åº“å†…éƒ¨è§„åˆ™ä¸èƒ½è¢«ç ´åã€‚</p>
<p>æ‰§è¡Œå‰ï¼Œå…¥é˜ŸæŠ¥é”™ï¼Œäº‹åŠ¡ä¸æ‰§è¡Œï¼Œèƒ½ç¡®ä¿ä¸€è‡´æ€§ã€‚æ‰§è¡Œæ—¶æ•…éšœï¼Œä¸€è‡´æ€§å’Œæ•°æ®æ¢å¤æ–¹å¼æœ‰å…³ï¼šå¦‚æœåªå¼€å¯RDBå¿«ç…§ï¼Œäº‹åŠ¡æ“ä½œçš„ç»“æœæ²¡æœ‰è¢«ä¿å­˜åˆ°å¿«ç…§ä¸­ï¼Œå®ä¾‹é‡å¯æ—¶ï¼Œæ•°æ®æ˜¯ä¸€è‡´çš„ã€‚å¦‚æœå¼€å¯äº†RDBå’ŒAOFæ—¥å¿—ï¼Œéƒ¨åˆ†æ“ä½œè¢«è®°å½•åˆ°AOFæ—¥å¿—ä¸­ï¼Œå¯ä»¥ä½¿ç”¨redis-check-aofæ¸…é™¤äº‹åŠ¡ä¸­å·²ç»å®Œæˆçš„æ“ä½œä¿è¯äº‹åŠ¡çš„åŸå­æ€§ï¼Œä»è€Œä¿è¯äº†ä¸€è‡´æ€§ã€‚å¦‚æœEXECå‘½ä»¤æ‰§è¡ŒåæŠ¥é”™ï¼Œæ­£ç¡®çš„æŒ‡ä»¤å·²ç»æ‰§è¡Œï¼Œé”™è¯¯çš„æŒ‡ä»¤æ²¡æœ‰æ‰§è¡Œï¼Œå¯ä»¥ä¿è¯ä¸€è‡´æ€§ã€‚</p>
<br>
</li>
<li><p>éš”ç¦»æ€§ï¼šå¤šä¸ªäº‹åŠ¡å¹¶è¡Œæ‰§è¡Œæ—¶ï¼Œäº’ä¸å¹²æ‰°ã€‚</p>
<p>å¹¶å‘æ“ä½œåœ¨EXECå‘½ä»¤æ‰§è¡Œå‰æ‰§è¡Œï¼Œéœ€è¦é€šè¿‡WATCHæœºåˆ¶è¿›è¡Œä¿è¯ï¼ŒWATCHæœºåˆ¶çš„ä½œç”¨æ˜¯ç›‘è§†è¯¥äº‹åŠ¡æ“ä½œçš„ä¸€ä¸ªæˆ–å¤šä¸ªé”®æ˜¯å¦è¢«å…¶ä»–äº‹åŠ¡ä¿®æ”¹ï¼Œå¦‚æœè¢«ä¿®æ”¹ï¼Œå°±æ”¾å¼ƒæ‰§è¡Œè¯¥äº‹åŠ¡ä»è€Œä¿è¯äº‹åŠ¡çš„éš”ç¦»æ€§ã€‚å¹¶å‘æ“ä½œåœ¨EXECå‘½ä»¤æ‰§è¡Œåæ‰§è¡Œä¸ä¼šç ´åäº‹åŠ¡çš„éš”ç¦»æ€§ï¼Œå› ä¸ºredisä½¿ç”¨å•çº¿ç¨‹æ‰§è¡Œå‘½ä»¤ï¼Œè€Œä¸”æ‰§è¡Œå®Œå‘½ä»¤ï¼Œå®ƒè¿˜ä¼šä¿è¯å‰ä¸€ä¸ªäº‹åŠ¡çš„æ‰€æœ‰å‘½ä»¤æ‰§è¡Œå®Œä¹‹åæ‰ä¼šæ‰§è¡Œä¹‹åçš„äº‹åŠ¡ã€‚</p>
<br>
</li>
<li><p>æŒä¹…æ€§ï¼š</p>
<p>æ²¡æœ‰ä½¿ç”¨RDBå’ŒAOFï¼Œæ•°æ®ä¸¢å¤±</p>
<p>åªä½¿ç”¨RDBå¿«ç…§ï¼Œé‚£ä¹ˆåœ¨äº‹åŠ¡æ‰§è¡Œä¹‹åï¼Œå¿«ç…§æ‰§è¡Œä¹‹å‰å‘ç”Ÿå®•æœºï¼Œä¹Ÿä¼šæ•°æ®ä¸¢å¤±ï¼Œé‡‡ç”¨äº†RDBå’ŒAOFï¼ŒAOFçš„ä¸‰ç§é…ç½®é€‰é¡¹no, everysecå’Œalwaysä¹Ÿä¼šå‡ºç°æ•°æ®ä¸¢å¤±çš„æƒ…å†µï¼Œæ‰€ä»¥äº‹åŠ¡çš„æŒä¹…æ€§ä¸èƒ½ä¿è¯ã€‚</p>
<br>

<br>

<p>redisçš„äº‹åŠ¡å¯ä»¥ä¿è¯ä¸€è‡´æ€§å’Œéš”ç¦»æ€§ï¼Œå…·å¤‡ä¸€å®šçš„åŸå­æ€§ä½†ä¸æ”¯æŒå›æ»šï¼Œæ— æ³•ä¿è¯æŒä¹…æ€§ã€‚</p>
<br>

<br></li>
</ol>
<h4 id="ä¸ƒ-ç¼“å­˜"><a href="#ä¸ƒ-ç¼“å­˜" class="headerlink" title="ä¸ƒ. ç¼“å­˜"></a>ä¸ƒ. ç¼“å­˜</h4><p>redisç¼“å­˜å±äºæ—è·¯å‹ç¼“å­˜ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æƒ…å†µï¼šç¼“å­˜å‘½ä¸­å’Œç¼“å­˜ç¼ºå¤±ï¼Œä¸¤ç§ç±»å‹ï¼šåªè¯»ç¼“å­˜å’Œè¯»å†™ç¼“å­˜ã€‚</p>
<p>è¯»å–æ•°æ®æ—¶å¦‚æœç¼“å­˜å‘½ä¸­ï¼Œç›´æ¥è¿”å›ï¼Œå¦‚æœç¼“å­˜ç¼ºå¤±ï¼Œå‘æ•°æ®åº“è®¿é—®ï¼Œå¹¶åˆ·æ–°ç¼“å­˜ã€‚å‘ç¼“å­˜å†™æ•°æ®æ—¶ï¼Œç¼“å­˜å°†æ•°æ®åˆ·æ–°ç»™æ•°æ®åº“æ—¶å¯ä»¥åŒæ­¥ç›´å†™ï¼Œä¹Ÿå¯ä»¥å¼‚æ­¥å†™å›ã€‚</p>
<br>

<h5 id="ï¼ˆ1ï¼‰ç¼“å­˜æ•°æ®çš„åˆ é™¤"><a href="#ï¼ˆ1ï¼‰ç¼“å­˜æ•°æ®çš„åˆ é™¤" class="headerlink" title="ï¼ˆ1ï¼‰ç¼“å­˜æ•°æ®çš„åˆ é™¤"></a>ï¼ˆ1ï¼‰ç¼“å­˜æ•°æ®çš„åˆ é™¤</h5><ol>
<li><h6 id="åˆ é™¤ç­–ç•¥"><a href="#åˆ é™¤ç­–ç•¥" class="headerlink" title="åˆ é™¤ç­–ç•¥"></a>åˆ é™¤ç­–ç•¥</h6></li>
</ol>
<p>ç¼“å­˜æ•°æ®çš„åˆ é™¤å¤§å¤šæƒ…å†µä¸‹éƒ½æ˜¯è¿‡æœŸæ•°æ®çš„åˆ é™¤ï¼Œredisä¸­åˆ é™¤è¿‡æœŸæ•°æ®æœ‰ä¸¤ç§ç­–ç•¥ï¼šæƒ°æ€§åˆ é™¤å’Œå®šæœŸåˆ é™¤ã€‚æƒ°æ€§åˆ é™¤æ˜¯æ•°æ®è¿‡æœŸäº†ï¼Œå½“å†æ¬¡è®¿é—®è¯¥æ•°æ®æ—¶ä½¿ç”¨å†…éƒ¨å‡½æ•°expirelfNeededè¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœè¿‡æœŸï¼Œè¿›è¡Œåˆ é™¤ï¼ŒèŠ‚çº¦CPUèµ„æºä½†å†…å­˜å ç”¨å¤§ã€‚å®šæœŸåˆ é™¤æ˜¯æ¯éš”ä¸€æ®µæ—¶é—´è°ƒç”¨å‡½æ•°æŠ½å–20ä¸ªkeyè¿›è¡Œæ£€æµ‹ï¼Œåˆ é™¤è¿‡æœŸçš„keyï¼Œå¦‚æœè¿‡æœŸçš„keyçš„æ•°é‡å¤§äº25%ï¼Œé‚£å°±å¾ªç¯æ‰§è¡Œï¼Œæœ€å¤šæ‰§è¡ŒNæ¬¡ï¼Œè¿™ä¸ªNæ˜¯å¯ä»¥è®¾ç½®çš„ã€‚</p>
<br>

<ol start="2">
<li><h6 id="æ·˜æ±°ç­–ç•¥"><a href="#æ·˜æ±°ç­–ç•¥" class="headerlink" title="æ·˜æ±°ç­–ç•¥"></a>æ·˜æ±°ç­–ç•¥</h6></li>
</ol>
<p>é‚£ä¹ˆå½“ç¼“å­˜çš„æ•°æ®è¶…è¿‡ç¼“å­˜çš„å®¹é‡æ—¶ï¼Œè¯¥å¦‚ä½•æ˜¯å¥½ï¼Ÿè¿™ä¸ªæ—¶å€™å°±è¦ç”¨åˆ°é€å‡ºç®—æ³•äº†ï¼Œåˆ¶å®šç¼“å­˜æ·˜æ±°ç­–ç•¥ã€‚</p>
<br>

<p>é’ˆå¯¹è¿‡æœŸæ•°æ®çš„æ·˜æ±°ç­–ç•¥æœ‰å››ç§ï¼š</p>
<p>valotile-ttl : æŒ‰ç…§è¿‡æœŸæ—¶é—´çš„å…ˆåé¡ºåºåˆ é™¤</p>
<p>valotile-random: éšæœºåˆ é™¤</p>
<p>valotile-lru: ä½¿ç”¨LRUç®—æ³•ç­›é€‰è¿‡æœŸçš„é”®å€¼å¯¹åˆ é™¤</p>
<p>valotile-lfu: ä½¿ç”¨LFUç®—æ³•ç­›é€‰è¿‡æœŸçš„é”®å€¼å¯¹åˆ é™¤</p>
<br>

<p>é’ˆå¯¹æ‰€æœ‰æ•°æ®æœ‰ä¸‰ç§ï¼šallkeys-random   allkeys-lru   allkeys-lfu</p>
<br>

<p>LRUç®—æ³•æ˜¯å°†æœ€è¿‘ä¸ç”¨çš„æ•°æ®ç­›é€‰å‡ºæ¥ã€‚éœ€è¦ç»´æŠ¤ä¸€ä¸ªé“¾è¡¨æ¥ç®¡ç†æ‰€æœ‰çš„ç¼“å­˜æ•°æ®ï¼Œæ•°æ®è¢«è®¿é—®æ—¶ï¼Œæ‰§è¡Œé“¾è¡¨æ•°æ®çš„ç§»åŠ¨ï¼Œåˆ©ç”¨é“¾è¡¨çš„é¡ºåºç­›åºå‡ºNä¸ªæ•°æ®ï¼Œå†å°†æœ€å°çš„æ•°æ®æ·˜æ±°ã€‚</p>
<p>LFUç®—æ³•æ˜¯å°†ä½¿ç”¨é¢‘ç‡æœ€å°çš„æ•°æ®ç­›é€‰å‡ºæ¥ã€‚æ¯ä¸ªæ•°æ®å—éƒ½æœ‰ä¸€ä¸ªå¼•ç”¨è®¡æ•°ï¼Œç»´æŠ¤ä¸€ä¸ªé˜Ÿåˆ—å°†æ•°æ®å—è¿›è¡Œæ’åºï¼Œæ·˜æ±°æ•°æ®æ—¶ï¼ŒæŠŠé˜Ÿåˆ—å°¾éƒ¨çš„æ•°æ®å—åˆ é™¤ã€‚</p>
<br>

<p>è¿‡æœŸæ•°æ®æ·˜æ±°æ˜¯æ ¹æ®å…·ä½“æƒ…å†µé€‰ç”¨ï¼Œæ‰€æœ‰æ•°æ®æ·˜æ±°ä¸€èˆ¬æƒ…å†µä¸‹ç”¨allkeys-lruç­–ç•¥ï¼Œå¦‚æœæ•°æ®çš„ä½¿ç”¨é¢‘ç‡ç›¸å·®ä¸å¤§ï¼Œä¹Ÿå¯ä»¥ç”¨allkeys-randomç­–ç•¥ã€‚</p>
<br>

<h5 id="ï¼ˆ2ï¼‰ç¼“å­˜å¼‚å¸¸"><a href="#ï¼ˆ2ï¼‰ç¼“å­˜å¼‚å¸¸" class="headerlink" title="ï¼ˆ2ï¼‰ç¼“å­˜å¼‚å¸¸"></a>ï¼ˆ2ï¼‰ç¼“å­˜å¼‚å¸¸</h5><ol>
<li><p>æ•°æ®ä¸ä¸€è‡´ï¼š</p>
<p>å°±æ˜¯æ•°æ®æ›´æ–°ï¼Œè¯»å–åˆ°çš„ä¾ç„¶æ˜¯æ—§å€¼ã€‚é€šå¸¸æ˜¯ç”±ä¸¤ç§æƒ…å†µå¯¼è‡´ï¼Œä¸€ç§æ˜¯ç¼“å­˜åˆ é™¤äº†ï¼Œä½†æ˜¯æ•°æ®æ›´æ–°å¤±è´¥ï¼Œä¸€ç§æ˜¯æ•°æ®æ›´æ–°æˆåŠŸï¼Œä½†æ˜¯ç¼“å­˜åˆ é™¤å¤±è´¥ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼šå°±æ˜¯åˆ©ç”¨é‡è¯•æœºåˆ¶ï¼ŒæŠŠè¦åˆ é™¤çš„ç¼“å­˜å€¼æˆ–è€…æ›´æ–°æ•°æ®åº“å€¼å…ˆå­˜å‚¨åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œå‡ºç°æ•°æ®ä¸ä¸€è‡´ï¼Œå°±é‡è¯•ã€‚</p>
<br>

<p>å¦‚æœæ˜¯å¤šçº¿ç¨‹è®¿é—®ï¼Œåˆ†ä¸ºä¸¤ç§æƒ…å†µè®¨è®ºï¼Œå¦‚æœæ˜¯å…ˆåˆ é™¤ç¼“å­˜ï¼Œåæ›´æ–°æ•°æ®ï¼Œé‚£ä¹ˆä¸€ä¸ªç¼“å­˜åœ¨æ‰§è¡Œåˆ°æ•°æ®æ›´æ–°çš„è¿‡ç¨‹ä¸­ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹è®¿é—®æ•°æ®æ‹¿åˆ°çš„ä¾ç„¶æ˜¯æ—§å€¼ï¼Œå¹¶ä¸”è¿˜ä¼šåˆ·æ–°ç¼“å­˜ï¼Œå°±ä¸‹æ¥çš„å…¶ä»–æ‰€æœ‰çº¿ç¨‹æ‹¿åˆ°çš„éƒ½æ˜¯æ—§æ•°æ®ã€‚ä¸ºäº†é¿å…åç»­çš„çº¿ç¨‹æ‹¿åˆ°çš„éƒ½æ˜¯æ—§æ•°æ®ï¼Œå°±ä¼šç”¨åˆ°å»¶è¿ŸåŒåˆ ï¼Œè¿™ä¸ªå»¶è¿ŸåŒåˆ å…¶å®å°±æ˜¯çº¿ç¨‹æ‰§è¡Œå®Œåˆ é™¤ç¼“å­˜å’Œæ›´æ–°æ•°æ®ä¹‹åï¼Œä¼‘çœ ä¸€æ®µæ—¶é—´ï¼Œä¼‘çœ ç»“æŸå°±å†æ¬¡åˆ é™¤ç¼“å­˜ï¼Œè¿™æ ·ä¹‹åçš„å…¶ä»–çº¿ç¨‹è®¿é—®æ•°æ®æ—¶ï¼Œæ‹¿åˆ°çš„å°±æ˜¯æ–°å€¼ã€‚å¦‚æœæ˜¯ç¬¬äºŒç§æƒ…å†µï¼Œå…ˆæ›´æ–°æ•°æ®ï¼Œå†åˆ é™¤ç¼“å­˜ï¼Œé‚£ä¹ˆåœ¨çº¿ç¨‹æ›´æ–°æ•°æ®è¿™ä¸€æ—¶é—´å†…ï¼Œå…¶ä»–çº¿ç¨‹æ‹¿åˆ°çš„æ˜¯æ—§æ•°æ®ï¼Œæ›´æ–°å¹¶ä¸”åˆ é™¤ç¼“å­˜å®Œæˆåçš„å…¶ä»–çº¿ç¨‹æ‹¿åˆ°çš„æ˜¯æ–°æ•°æ®ã€‚</p>
<br>

<br>
</li>
<li><p>ç¼“å­˜å‡»ç©¿</p>
<p>è¦è¯»å–çš„æ•°æ®åœ¨æ•°æ®åº“ä¸­å­˜åœ¨ï¼Œåœ¨ç¼“å­˜ä¸­å·²ç»è¿‡æœŸï¼Œä»æ•°æ®åº“è¯»å–çš„æ•°æ®åˆ·æ–°åˆ°ç¼“å­˜ä¸­ï¼Œè¿™ç§æƒ…å†µå«åšç¼“å­˜å‡»ç©¿ã€‚</p>
<br>

<p>é‚£ä¹ˆå¦‚æœå¤§é‡æ•°æ®åŒæ—¶è¿‡æœŸï¼Œè¿™äº›æ•°æ®åˆåŒæ—¶è¢«è®¿é—®ï¼Œé‚£ä¹ˆå°±ä¼šå¯¹æ•°æ®åº“é€ æˆè¾ƒå¤§å‹åŠ›ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<p>å¯¹äºçƒ­ç‚¹æ•°æ®ä¸è®¾ç½®è¿‡æœŸå€¼ï¼Œæˆ–è€…å¯¹äºåœ¨è®¾ç½®è¿‡æœŸæ—¶é—´çš„æ—¶å€™å†åŠ ä¸Šä¸€ä¸ªéšæœºæ—¶é—´ï¼Œè®©è¿‡æœŸæ—¶é—´ä¸åŒï¼Œé¿å…åŒæ—¶è¿‡æœŸã€‚è‡³äºä¸åŒæ—¶è¿‡æœŸçš„æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨redisåˆ é™¤è¿‡æœŸæ•°æ®ä¸¤ç§ç­–ç•¥ä¹‹ä¸€çš„å®šæœŸåˆ é™¤ã€‚ä¹Ÿå¯ä»¥é‡‡ç”¨é¢„çƒ­çš„æ–¹å¼ï¼Œå³å°†çƒ­é—¨æ•°æ®æå‰å­˜å…¥ç¼“å­˜ã€‚è¿˜å¯ä»¥ä½¿ç”¨é”ï¼Œç¼“å­˜å¤±æ•ˆæ—¶ï¼Œä¸æ˜¯ç›´æ¥è®¿é—®æ•°æ®åº“ï¼Œè€Œæ˜¯åªæœ‰è·å–ä¸€ä¸ªåˆ†å¸ƒå¼é”æ‰èƒ½è®¿é—®æ•°æ®åº“ï¼Œå¦‚æœä¸èƒ½è·å–åˆ†å¸ƒå¼é”ï¼Œè¯´æ˜å·²ç»æœ‰çº¿ç¨‹åœ¨æ‰§è¡Œï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼‘çœ ä¸€æ®µæ—¶é—´ï¼Œåœ¨å»è·å–åˆ†å¸ƒå¼é”ã€‚</p>
<br>

<br>
</li>
<li><p>ç¼“å­˜ç©¿é€</p>
<p>è¦è¯»å–çš„æ•°æ®åœ¨ç¼“å­˜ä¸­æ²¡æœ‰ï¼Œåœ¨æ•°æ®åº“ä¸­ä¹Ÿæ²¡æœ‰ã€‚æ¯æ¬¡éƒ½ä¼šç©¿é€åˆ°æ•°æ®åº“ï¼Œç¼“å­˜æˆäº†æ‘†è®¾ï¼Œå¢å¤§æ•°æ®åº“çš„å‹åŠ›ã€‚</p>
<br>

<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<p>å¯ä»¥è®¾ç«‹ç¼ºçœå€¼ï¼Œå‘ç°ç¼“å­˜ç©¿é€çš„æ•°æ®å°±è®¾ç«‹ä¸€ä¸ªç¼ºçœå€¼ï¼Œåç»­è®¿é—®æ—¶è¿”å›ç©ºå€¼ã€‚</p>
<p>è¿˜å¯ä»¥ç”¨å¸ƒéš†è¿‡æ»¤å™¨ï¼Œå°±æ˜¯æ•°æ®å†™å…¥æ•°æ®åº“æ—¶ï¼Œå°†æ•°æ®çš„ id å­˜å…¥å¸ƒéš†è¿‡æ»¤å™¨ä¸­ï¼Œ è¯»å–æ•°æ®æ—¶åœ¨è¿‡æ»¤å™¨ä¸­æŸ¥æ‰¾æ•°æ® id ï¼Œå¦‚æœæ²¡æœ‰å°±ä¸ä¼šåˆ°æ•°æ®åº“ä¸­æŸ¥è¯¢ã€‚å¸ƒéš†è¿‡æ»¤å™¨çš„ç®—æ³•å°±æ˜¯ç»´æŠ¤ä¸€ä¸ªbitç±»å‹çš„æ•°ç»„ï¼Œå†™å…¥æ•°æ® id ï¼Œä½¿ç”¨ä¸‰ä¸ªhashå‡½æ•°ï¼Œä¸€ä¸ªidæ˜ å°„åˆ°ä¸‰ä¸ªä½ç½®å¹¶å­˜å…¥1ï¼ŒæŸ¥è¯¢ idï¼Œå¦‚æœè¿™ä¸ªidæ˜ å°„çš„ä¸‰ä¸ªä½ç½®æœ‰0ï¼Œé‚£ä¹ˆidä¸å­˜åœ¨ã€‚æ‰€ä»¥å¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­idå­˜åœ¨æ—¶ï¼Œidå¯èƒ½å­˜åœ¨ï¼Œåˆ¤æ–­idä¸å­˜åœ¨æ—¶ï¼Œidå°±ä¸å¯èƒ½å­˜åœ¨ã€‚</p>
<br>

<br>
</li>
<li><p>ç¼“å­˜é›ªå´©</p>
<p>å¤§é‡è¯·æ±‚æ— æ³•åœ¨ç¼“å­˜ä¸­å¤„ç†ï¼Œå…¨éƒ¨æ‰“åˆ°æ•°æ®åº“ä¸­è‡´ä½¿æ•°æ®åº“å‹åŠ›å‰§å¢ç”šè‡³å®•æœºã€‚ä¸€ä¸ªrediså®ä¾‹æ”¯æŒ10ä¸‡çš„QPSï¼Œè€Œä¸€ä¸ªæ•°æ®åº“å®ä¾‹ä¸€èˆ¬åªæœ‰1000QPSã€‚å’Œç¼“å­˜å‡»ç©¿ç›¸ä¼¼çš„ä¸€ç‚¹æ˜¯ç¼“å­˜éƒ½æ— æ•ˆï¼ŒåŒºåˆ«äºç¼“å­˜å‡»ç©¿çš„ä¸€ç‚¹æ˜¯ç¼“å­˜é›ªå´©æ˜¯å¤§é‡æ•°æ®åŒæ—¶å¤±æ•ˆï¼Œç¼“å­˜å‡»ç©¿æ˜¯æŸä¸ªçƒ­ç‚¹æ•°æ®å¤±æ•ˆã€‚æœ‰ä¸¤ç§æƒ…å†µï¼šå¤§é‡æ•°æ®åŒæ—¶è¿‡æœŸï¼Œrediså®•æœº</p>
<br>

<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<p>è®¾ç½®è¿‡æœŸæ—¶é—´æ—¶å†åŠ ä¸Šä¸€ä¸ªéšæœºæ—¶é—´ï¼Œé˜²æ­¢å¤§é‡æ•°æ®åŒæ—¶è¿‡æœŸã€‚ä¹Ÿå¯ä»¥è¿›è¡Œæ¥å£é™æµï¼Œå‡å°æ•°æ®åº“å‹åŠ›ã€‚</p>
<p>å¯¹äºrediså®•æœºå¼•å‘çš„ç¼“å­˜é›ªå´©çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼šé™æµå’ŒæœåŠ¡ç†”æ–­ã€‚æœåŠ¡ç†”æ–­æŒ‡çš„æ˜¯ä»ç¼“å­˜è·å–æ•°æ®å¼‚å¸¸å°±ç›´æ¥è¿”å›é”™è¯¯ç»™å‰ç«¯ï¼Œé˜²æ­¢æ‰“åˆ°æ•°æ®åº“ã€‚å½“ç„¶ï¼Œæœ€å¥½çš„æ–¹æ³•å°±æ˜¯æ„å»ºé«˜å¯ç”¨çš„ç¼“å­˜é›†ç¾¤ï¼Œä¸»åº“å®•æœºï¼Œä»åº“æ¥æ›¿ä¸»åº“ã€‚</p>
<br>

<br></li>
</ol>
<h4 id="å…«-jedis"><a href="#å…«-jedis" class="headerlink" title="å…«. jedis"></a>å…«. jedis</h4><br>

<p>springbot å¼•å…¥ jedis ä¾èµ–åŒ…ï¼Œåˆ©ç”¨ Jedis å¯¹è±¡æ¥è¿æ¥rediså’Œæ“ä½œredisæ•°æ®ã€‚</p>
<br>

<p>è¿™é‡Œè®²è®² redis äº”å¤§åŸºæœ¬æ•°æ®ç±»å‹ï¼Œgeoçš„å¸¸ç”¨å‘½ä»¤ï¼Œå¢åˆ æ”¹æŸ¥çš„é¡ºåºï¼š</p>
<br>

<h5 id="ï¼ˆ1ï¼‰redis-äº”å¤§åŸºæœ¬æ•°æ®ç±»å‹"><a href="#ï¼ˆ1ï¼‰redis-äº”å¤§åŸºæœ¬æ•°æ®ç±»å‹" class="headerlink" title="ï¼ˆ1ï¼‰redis äº”å¤§åŸºæœ¬æ•°æ®ç±»å‹"></a>ï¼ˆ1ï¼‰redis äº”å¤§åŸºæœ¬æ•°æ®ç±»å‹</h5><ol>
<li>String: [set, setnx, setex, setrange, mset, msetnx]  [unlink, del] [append, incr, decr, incrby, decrby] [get, mget, getrange, substr, strlen]</li>
<li>List(åŒå‘é“¾è¡¨): [lpush, rpush, lpushx, linsert]  [lpop, rpop, lrem, brpop]  [lset]  [lrange, lindex, llen]</li>
<li>Hash: [hset, hsetnx, ]  [hdel]  [hincrby, hincrbyfloat]  [hget, hmget, hgetall, hexists, hkeys,hvals,hlen]</li>
<li>Set: [sadd, ]  [spop, srem, smove ]  []  [amembers, sismember, scard, srandmember, sinter, sunion, sdiff, sinterstore]</li>
<li>zset: [zadd]  [zrem]  [zincrby]  [zrange, zrevrange, zrangebyscore, zrevrangebyscore, zrangebylex, zcard, zcount, zrank, zscore]</li>
</ol>
<br>

<h5 id="ï¼ˆ2ï¼‰geo"><a href="#ï¼ˆ2ï¼‰geo" class="headerlink" title="ï¼ˆ2ï¼‰geo"></a>ï¼ˆ2ï¼‰geo</h5><p>geoadd &lt; key&gt; &lt; longitude&gt;&lt; latitude&gt;&lt; member&gt;</p>
<p>geopos &lt; key&gt;&lt; member&gt; [&lt; member&gt;â€¦]</p>
<p>geodist &lt; key&gt;&lt; member1&gt;&lt; member2&gt;</p>
<p>georadius &lt; key&gt;&lt; longitude&gt; &lt; latitue&gt; radius [m | km| fm| mi] count number</p>
]]></content>
      <categories>
        <category>javaé¢è¯•</category>
        <category>redis</category>
      </categories>
      <tags>
        <tag>redis</tag>
      </tags>
  </entry>
</search>
